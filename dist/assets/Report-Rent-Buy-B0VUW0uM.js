import{d as I,a as B,u as U,r as D,N as w,o as O,e as b,f as r,t as i,g as e,h as T,y as s,E as f,j as $,O as p,U as M,P as j}from"./index-IEQe28hw.js";import{r as q}from"./rent-store-UDLfTpPH.js";import{s as d,a as A}from"./column.esm-OrffhnHs.js";import{s as v}from"./dropdown.esm-QNg_qYZy.js";import{b as S}from"./calendar.esm-G_uPhFc9.js";import{s as E}from"./inputtext.esm-AOnGUTsm.js";import{f as g}from"./format.currency-CcPyHQva.js";import"./service-SQLvwKvD.js";import"./axios.config-jCy-uYyV.js";import"./format.date--bimoUa2.js";import"./paginator.esm-eRAHRNvb.js";import"./inputnumber.esm-P8DAIkM9.js";import"./overlayeventbus.esm-v52u7d4z.js";import"./index.esm-0UP4CAzj.js";import"./checkbox.esm-gU_fICfh.js";import"./index.esm-EUeEq7yb.js";const F={class:"card"},K={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},z={class:"p-input-icon-left w-full sm:w-30rem flex-order-1 sm:flex-order-0"},G={class:"mb-3"},H={key:0},J={class:"col-12 md:col-12 flex flex-row",style:{"margin-top":"-15px"}},Q={class:"col-12 md:col-3"},W=r("span",{class:"text-red-500"}," *",-1),X={class:"col-12 md:col-2"},Y={class:"col-12 md:col-2"},Z={class:"col-12 md:col-2"},x={class:"col-12 md:col-2"},ee={class:"col-12 md:col-1",style:{"text-align":"right"}},te=r("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),ae=r("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),le=r("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),$e=I({__name:"Report-Rent-Buy",setup(re){const{form:o,setStateFilter:l,state:c,getAllReportRentBuy:_,getAllCustomers:V,getCustomers:h}=q(),P=B(),{t:u}=U(),R=D([{id:"all",name:u("messages.all")},{id:"rent",name:u("messages.service_rent")},{id:"buy",name:u("messages.service_sale")}]);async function C(t){var a;const n=t.target.name;t.target.value===""&&(n==="search"&&((a=l.filter)==null?void 0:a.search)!==void 0&&(l.filter.search=""),await _())}const y=w({get:()=>l.filter.search||"",set:t=>{l.filter&&(l.filter.search=t)}}),L=async()=>{l.filter&&(l.filter.service_model="",l.filter.from_date="",l.filter.to_date="",l.filter.search=""),o.to_date="",o.from_date="",o.service_model="all",await m()},m=async()=>{l.filter&&(l.filter.service_model=o.service_model==="all"?"":o.service_model,l.filter.from_date=o.from_date,l.filter.to_date=o.to_date,l.filter.customer_id=o.customer_id),await _()};async function k(t){l.page=t.page+1,l.limit=t.rows;const{page:n,limit:a}=l;P.push({name:"report.rent.buy",query:{page:n,limit:a}}),await _(),o.customer_id=h.data.props.length>0?h.data.props[0].id:void 0,o.service_model="all"}const N=w(()=>{let t=0;return l.page&&l.limit&&(t=(l.page-1)*l.limit),t});return O(async()=>{await V(),o.service_model="all",h.data.props.unshift({id:"all",name:u("messages.all"),customer_number:u("messages.all"),tel:u("messages.all")}),o.customer_id=h.data.props.length>0?h.data.props[0].id:void 0,await _()}),(t,n)=>($(),b("div",F,[r("div",K,[r("span",z,[r("h2",G,i(t.$t("table.title.report_rent_buy")),1)]),e(o).customer_id!=="all"&&e(c).data.summary?($(),b("span",H,i(t.$t("messages.total_price"))+" : "+i(e(g)(e(c).data.summary,e(c).data.currency)),1)):T("",!0)]),s(e(A),{value:e(c).data.props,onPage:k,paginator:"",first:N.value,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem",loading:e(c).isLoading,lazy:"",totalRecords:e(c).data.total,rows:e(l).limit,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:`${t.$t("table.pagination.show")} {first} ${t.$t("table.pagination.to")} {last} ${t.$t("table.pagination.from")} {totalRecords} ${t.$t("table.pagination.row")}`},{header:f(()=>[r("div",J,[r("div",Q,[r("label",null,[p(i(t.$t("messages.search"))+" ",1),W]),s(e(E),{modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=a=>y.value=a),placeholder:t.$t("placeholder.textSearch"),style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",name:"search",onKeyup:M(m,["enter"]),onInput:C},null,8,["modelValue","placeholder"])]),r("div",X,[r("label",null,i(t.$t("messages.owner")),1),s(e(v),{name:"customer",modelValue:e(o).customer_id,"onUpdate:modelValue":n[1]||(n[1]=a=>e(o).customer_id=a),options:e(h).data.props,optionLabel:a=>`${a.customer_number} - ${a.name} - ${a.tel}`,placeholder:t.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:m},null,8,["modelValue","options","optionLabel","placeholder"])]),r("div",Y,[r("label",null,i(t.$t("messages.status")),1),s(e(v),{name:"real_estate_type",modelValue:e(o).service_model,"onUpdate:modelValue":n[2]||(n[2]=a=>e(o).service_model=a),options:R.value,optionLabel:"name",placeholder:t.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,onChange:m},null,8,["modelValue","options","placeholder"])]),r("div",Z,[r("label",null,i(t.$t("messages.start_date")),1),s(e(S),{modelValue:e(o).from_date,"onUpdate:modelValue":n[3]||(n[3]=a=>e(o).from_date=a),showIcon:"",style:{width:"100%"},onDateSelect:m,onInput:m},null,8,["modelValue"])]),r("div",x,[r("label",null,i(t.$t("messages.end_date")),1),s(e(S),{modelValue:e(o).to_date,"onUpdate:modelValue":n[4]||(n[4]=a=>e(o).to_date=a),showIcon:"",style:{width:"100%"},onDateSelect:m,onInput:m},null,8,["modelValue"])]),r("div",ee,[s(e(j),{icon:"pi pi-refresh",severity:"warning",style:{"margin-top":"22px !important",color:"white"},onClick:L})])])]),default:f(()=>[s(e(d),{field:"id",header:t.$t("table.header.index")},{body:f(a=>[p(i(a.index+1),1)]),_:1},8,["header"]),s(e(d),{field:"date",header:t.$t("table.header.date_rent"),headerStyle:"min-width: 7rem"},null,8,["header"]),s(e(d),{field:"number",header:t.$t("table.header.rent_number"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(e(d),{field:"customer_name",header:t.$t("table.header.customer_name"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(e(d),{field:"customer_tel",header:t.$t("table.header.customer_phone"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(e(d),{header:t.$t("table.header.info_account"),headerStyle:"min-width: 25rem"},{body:f(({data:a})=>[p(i(a.real_estate_list.account.customer_number)+" ",1),r("span",null,[te,p(" "+i(a.real_estate_list.account.name),1)]),r("span",null,[ae,p(" "+i(a.real_estate_list.account.owner),1)]),r("span",null,[le,p(" "+i(a.real_estate_list.account.tel),1)])]),_:1},8,["header"]),s(e(d),{field:"real_estate_list.real_esate_number",header:t.$t("table.header.real_esate_number"),headerStyle:"min-width: 12rem"},null,8,["header"]),s(e(d),{field:"real_estate_list.name",header:t.$t("table.header.real_estate_name"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(e(d),{field:"real_estate_list.real_estate_type.name",header:t.$t("table.header.real_estate_type"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(e(d),{field:"service_model",header:t.$t("table.header.service_model"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(e(d),{field:"from_date",header:t.$t("table.header.from_date"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(e(d),{field:"to_date",header:t.$t("table.header.to_date"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(e(d),{header:t.$t("table.header.price"),headerStyle:"min-width: 15rem"},{body:f(({data:a})=>[p(i(e(g)(a.price,a.currency))+" - ( "+i(a.qty)+" / "+i(a.unit_price)+") ",1)]),_:1},8,["header"]),s(e(d),{header:t.$t("table.header.total"),headerStyle:"min-width: 13rem"},{body:f(({data:a})=>[p(i(e(g)(a.total,a.currency)),1)]),_:1},8,["header"])]),_:1},8,["value","first","loading","totalRecords","rows","currentPageReportTemplate"])]))}});export{$e as default};
