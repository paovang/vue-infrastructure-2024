import{d as B,C as Z,a1 as W,c as m,e as l,N as h,t as F,f as G,q as o,X,n as K,b as e,o as _,K as xe,a as Me,A as f,G as Se,z as $,P as Ce,p as Le,h as Oe,F as R,g as P,w as Ue,a0 as $e,O as k,_ as Fe}from"./index-UY_ClqEZ.js";import{s as Ge}from"./inputtext.esm-SkpUsWzK.js";import{b as ee,u as Ne}from"./index.esm-u2pHycXn.js";import{s as je,h as De,a as D}from"./panel.esm-O0rhluNn.js";import{s as w}from"./dropdown.esm-r4WhCfGt.js";import{s as Be}from"./inputnumber.esm-804f4__K.js";import{s as H}from"./divider.esm-RSp4MV6F.js";import{r as Je}from"./real-estate-service.store-rvsbhmXe.js";import{h as Te}from"./house.store-gIoDSZKq.js";import{p as Ye}from"./province.store-HIZ0-GLO.js";import{d as ze}from"./district.store-44m-LXRT.js";import{c as Q}from"./axios.config-rwBDy860.js";import"./index.esm-4tGtFC9W.js";import"./index.esm-8HP-Df8n.js";import"./index.esm-CKEJ9wVk.js";const Ee={class:"flex flex-column gap-2 mb-3"},qe=["for"],Ae={key:0,class:"text-red-500"},Re=["id"],x=B({__name:"FormEditInputText",props:{name:{},label:{},required:{type:Boolean},placeholder:{},value:{},isEditing:{type:Boolean}},setup(v){const c=v,{value:u,errorMessage:y}=ee(c.name),t=Z();W(()=>c.value,M=>{u.value=M});const r=["country","province","district"],b=(t==null?void 0:t.name)!==null&&(t==null?void 0:t.name)!==void 0&&r.includes(t.name);return(M,g)=>(_(),m("div",Ee,[l(b)?G("",!0):(_(),m("label",{key:0,for:c.name},[h(F(c.label)+" ",1),c.required?(_(),m("span",Ae," *")):G("",!0)],8,qe)),o(l(Ge),{modelValue:l(u),"onUpdate:modelValue":g[0]||(g[0]=N=>X(u)?u.value=N:null),id:c.name,class:K({"p-invalid":l(y)}),type:"text","aria-describedby":`text-error-${c.name}`,placeholder:c.placeholder},null,8,["modelValue","id","class","aria-describedby","placeholder"]),e("small",{class:"p-error",id:`text-error-${c.name}`},F(l(y)),9,Re)]))}}),Pe={class:"flex flex-column gap-2 mb-3 w-full"},He=["for"],Qe={key:0,class:"text-red-500"},Ze=["id"],We=B({__name:"FormEditTextArea",props:{name:{},label:{},required:{type:Boolean},placeholder:{},value:{}},setup(v){const c=v,{value:u,errorMessage:y}=ee(()=>c.name);return W(()=>c.value,t=>{u.value=t}),(t,r)=>(_(),m("div",Pe,[e("label",{for:t.name},[h(F(t.label)+" ",1),t.required?(_(),m("span",Qe," *")):G("",!0)],8,He),o(l(je),{"auto-resize":"",rows:"5",modelValue:l(u),"onUpdate:modelValue":r[0]||(r[0]=b=>X(u)?u.value=b:null),id:t.name,class:K({"p-invalid":l(y)}),"aria-describedby":`text-error-${t.name}`,placeholder:t.placeholder},null,8,["modelValue","id","class","aria-describedby","placeholder"]),e("small",{class:"p-error",id:`text-error-${t.name}`},F(l(y)),9,Ze)]))}}),p=v=>(Le("data-v-7150d618"),v=v(),Oe(),v),Xe={class:"card"},Ke={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},et={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},tt=p(()=>e("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),lt=p(()=>e("br",null,null,-1)),at={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},it={class:"column is-mobile-12 is-2"},st=p(()=>e("label",null,[h(" ປະເພດ ບໍລິການ "),e("span",{class:"text-red-500"}," *")],-1)),ot={class:"column is-mobile-12 is-2"},nt=p(()=>e("label",null,[h(" ຮູບເເບບ ບໍລິການ "),e("span",{class:"text-red-500"}," *")],-1)),rt={class:"column is-mobile-12 is-2"},dt=p(()=>e("label",null,[h(" ປະເພດຫ້ອງ "),e("span",{class:"text-red-500"}," *")],-1)),ct={class:"column is-mobile-12 is-2"},pt=p(()=>e("label",null,[h(" ເເຂວງ "),e("span",{class:"text-red-500"}," *")],-1)),ut={class:"column is-mobile-12 is-2"},mt=p(()=>e("label",null,[h(" ເມືອງ "),e("span",{class:"text-red-500"}," *")],-1)),_t={class:"column is-mobile-12 is-2"},ht={class:"column is-mobile-12 is-2"},yt={class:"column is-mobile-12 is-2"},vt={class:"column is-mobile-12 is-2"},ft={class:"column is-mobile-12 is-6"},gt={class:"column is-mobile-12 is-12"},wt={class:"column is-12"},bt={class:"column is-3"},It=p(()=>e("label",null,[h(" ຮູບເເບບ ບໍລິການ "),e("span",{class:"text-red-500"}," *")],-1)),Vt={class:"column is-3"},kt=p(()=>e("label",null,[h(" ລາຄາ "),e("span",{class:"text-red-500"}," *")],-1)),xt={class:"column is-5"},Mt=p(()=>e("label",null," ລາຍລະອຽດ ",-1)),St=["onUpdate:modelValue"],Ct={class:"column is-1"},Lt=["onClick"],Ot=p(()=>e("i",{class:"pi pi-times-circle"},null,-1)),Ut=[Ot],$t={class:"column is-12"},Ft={class:"columns is-12 is-multiline"},Gt={class:"column is-mobile-12 is-3"},Nt={class:"card",style:{padding:"0rem !important"}},jt={class:"card-image"},Dt={class:"image is-4by3"},Bt=["src"],Jt={class:"content",style:{display:"flex","justify-content":"center"}},Tt={style:{padding:"10px !important"}},Yt={class:"column is-12"},zt={class:"columns is-12 is-multiline"},Et={class:"card",style:{padding:"0rem !important"}},qt={class:"card-image"},At={class:"image is-4by3"},Rt=["src"],Pt={class:"content",style:{display:"flex","justify-content":"center"}},Ht={style:{padding:"10px !important"}},Qt=p(()=>e("span",{style:{"margin-left":"10px"}},null,-1)),Zt={class:"column is-mobile-12 is-12",style:{"text-align":"right"}},Wt={class:"column is-mobile-12 is-12 text-right"},Xt=p(()=>e("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),Kt=B({__name:"EditHouse",setup(v){const c=xe(),u=Me(),y=Z(),{form:t,state:r,update:b,getOne:M,houseGetByOne:g,deleteGallery:N,updateGallery:te,addGallery:le}=Te(),{getOne:ae,realestateType:ie}=Je(),{getAll:se,state:oe,setStateFilter:ne}=Ye(),{getAll:J,state:re,setStateFilter:S}=ze(),C=f(),j=f(),T=f([{id:"",image:""}]),I=f(),Y=f(),de=async()=>{u.push({name:"owner.house"})},ce=async()=>{t.prices&&t.prices.push({price:"",unit_price:"",detail:""})},pe=async a=>{t.prices&&t.prices.splice(a,1)},{handleSubmit:ue}=Ne({validationSchema:De}),me=f([{id:"sale",name:"ຂາຍ"},{id:"rent",name:"ເຊົ່າ"}]),_e=f([{id:"air",name:"ເເອ"},{id:"fan",name:"ພັດລົມ"},{id:"no",name:"ບໍ່ມີ"}]),he=f([{id:"day",name:"ມື້"},{id:"month",name:"ເດືອນ"},{id:"year",name:"ປີ"}]);Se(async()=>{await V()});const V=async()=>{const a=Number(y.params.id);r.btnLoading=!0,await M(a),await ye(),r.btnLoading=!1},ye=async()=>{const a=g.data.props;t.room_type=a.room_type,t.service_model=a.service_model,t.village=a.village,t.zip_code=a.zip_code,t.wide=a.wide,t.long=a.long,t.remark=a.remark,t.location=a.location,t.prices=a.price,t.prices=a.price,C.value=a.image,T.value=a.gallery,ne.limit=1e3,await se(),await ae(),t.real_estate_type_id=a.real_estate_type?a.real_estate_type.id:void 0,t.province_id=a.province?a.province.id:void 0,S.filter&&(S.filter.province_id=t.province_id,await J(),await z())},ve=async a=>{S.filter&&(S.filter.province_id=a,await J(),await z())},z=async()=>{t.district_id=g.data.props.district?g.data.props.district.id:void 0},fe=ue(async a=>{t.id=String(y.params.id),t.village=a.village,t.zip_code=a.zipcode,t.wide=a.wide,t.long=a.long,t.remark=a.remark,t.location=a.location,t.image=j.value,await b(),r.error?await L():(await U(),await V(),await O())}),ge=()=>{document.getElementById("fileInput").click()},we=async a=>{var d;const i=(d=a.target.files)==null?void 0:d[0];i&&(await q(i,"image"),C.value=URL.createObjectURL(i))},E=(a,s)=>{t.id=a,Y.value=s,Y.value==="update"?document.getElementById("updateGalleryInput").click():document.getElementById("addGalleryInput").click()},be=async a=>{await N(a),r.error?await L():(await U(),await V(),await O())},Ie=async a=>{var d;const i=(d=a.target.files)==null?void 0:d[0];i&&(await q(i,"gallery"),t.gallery=I.value,await te(),r.error?await L():(await U(),await V(),await O()))},Ve=async a=>{const i=a.target.files;i&&(await ke(i),t.gallery=I.value,await le(),r.error?await L():(await U(),await V(),await O()))},L=()=>{c.add({severity:"error",summary:"ເກີດຂໍ້ຜິດພາດ.",detail:`${r.error}`,life:3e3})},O=()=>{c.add({severity:"success",summary:"ສຳເລັດເເລ້ວ.",detail:"ການດຳເນີນສຳເລັດເເລ້ວ",life:3e3})},U=async()=>{C.value="",j.value="",I.value="";const a=document.getElementById("fileInput");a.value="";const s=document.getElementById("updateGalleryInput");s.value="";const i=document.getElementById("addGalleryInput");i.value=""},ke=async a=>{r.btnLoading=!0;try{let s=new FormData;for(let n=0;n<a.length;n++)s.append("files[]",a[n]);const d=(await Q.post("http://159.223.42.254/api/upload/multiple/files",s,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTU5LjIyMy40Mi4yNTQvYXBpL2F1dGgvbG9naW4iLCJpYXQiOjE3MDc5MjgwMDksIm5iZiI6MTcwNzkyODAwOSwianRpIjoia25Ma3BqRHdObUh4a2dyUyIsInN1YiI6IjIiLCJwcnYiOiIyM2JkNWM4OTQ5ZjYwMGFkYjM5ZTcwMWM0MDA4NzJkYjdhNTk3NmY3In0.FDSN40oY148SrIvrc0oj51Ln8dgwlYj8KDCEjvUPZ1U"}})).data.filename.map(n=>({image:`${n}`}));I.value=d,r.btnLoading=!1}catch(s){console.error("Upload failed:",s)}},q=async(a,s)=>{var i,d;r.btnLoading=!0;try{let n=new FormData;n.append("file",a);const A=await Q.post("http://159.223.42.254/api/upload_file",n,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTU5LjIyMy40Mi4yNTQvYXBpL2F1dGgvbG9naW4iLCJpYXQiOjE3MDc5MjgwMDksIm5iZiI6MTcwNzkyODAwOSwianRpIjoia25Ma3BqRHdObUh4a2dyUyIsInN1YiI6IjIiLCJwcnYiOiIyM2JkNWM4OTQ5ZjYwMGFkYjM5ZTcwMWM0MDA4NzJkYjdhNTk3NmY3In0.FDSN40oY148SrIvrc0oj51Ln8dgwlYj8KDCEjvUPZ1U"}});s==="image"?j.value=(i=A.data)==null?void 0:i.filename:I.value=(d=A.data)==null?void 0:d.filename,r.btnLoading=!1}catch(n){console.error("Upload failed:",n)}};return(a,s)=>(_(),m("div",Xe,[e("div",Ke,[e("span",et,[e("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:s[0]||(s[0]=i=>de())},[tt,h(" ຟອມລົງທະບຽນຂໍ້ມູນ ")])])]),lt,o(l(H)),e("form",{onSubmit:s[8]||(s[8]=Ce(i=>l(fe)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[e("div",at,[e("div",it,[st,o(l(w),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:l(t).real_estate_type_id,"onUpdate:modelValue":s[1]||(s[1]=i=>l(t).real_estate_type_id=i),options:l(ie).props,optionLabel:"name",placeholder:"ກະລຸນາເລືອກກ່ອນ...",class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options"])]),e("div",ot,[nt,o(l(w),{style:{"margin-top":"8px"},modelValue:l(t).service_model,"onUpdate:modelValue":s[2]||(s[2]=i=>l(t).service_model=i),options:me.value,optionLabel:"name",placeholder:"ກະລຸນາເລືອກ",optionValue:"id",highlightOnSelect:!0,class:"w-full"},null,8,["modelValue","options"])]),e("div",rt,[dt,o(l(w),{style:{"margin-top":"8px"},modelValue:l(t).room_type,"onUpdate:modelValue":s[3]||(s[3]=i=>l(t).room_type=i),options:_e.value,optionLabel:"name",placeholder:"ກະລຸນາເລືອກ",class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options"])]),e("div",ct,[pt,o(l(w),{style:{"margin-top":"8px"},modelValue:l(t).province_id,"onUpdate:modelValue":s[4]||(s[4]=i=>l(t).province_id=i),options:l(oe).data.props,optionLabel:"name",placeholder:"ກະລຸນາເລືອກກ່ອນ...",class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:s[5]||(s[5]=i=>ve(l(t).province_id))},null,8,["modelValue","options"])]),e("div",ut,[mt,o(l(w),{style:{"margin-top":"8px"},modelValue:l(t).district_id,"onUpdate:modelValue":s[6]||(s[6]=i=>l(t).district_id=i),options:l(re).data.props,optionLabel:"name",placeholder:"ກະລຸນາເລືອກ...",class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options"])]),e("div",_t,[o(x,{name:"village",label:"ບ້ານ",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:l(t).village},null,8,["value"])]),e("div",ht,[o(x,{name:"zipcode",label:"zipcode",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:l(t).zip_code},null,8,["value"])]),e("div",yt,[o(x,{name:"wide",label:"ລວງກວ້າງ",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:l(t).wide},null,8,["value"])]),e("div",vt,[o(x,{name:"long",label:"ລວງຍາວ",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:l(t).long},null,8,["value"])]),e("div",ft,[o(x,{name:"location",label:"ລີ້ງເເຜນທີ່",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:l(t).location},null,8,["value"])]),e("div",gt,[o(We,{name:"remark",label:"ລາຍລະອຽດ",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:l(t).remark},null,8,["value"])]),e("div",wt,[o(l(D),{header:"ຕັ້ງຄ່າລາຄາ ຊື້ຂາຍ - ເຊົ່າ"},{default:$(()=>[(_(!0),m(R,null,P(l(t).prices,(i,d)=>(_(),m("div",{class:"columns is-12",key:d},[e("div",bt,[It,o(l(w),{modelValue:i.unit_price,"onUpdate:modelValue":n=>i.unit_price=n,options:he.value,optionLabel:"name",placeholder:"ກະລຸນາເລືອກກ່ອນ...",class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",Vt,[kt,o(l(Be),{modelValue:i.price,"onUpdate:modelValue":n=>i.price=n,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue"])]),e("div",xt,[Mt,Ue(e("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":n=>i.detail=n,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,St),[[$e,i.detail]])]),e("div",Ct,[d>0?(_(),m("a",{key:0,onClick:n=>pe(d),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},Ut,8,Lt)):G("",!0)])]))),128)),e("div",{class:"column is-mobile-12 is-12"},[e("a",{onClick:ce,class:"button is-primary"},"ເພີ່ມລາຍການ")])]),_:1})]),e("div",$t,[o(l(D),{header:"ເລືອກໂປຮໄຟລ ເເລະ ເເກເລີລີ່"},{default:$(()=>[e("div",Ft,[e("div",Gt,[e("div",Nt,[e("div",jt,[e("figure",Dt,[e("img",{src:C.value,alt:"Placeholder image"},null,8,Bt)])]),e("div",Jt,[e("span",Tt,[o(l(k),{icon:"pi pi-pencil",severity:"warning",rounded:"",onClick:ge,style:{color:"white"}}),e("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:we},null,32)])])])])])]),_:1})]),e("div",Yt,[o(l(D),{header:"ໂປຮໄຟລ ເເລະ ເເກເລີລີ່"},{default:$(()=>[e("div",zt,[(_(!0),m(R,null,P(T.value,(i,d)=>(_(),m("div",{class:"column is-mobile-12 is-3",key:d},[e("div",Et,[e("div",qt,[e("figure",At,[e("img",{src:i==null?void 0:i.image,alt:"Placeholder image"},null,8,Rt)])]),e("div",Pt,[e("span",Ht,[o(l(k),{icon:"pi pi-trash",severity:"danger",rounded:"",onClick:n=>be(i.id)},null,8,["onClick"]),Qt,o(l(k),{icon:"pi pi-pencil",severity:"warning",rounded:"",onClick:n=>E(i.id,"update"),style:{color:"white"}},null,8,["onClick"])]),e("input",{type:"file",id:"updateGalleryInput",style:{display:"none"},onChange:Ie},null,32),e("input",{type:"file",id:"addGalleryInput",multiple:"",style:{display:"none"},onChange:Ve},null,32)])])]))),128)),o(l(H)),e("div",Zt,[o(l(k),{icon:"pi pi-plus-circle",onClick:s[7]||(s[7]=i=>E(l(y).params.id,"add"))})])])]),_:1})]),e("div",Wt,[o(l(k),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:l(r).btnLoading},{default:$(()=>[Xt,h(" ອັບເດດ ຂໍ້ມູນ ")]),_:1},8,["loading"])])])],32)]))}}),hl=Fe(Kt,[["__scopeId","data-v-7150d618"]]);export{hl as default};
