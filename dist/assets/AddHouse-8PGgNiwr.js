import{d as Ce,u as Te,M as Ue,N as ze,a as De,r as u,o as Be,e as p,f as l,Q as v,t as c,y as n,g as i,E as B,V as Me,p as Ne,k as qe,j as h,F as H,i as W,w as Ae,a3 as Ee,h as M,U as J,J as Q,_ as Oe}from"./index-e1VvfX6Q.js";import{_ as w}from"./FormInputText.vue_vue_type_script_setup_true_lang-or0SD6_D.js";import{_ as je}from"./FormTextArea.vue_vue_type_script_setup_true_lang-3ZmgkXCs.js";import{s as L}from"./dropdown.esm-c887Od-3.js";import{s as K}from"./inputnumber.esm-PCvz5MSc.js";import{u as Ge}from"./index.esm-U3d5dDAD.js";import{h as Re,s as X}from"./panel.esm--Lz5iYi-.js";import{c as Y}from"./axios.config-gXfSTYZr.js";import{s as Z}from"./divider.esm-NIdqghwY.js";import{r as xe}from"./real-estate-service.store-axQpmzNP.js";import{h as Pe}from"./house.store-S-IH2G0S.js";import{p as He}from"./province.store-WxuBstyg.js";import{d as We}from"./district.store-VM0-XvDN.js";import{v as Je,s as ee,i as Qe}from"./toast-AS0Hl_8E.js";import"./inputtext.esm-X541kGvY.js";import"./textarea.esm-8JxzGPPz.js";import"./overlayeventbus.esm-Rjw2mSvO.js";import"./index.esm-u2qnOQrU.js";import"./index.esm-HZIq3Km8.js";const g=C=>(Ne("data-v-cbf7247c"),C=C(),qe(),C),Ke={class:"card"},Xe={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},Ye={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},Ze=g(()=>l("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),el=g(()=>l("br",null,null,-1)),ll={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},al={class:"column is-mobile-12 is-2"},sl=g(()=>l("span",{class:"text-red-500"}," *",-1)),tl={class:"column is-mobile-12 is-2"},ol=g(()=>l("span",{class:"text-red-500"}," *",-1)),il={class:"column is-mobile-12 is-2"},nl=g(()=>l("span",{class:"text-red-500"}," *",-1)),rl={class:"column is-mobile-12 is-2"},dl={class:"column is-mobile-12 is-2"},cl=g(()=>l("span",{class:"text-red-500"}," *",-1)),ml={class:"column is-mobile-12 is-2"},ul=g(()=>l("span",{class:"text-red-500"}," *",-1)),pl={class:"column is-mobile-12 is-2 set-margin-top"},hl={class:"column is-mobile-12 is-2 set-margin-top"},gl={class:"column is-mobile-12 is-2 set-margin-top"},vl={class:"column is-mobile-12 is-2 set-margin-top"},_l={class:"column is-mobile-12 is-2 set-margin-top"},fl={class:"column is-mobile-12 is-2 set-margin-top"},yl={class:"column is-mobile-12 is-2 set-margin-top"},bl={class:"column is-mobile-12 is-10 set-margin-top"},wl={class:"column is-mobile-12 is-12 set-margin-top"},$l={class:"column is-12"},Sl={class:"column is-3"},Vl=g(()=>l("span",{class:"text-red-500"}," *",-1)),Fl={class:"column is-3"},kl=g(()=>l("span",{class:"text-red-500"}," *",-1)),Ll={key:0,class:"column is-5"},Il=["onUpdate:modelValue"],Cl={key:1,class:"column is-5"},Tl={class:"column is-1"},Ul=["onClick"],zl=g(()=>l("i",{class:"pi pi-times-circle"},null,-1)),Dl=[zl],Bl={class:"column is-mobile-12 is-12"},Ml={class:"column is-12"},Nl={class:"column is-mobile-12 is-12"},ql=g(()=>l("span",{class:"text-red-500"}," *",-1)),Al={key:0},El={key:1,style:{color:"#029217"}},Ol={class:"column is-mobile-12 is-12"},jl=g(()=>l("span",{class:"text-red-500"}," *",-1)),Gl={key:0},Rl={key:1,style:{color:"#029217"}},xl={key:0,class:"column is-mobile-12 is-12"},Pl={class:"column is-mobile-12 is-12 text-right"},Hl=g(()=>l("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),Wl=Ce({__name:"AddHouse",setup(C){const{t:s}=Te(),y=Ue(),le=ze(),ae=De(),{form:o,state:$,register:se}=Pe(),{getOne:te,realestateType:N}=xe(),{getAll:oe,state:q,setStateFilter:ie}=He(),{getAll:O,state:A,setStateFilter:T}=We(),b=u(null),_=u(),j=u(2e3),G=u(1900),ne=async()=>{ae.push({name:"owner.house"})},re=()=>{document.getElementById("fileInput").click()},de=async e=>{var d;const t=e.target,a=(d=t.files)==null?void 0:d[0];if(a){if(!await Je(a)){await ee({toast:y,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.real_estate_profile_valid_file_mimes")}),t.value="",b.value="",S.value="";return}if(!await Qe(a)){await ee({toast:y,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.real_estate_profile_valid_file_size")}),t.value="",b.value="",S.value="";return}const r=new Image;r.src=URL.createObjectURL(a),r.onload=async()=>{const f=r.width,V=r.height;f>j.value||V>G.value?(b.value="",S.value="",t.value="",await Fe(s("messages.dimensions"))):(b.value=s("uploadFile.uploading"),await Se(a),b.value=s("uploadFile.upload_success"))}}},ce=()=>{document.getElementById("galleryInput").click(),F.value=[]},F=u([]),me=async e=>{const t=e.target,a=t.files,d=1*1024*1024,r=5*1024*1024;if(a){let f=0;for(let V=0;V<a.length;V++){const D=a[V];f+=D.size;try{await ue(D,d)}catch(Ie){F.value.push(Ie)}}if(f>r){F.value.push(s("toast.summary.maximum_allowed_size_5MB")),_.value="",_.value="",t.value="";return}F.value.length<=0?(_.value=s("uploadFile.uploading")+a.length,await Ve(a),_.value=s("uploadFile.upload_success")+"("+a.length+" "+s("uploadFile.file")+")"):(_.value="",_.value="",t.value="")}},ue=(e,t)=>new Promise((a,d)=>{if(e.size>t)d(`${e.name} => `+s("toast.summary.real_estate_profile_valid_file_size_1MB"));else if(!["image/jpeg","image/jpg"].includes(e.type))d(`${e.name} => `+s("toast.summary.real_estate_profile_valid_file_mimes"));else{const f=new Image;f.src=URL.createObjectURL(e),f.onload=()=>{const V=f.width,D=f.height;V>j.value||D>G.value?d(`${e.name} => `+s("messages.dimensions")):a("")},f.onerror=()=>{d(`Error loading image ${e.name}.`)}}}),m=u([{price:"",unit_price:"",detail:"",est_m:""}]),pe=async()=>{var e;m.value&&(((e=m.value)==null?void 0:e.length)>2?y.add({severity:"error",summary:s("toast.summary.must_be_length_three"),detail:s("toast.detail.cancel_delete"),life:3e3}):m.value.push({price:"",unit_price:"",detail:""}))},he=async e=>{m.value&&m.value.splice(e,1)},I=u(!1),ge=async e=>{e==="rent"?(I.value=!0,k.value=U.value.slice(1,4),m&&m.value&&(m.value[0].unit_price=k.value[0].id,m.value[0].est_m=0)):(I.value=!1,k.value=U.value.slice(0,1),m&&m.value&&(m.value[0].unit_price=k.value[0].id))},{handleSubmit:ve}=Ge({validationSchema:Re}),_e=u([{id:"sale",name:s("messages.service_sale")},{id:"rent",name:s("messages.service_rent")}]),fe=u([{id:"air",name:s("messages.air")},{id:"fan",name:s("messages.fan")},{id:"no",name:s("messages.none")}]),U=u([{id:"sale",name:s("messages.service_sale")},{id:"day",name:s("messages.service_daily")},{id:"month",name:s("messages.service_monthly")},{id:"year",name:s("messages.service_yearly")}]),k=u(),R=localStorage.getItem("token"),z=u(),S=u();Be(async()=>{await ye(),m&&m.value&&(m.value[0].unit_price=U.value[0].id),k.value=U.value.slice(0,1)});const ye=async()=>{o.room_type="air",o.service_model="sale",ie.limit=1e3,await oe(),await te(),o.real_estate_type_id=N.props.length>0?N.props[0].id:void 0,o.province_id=q.data.props.length>0?q.data.props[0].id:void 0,T.filter&&(T.filter.province_id=o.province_id,await O(),await x())},be=async e=>{T.filter&&(T.filter.province_id=e,await O(),await x())},x=async()=>{o.district_id=A.data.props.length>0?A.data.props[0].id:void 0},we=ve(async e=>{o.district_id?S.value?z.value?(o.village=e.village,o.zip_code=e.zipcode,o.wide=e.wide,o.long=e.long,o.total_bath=e.bath,o.total_bed=e.bed,o.garage=e.garage,o.name=e.name,o.remark=e.remark,o.location=e.location,o.prices=m.value,o.image=S.value,o.gallery=z.value,await se(),$.error?await ke():await Le()):await E(s("placeholder.dropdownSelect")+" "+s("messages.gallery")):await E(s("placeholder.dropdownSelect")+" "+s("messages.image")):await E(s("placeholder.dropdownSelect")+" "+s("messages.district"))}),$e=async()=>{b.value="",_.value="",S.value="",z.value="";const e=document.getElementById("fileInput");e.value="";const t=document.getElementById("galleryInput");t.value=""},Se=async e=>{var t;$.btnLoading=!0;try{let a=new FormData;a.append("file",e);const d=await Y.post("http://188.166.183.153:8000/api/upload_file",a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${R}`}});S.value=(t=d.data)==null?void 0:t.filename,$.btnLoading=!1}catch(a){await P(a)}},Ve=async e=>{$.btnLoading=!0;try{let t=new FormData;for(let r=0;r<e.length;r++)t.append("files[]",e[r]);const d=(await Y.post("http://188.166.183.153:8000/api/upload/multiple/files",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${R}`}})).data.filename.map(r=>({image:`${r}`}));z.value=d,$.btnLoading=!1}catch(t){await P(t)}},P=e=>{y.add({severity:"error",summary:s("toast.summary.error"),detail:e,life:3e3})},Fe=e=>{y.add({severity:"error",summary:s("toast.summary.error"),detail:e,life:3e3})},E=e=>{y.add({severity:"error",summary:s("toast.summary.error"),detail:e,life:3e3})},ke=()=>{y.add({severity:"error",summary:s("toast.summary.error"),detail:`${$.error}`,life:3e3})},Le=async()=>{le.require({message:s("confirmDuplicate.message"),header:s("confirmDuplicate.header"),rejectLabel:s("confirmDuplicate.rejectLabel"),acceptLabel:s("confirmDuplicate.acceptLabel"),rejectClass:"p-button-danger",acceptClass:"p-button-info",accept:async()=>{await $e(),y.add({severity:"success",summary:s("toast.summary.duplicate"),detail:s("toast.detail.success_duplicate"),life:3e3})},reject:async()=>{window.location.reload(),y.add({severity:"error",summary:s("toast.summary.not_duplicate"),detail:s("toast.detail.cancel_duplicate"),life:3e3})}})};return(e,t)=>(h(),p("div",Ke,[l("div",Xe,[l("span",Ye,[l("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:t[0]||(t[0]=a=>ne())},[Ze,v(" "+c(e.$t("messages.form_register")),1)])])]),el,n(i(Z)),l("form",{onSubmit:t[8]||(t[8]=Me(a=>i(we)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[l("div",ll,[l("div",al,[l("label",null,[v(c(e.$t("messages.realestate_type"))+" ",1),sl]),n(i(L),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:i(o).real_estate_type_id,"onUpdate:modelValue":t[1]||(t[1]=a=>i(o).real_estate_type_id=a),options:i(N).props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",tl,[l("label",null,[v(c(e.$t("messages.service_model"))+" ",1),ol]),n(i(L),{style:{"margin-top":"8px"},modelValue:i(o).service_model,"onUpdate:modelValue":t[2]||(t[2]=a=>i(o).service_model=a),options:_e.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),optionValue:"id",highlightOnSelect:!0,class:"w-full",onChange:t[3]||(t[3]=a=>ge(i(o).service_model))},null,8,["modelValue","options","placeholder"])]),l("div",il,[l("label",null,[v(c(e.$t("messages.room_type"))+" ",1),nl]),n(i(L),{style:{"margin-top":"8px"},modelValue:i(o).room_type,"onUpdate:modelValue":t[4]||(t[4]=a=>i(o).room_type=a),options:fe.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",rl,[n(w,{name:"name",label:e.$t("messages.name"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",dl,[l("label",null,[v(c(e.$t("messages.province"))+" ",1),cl]),n(i(L),{style:{"margin-top":"8px"},modelValue:i(o).province_id,"onUpdate:modelValue":t[5]||(t[5]=a=>i(o).province_id=a),options:i(q).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:t[6]||(t[6]=a=>be(i(o).province_id))},null,8,["modelValue","options","placeholder"])]),l("div",ml,[l("label",null,[v(c(e.$t("messages.district"))+" ",1),ul]),n(i(L),{style:{"margin-top":"8px"},modelValue:i(o).district_id,"onUpdate:modelValue":t[7]||(t[7]=a=>i(o).district_id=a),options:i(A).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options","placeholder"])]),l("div",pl,[n(w,{name:"village",label:e.$t("messages.village"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",hl,[n(w,{name:"zipcode",label:e.$t("messages.zip_code"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",gl,[n(w,{name:"bed",label:e.$t("messages.total_bed"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",vl,[n(w,{name:"bath",label:e.$t("messages.total_bath"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",_l,[n(w,{name:"wide",label:e.$t("messages.wide"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",fl,[n(w,{name:"long",label:e.$t("messages.long"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",yl,[n(w,{name:"garage",label:e.$t("messages.garage"),required:"",placeholder:e.$t("placeholder.inputTextGarage"),class:"h-full"},null,8,["label","placeholder"])]),l("div",bl,[n(w,{name:"location",label:e.$t("messages.location"),required:"",placeholder:e.$t("placeholder.inputTextLocation"),class:"h-full"},null,8,["label","placeholder"])]),l("div",wl,[n(je,{name:"remark",label:e.$t("messages.details"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",$l,[n(i(X),{header:e.$t("messages.setting_price_for_rent")},{default:B(()=>[(h(!0),p(H,null,W(m.value,(a,d)=>(h(),p("div",{class:"columns is-12",key:d},[l("div",Sl,[l("label",null,[v(c(e.$t("messages.service_model"))+" ",1),Vl]),n(i(L),{modelValue:a.unit_price,"onUpdate:modelValue":r=>a.unit_price=r,options:k.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),l("div",Fl,[l("label",null,[v(c(e.$t("messages.price"))+" ",1),kl]),n(i(K),{modelValue:a.price,"onUpdate:modelValue":r=>a.price=r,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue"])]),I.value?(h(),p("div",Ll,[l("label",null,c(e.$t("messages.details")),1),Ae(l("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":r=>a.detail=r,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,Il),[[Ee,a.detail]])])):M("",!0),I.value?M("",!0):(h(),p("div",Cl,[l("label",null,c(e.$t("messages.est_m")),1),n(i(K),{modelValue:a.est_m,"onUpdate:modelValue":r=>a.est_m=r,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue"])])),l("div",Tl,[d>0?(h(),p("a",{key:0,onClick:r=>he(d),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},Dl,8,Ul)):M("",!0)])]))),128)),l("div",Bl,[n(i(J),{onClick:pe,class:"button is-primary",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},disabled:!I.value},{default:B(()=>[v(c(e.$t("button.add_item")),1)]),_:1},8,["disabled"])])]),_:1},8,["header"])]),l("div",Ml,[n(i(X),{header:e.$t("messages.profile_and_gallery")},{default:B(()=>[l("div",Nl,[l("label",null,[v(c(e.$t("messages.profile"))+" ",1),ql]),l("label",{class:"upload-box",onClick:re,style:Q({border:b.value?"1px dashed #029217":"1px dashed red"})},[b.value?(h(),p("div",El,c(b.value),1)):(h(),p("div",Al,c(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:de},null,32)]),n(i(Z)),l("div",Ol,[l("label",null,[v(c(e.$t("messages.gallery"))+" ",1),jl]),l("label",{class:"upload-box",onClick:ce,style:Q({border:_.value?"1px dashed #029217":"1px dashed red"})},[_.value?(h(),p("div",Rl,c(_.value),1)):(h(),p("div",Gl,c(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"galleryInput",multiple:"",style:{display:"none"},onChange:me},null,32)]),F.value.length>0?(h(),p("div",xl,[(h(!0),p(H,null,W(F.value,(a,d)=>(h(),p("p",{style:{color:"red"},key:d},c(d+1)+". "+c(a),1))),128))])):M("",!0)]),_:1},8,["header"])]),l("div",Pl,[n(i(J),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:i($).btnLoading},{default:B(()=>[Hl,v(" "+c(e.$t("button.save_data")),1)]),_:1},8,["loading"])])])],32)]))}}),pa=Oe(Wl,[["__scopeId","data-v-cbf7247c"]]);export{pa as default};
