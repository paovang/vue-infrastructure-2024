import{d as G,N as W,u as H,I as J,a as K,r as $,o as Q,e as p,f as s,L as u,t as c,j as i,g as o,F as V,k as x,U as X,p as Y,m as Z,l as f,b as ee,s as se,_ as oe}from"./index-R6K3kngR.js";import{_ as T}from"./FormInputText.vue_vue_type_script_setup_true_lang-58eNKcJN.js";import{o as ae}from"./user.store-Duw5lVIS.js";import{s as te}from"./dropdown.esm-s27PqOp0.js";import{s as b}from"./divider.esm-D-NIhl7t.js";import{s as le}from"./checkbox.esm-ljU2tjI3.js";import{u as ie}from"./vee-validate.esm-l0i4ijh0.js";import{e as re}from"./user.schema--81O0Zv8.js";import{a as ne}from"./axios.config-EMV3l8KB.js";import{_ as me,u as de}from"./upload-file-j25f7kix.js";import{v as pe,s as E,i as ue}from"./toast-FY7odgkM.js";import{v as ce}from"./validation-permissions-OqcukEwr.js";import"./inputtext.esm-CcvZiJq1.js";import"./overlayeventbus.esm-O4Z35ZmH.js";import"./index.esm--wXKCPWN.js";const n=_=>(Y("data-v-425143df"),_=_(),Z(),_),fe={class:"card"},_e={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},he={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},ge=n(()=>s("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),ye=n(()=>s("br",null,null,-1)),be={class:"columns is-12 is-multiline"},we={class:"column is-2 is-mobile-12"},ve={class:"column is-3 is-mobile-12"},Se={class:"column is-2 is-mobile-12"},Ie=n(()=>s("span",{class:"text-red-500"}," *",-1)),$e={class:"column is-5 is-mobile-12"},Ve={style:{"font-size":"18px","font-weight":"bold"}},xe=n(()=>s("i",{class:"pi pi-users"},null,-1)),Te=n(()=>s("span",{style:{width:"10px"}},null,-1)),Ee={class:"column is-12 is-mobile-12",style:{"font-size":"18px","font-weight":"bold"}},Fe=n(()=>s("i",{class:"pi pi-check-circle",style:{color:"green"}},null,-1)),ke={class:"checkbox ml-2"},Ue=n(()=>s("br",null,null,-1)),Ne={style:{"text-align":"right"}},Be=G({__name:"EditUser",setup(_){const{form:t,update:F,getAllRole:k,getAllPermission:U,allPermission:N,allRole:B,state:h,getOne:R,userGetByOne:m}=ae(),d=W(),{t:l}=H(),w=J(),C=K(),v=$([]),g=$(),z={name:l("placeholder.inputText"),email:l("placeholder.inputText")},{handleSubmit:O,setFieldValue:S}=ie({validationSchema:re(z)}),P=O(async e=>{if(t.id=String(w.params.id),t.name=e.name,t.email=e.email,t.password=e.password,t.password_confirmation=e.password_confirmation,t.profile=g.value,await F(),h.error)await q();else{await A(),g.value="";const a=document.getElementById("id_image");a.value=""}}),L=async e=>{const a=e.target.files[0];if(!await pe(a)){await E({toast:d,error:"error",summary:l("toast.summary.error"),detail:l("toast.summary.profile_valid_file_mimes")}),e.target.value="";return}if(!await ue(a)){await E({toast:d,error:"error",summary:l("toast.summary.error"),detail:l("toast.summary.profile_valid_file_size")}),e.target.value="";return}await de({axios:ne,file:a,state:h,selectedImage:g,toast:d,t:l})};Q(async()=>{const e=Number(w.params.id);await R(e),await k(),await U(),t.roleId=m.data.props.role?m.data.props.role.id:void 0,S("name",m.data.props.name),S("email",m.data.props.email);const a=m.data.props.permissions;a&&(a.forEach(r=>{v.value.push(r.id)}),t.permissionIds=v.value)});const M=async()=>{C.push({name:"owner.user"})},q=()=>{d.add({severity:"error",summary:l("toast.summary.error"),detail:`${h.error}`,life:3e3})},A=()=>{d.add({severity:"success",summary:l("toast.summary.success"),detail:l("toast.detail.successfully"),life:3e3})};return(e,a)=>(f(),p("div",fe,[s("div",_e,[s("span",he,[s("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:M},[ge,u(" "+c(e.$t("messages.form_register")),1)])])]),i(o(b)),ye,s("form",{onSubmit:a[2]||(a[2]=X(r=>o(P)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[s("div",be,[s("div",we,[i(T,{ref:"autoFocusCursor",name:"name",label:e.$t("messages.name"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),s("div",ve,[i(T,{ref:"autoFocusCursor",name:"email",label:e.$t("messages.email"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),s("div",Se,[s("label",null,[u(c(e.$t("messages.role"))+" ",1),Ie]),i(o(te),{style:{"margin-top":"7px"},modelValue:o(t).roleId,"onUpdate:modelValue":a[0]||(a[0]=r=>o(t).roleId=r),options:o(B).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),s("div",$e,[i(me,{name:"profile",label:e.$t("messages.profile"),required:"",multiple:!0,class:"h-full",onChange:L},null,8,["label"])])]),s("p",Ve,[xe,Te,u(" "+c(e.$t("messages.permission")),1)]),i(o(b)),(f(!0),p(V,null,x(o(N).data.props,(r,j)=>(f(),p("div",{class:"columns is-12 is-multiline",key:j},[s("div",Ee,[Fe,u(" "+c(r.display_name),1)]),(f(!0),p(V,null,x(r.permissions,(I,y)=>(f(),p("div",{class:"column is-4 is-mobile-12",key:y},[s("label",ke,[i(o(le),{modelValue:o(t).permissionIds,"onUpdate:modelValue":a[1]||(a[1]=D=>o(t).permissionIds=D),inputId:"permission_"+y,name:"permission_"+y,value:I.id},null,8,["modelValue","inputId","name","value"]),u(" "+c(I.name),1)])]))),128))]))),128)),i(o(b),{style:{"margin-top":"-10px"}}),Ue,s("div",Ne,[i(o(se),{type:"submit",label:e.$t("button.edit_data"),loading:o(h).btnLoading,disabled:o(ce)(o(ee).OWNER_USER.UPDATE)},null,8,["label","loading","disabled"])])],32)]))}}),Ke=oe(Be,[["__scopeId","data-v-425143df"]]);export{Ke as default};
