import{K as I,L as g,d as A,a as N,u as D,C as U,V as $,I as T,c as F,e as o,t as n,v as s,A as _,f as t,o as K,W as u,$ as M,X as O}from"./index-GH5mf-Pe.js";import{D as q}from"./service-fwnCPg4e.js";import{b as j}from"./axios.config-HGXv1ygo.js";import{s as m,a as z}from"./column.esm-CDUO3jbu.js";import{s as S}from"./dropdown.esm-y0xii1ht.js";import{b as V}from"./calendar.esm-ULOg1bAS.js";import{s as E}from"./inputtext.esm-0AcHVir1.js";import{f as R}from"./format.currency-Z_3s8gTt.js";import"./format.date--bimoUa2.js";import"./paginator.esm-RAOB1gKm.js";import"./inputnumber.esm-o8WmzhCb.js";import"./overlayeventbus.esm-sGScoZw7.js";import"./index.esm-m1ybi5UN.js";import"./checkbox.esm-CUtPgywq.js";import"./index.esm-Jw6qCrGR.js";const W=I("report-rent-buy-store",()=>{const y=j.resolve(q),l=g({data:{props:[],total:0,summary:""},isLoading:!1,btnLoading:!1,error:""}),r=g({data:{props:[]}}),c=g({page:1,limit:10,filter:{service_model:"",from_date:"",to_date:"",search:"",customer_id:""}}),f=g({});async function w(){l.isLoading=!0;const i=await y.getAllReportRentBuy({page:c.page,limit:c.limit,filter:c.filter});i&&i.data&&(i==null?void 0:i.status)==="success"&&(l.data.props=i.data.props,l.data.total=i.data.total,l.data.summary=i.data.summary,l.isLoading=!1)}async function h(){const i=await y.getAllCustomers();i&&i.data&&(i==null?void 0:i.message)==="success"&&(r.data.props=i.data)}return{form:f,setStateFilter:c,state:l,getAllReportRentBuy:w,getAllCustomers:h,getCustomers:r}}),X={class:"card"},G={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},H={class:"p-input-icon-left w-full sm:w-30rem flex-order-1 sm:flex-order-0"},J={class:"mb-3"},Q={class:"col-12 md:col-12 flex flex-row",style:{"margin-top":"-15px"}},Y={class:"col-12 md:col-3"},Z=o("span",{class:"text-red-500"}," *",-1),x={class:"col-12 md:col-2"},ee={class:"col-12 md:col-2"},te={class:"col-12 md:col-2"},ae={class:"col-12 md:col-2"},le={class:"col-12 md:col-1",style:{"text-align":"right"}},re=o("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),oe=o("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),se=o("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),$e=A({__name:"Report-Rent-Buy",setup(y){const{form:l,setStateFilter:r,state:c,getAllReportRentBuy:f,getAllCustomers:w,getCustomers:h}=W(),i=N(),{t:b}=D(),L=U([{id:"all",name:b("messages.all")},{id:"rent",name:b("messages.service_rent")},{id:"buy",name:b("messages.service_sale")}]);async function P(e){var a;const d=e.target.name;e.target.value===""&&(d==="search"&&((a=r.filter)==null?void 0:a.search)!==void 0&&(r.filter.search=""),await f())}const v=$({get:()=>r.filter.search||"",set:e=>{r.filter&&(r.filter.search=e)}}),C=async()=>{r.filter&&(r.filter.service_model="",r.filter.from_date="",r.filter.to_date="",r.filter.search=""),l.to_date="",l.from_date="",l.service_model="all",await p()},p=async()=>{r.filter&&(r.filter.service_model=l.service_model==="all"?"":l.service_model,r.filter.from_date=l.from_date,r.filter.to_date=l.to_date,r.filter.customer_id=l.customer_id),await f()};async function k(e){r.page=e.page+1,r.limit=e.rows;const{page:d,limit:a}=r;i.push({name:"report.rent.buy",query:{page:d,limit:a}}),await f(),l.customer_id=h.data.props.length>0?h.data.props[0].id:void 0,l.service_model="all"}const B=$(()=>{let e=0;return r.page&&r.limit&&(e=(r.page-1)*r.limit),e});return T(async()=>{await f(),await w(),l.service_model="all",l.customer_id=h.data.props.length>0?h.data.props[0].id:void 0}),(e,d)=>(K(),F("div",X,[o("div",G,[o("span",H,[o("h2",J,n(e.$t("table.title.report_rent_buy")),1)])]),s(t(z),{value:t(c).data.props,onPage:k,paginator:"",first:B.value,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem",loading:t(c).isLoading,lazy:"",totalRecords:t(c).data.total,rows:t(r).limit,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:`${e.$t("table.pagination.show")} {first} ${e.$t("table.pagination.to")} {last} ${e.$t("table.pagination.from")} {totalRecords} ${e.$t("table.pagination.row")}`},{header:_(()=>[o("div",Q,[o("div",Y,[o("label",null,[u(n(e.$t("messages.search"))+" ",1),Z]),s(t(E),{modelValue:v.value,"onUpdate:modelValue":d[0]||(d[0]=a=>v.value=a),placeholder:e.$t("placeholder.textSearch"),style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",name:"search",onKeyup:M(p,["enter"]),onInput:P},null,8,["modelValue","placeholder"])]),o("div",x,[o("label",null,n(e.$t("messages.owner")),1),s(t(S),{name:"customer",modelValue:t(l).customer_id,"onUpdate:modelValue":d[1]||(d[1]=a=>t(l).customer_id=a),options:t(h).data.props,optionLabel:a=>`${a.customer_number} - ${a.name} - ${a.tel}`,placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:p},null,8,["modelValue","options","optionLabel","placeholder"])]),o("div",ee,[o("label",null,n(e.$t("messages.status")),1),s(t(S),{name:"real_estate_type",modelValue:t(l).service_model,"onUpdate:modelValue":d[2]||(d[2]=a=>t(l).service_model=a),options:L.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,onChange:p},null,8,["modelValue","options","placeholder"])]),o("div",te,[o("label",null,n(e.$t("messages.start_date")),1),s(t(V),{modelValue:t(l).from_date,"onUpdate:modelValue":d[3]||(d[3]=a=>t(l).from_date=a),showIcon:"",style:{width:"100%"},onDateSelect:p,onInput:p},null,8,["modelValue"])]),o("div",ae,[o("label",null,n(e.$t("messages.end_date")),1),s(t(V),{modelValue:t(l).to_date,"onUpdate:modelValue":d[4]||(d[4]=a=>t(l).to_date=a),showIcon:"",style:{width:"100%"},onDateSelect:p,onInput:p},null,8,["modelValue"])]),o("div",le,[s(t(O),{icon:"pi pi-refresh",severity:"warning",style:{"margin-top":"22px !important",color:"white"},onClick:C})])])]),default:_(()=>[s(t(m),{field:"id",header:e.$t("table.header.index")},{body:_(a=>[u(n(a.index+1),1)]),_:1},8,["header"]),s(t(m),{field:"date",header:e.$t("table.header.date_rent"),headerStyle:"min-width: 7rem"},null,8,["header"]),s(t(m),{field:"number",header:e.$t("table.header.rent_number"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(t(m),{field:"customer_name",header:e.$t("table.header.customer_name"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(t(m),{field:"customer_tel",header:e.$t("table.header.customer_phone"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(t(m),{header:e.$t("table.header.info_account"),headerStyle:"min-width: 25rem"},{body:_(({data:a})=>[u(n(a.real_estate_list.account.customer_number)+" ",1),o("span",null,[re,u(" "+n(a.real_estate_list.account.name),1)]),o("span",null,[oe,u(" "+n(a.real_estate_list.account.owner),1)]),o("span",null,[se,u(" "+n(a.real_estate_list.account.tel),1)])]),_:1},8,["header"]),s(t(m),{field:"real_estate_list.real_esate_number",header:e.$t("table.header.real_esate_number"),headerStyle:"min-width: 12rem"},null,8,["header"]),s(t(m),{field:"real_estate_list.name",header:e.$t("table.header.name"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(t(m),{field:"real_estate_list.real_estate_type.name",header:e.$t("table.header.real_estate_type"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(t(m),{field:"service_model",header:e.$t("table.header.service_model"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(t(m),{field:"from_date",header:e.$t("table.header.from_date"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(t(m),{field:"to_date",header:e.$t("table.header.to_date"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(t(m),{header:e.$t("table.header.price"),headerStyle:"min-width: 15rem"},{body:_(({data:a})=>[u(n(t(R)(a.price,a.currency))+" - ( "+n(a.qty)+" / "+n(a.unit_price)+") ",1)]),_:1},8,["header"]),s(t(m),{header:e.$t("table.header.total"),headerStyle:"min-width: 13rem"},{body:_(({data:a})=>[u(n(t(R)(a.total,a.currency)),1)]),_:1},8,["header"])]),_:1},8,["value","first","loading","totalRecords","rows","currentPageReportTemplate"])]))}});export{$e as default};
