import{d as ye,r as b,l as Be,E as w,g as a,j as H,f as t,t as d,K as L,y as l,L as Ae,u as He,M as Ke,N as Me,a as Ge,H as Qe,O as We,P as U,o as Ye,e as oe,T as Je,Q as _,n as Xe,U as Ze,h as ea,b as N,V as re,p as aa,k as ta,_ as la}from"./index-LiYCI9b4.js";import{s as h,a as sa}from"./column.esm-eMIfGwkp.js";import{s as ne}from"./inputtext.esm-jR-1LoTE.js";import{c as ia,_ as oa}from"./Change-User-Password.Component.vue_vue_type_script_setup_true_lang-JAMPVjxe.js";import{c as ra}from"./country.store-7pBff_jA.js";import{s as de}from"./dropdown.esm-PQ4NbItx.js";import{s as na}from"./fieldset.esm-U1l1yXLo.js";import{_ as P}from"./FormInputText.vue_vue_type_script_setup_true_lang-rhnWwfQL.js";import{u as da}from"./vee-validate.esm-nVzzbcNn.js";import{c as ca,a as S}from"./index.esm-j5NAW6qz.js";import{_ as ce}from"./FormInputPassword.vue_vue_type_script_setup_true_lang-ca6Ey9Jn.js";import{_ as ue,u as me}from"./upload-file-3DrkgJnN.js";import{a as pe}from"./axios.config-EMV3l8KB.js";import{s as j}from"./image.esm-_z96pXTQ.js";import{v as fe,s as D,i as he}from"./toast-FY7odgkM.js";import{v as O}from"./validation-permissions-V2luqZML.js";import"./index.esm-PaVpzf48.js";import"./overlayeventbus.esm-LxMOlmSU.js";import"./index.esm-Crny-0lw.js";import"./checkbox.esm-83nsXBxg.js";import"./index.esm-3gEFqxB3.js";import"./index.esm-DkVABTBB.js";const ua=(p,s=!1)=>{let u=ca({name:S().required(p.name),address:S().required(p.address),tel:S().required(p.tel),email:S().required(p.email),id_no:S().required(p.id_no)});return s&&(u=u.shape({password:S().required(p.password),password_confirmation:S().required(p.password_confirmation),id_image:S().required(p.id_image)})),u},ge=ua,ma={class:"box-info"},pa={class:"box-left"},fa={class:"box-profile"},ha={class:"profile"},ga=ye({__name:"ViewCustomer",props:{data:{}},emits:["onSuccess","onHide"],setup(p,{expose:s,emit:u}){const T=b(!1);s({visible:T});const c=p;return(f,g)=>(H(),Be(a(Ae),{visible:T.value,"onUpdate:visible":g[0]||(g[0]=v=>T.value=v),modal:"",header:f.$t("table.title.customer"),style:{width:"50vw"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:w(()=>[t("div",ma,[t("div",pa,[t("p",null,d(f.$t("table.header.customer_number"))+": "+d(c.data.customer_number),1),t("p",null,d(f.$t("table.header.full_name"))+": "+d(c.data.name),1),t("p",null,d(f.$t("table.header.address"))+": "+d(c.data.address),1),t("p",null,d(f.$t("table.header.country"))+": "+d(c.data.country.name),1),t("p",null,d(f.$t("table.header.phone_number"))+": "+d(c.data.tel),1),t("p",null,d(f.$t("table.header.email"))+": "+d(c.data.email),1),t("p",null,d(f.$t("table.header.id_no"))+": "+d(c.data.id_no),1),t("div",fa,[t("div",null,[L(d(f.$t("table.header.id_image"))+": ",1),t("p",null,[l(a(j),{src:c.data.id_image,alt:"Image",class:"img"},null,8,["src"])])]),t("div",ha,[L(d(f.$t("table.header.profile"))+": ",1),t("p",null,[l(a(j),{src:c.data.user.profile,alt:"Image",class:"img"},null,8,["src"])])])])])])]),_:1},8,["visible","header"]))}}),q=p=>(aa("data-v-5e4f1f95"),p=p(),ta(),p),ya={key:0,class:"card"},ba={class:"flex align-items-center pl-2"},wa=q(()=>t("i",{class:"pi pi-users",style:{"font-size":"20px"}},null,-1)),_a={class:"font-bold"},va={class:"col-12 md:col-12 flex flex-row"},$a={class:"col-12 md:col-3"},Sa=q(()=>t("span",{class:"text-red-500"}," *",-1)),Ca={class:"col-12 md:col-3"},Ta={class:"col-12 md:col-6"},ka={class:"col-12 md:col-12 flex flex-row is-margin-top"},La={class:"col-12 md:col-3"},Va={class:"col-12 md:col-3"},Ia={class:"col-12 md:col-3"},Pa={class:"col-12 md:col-3"},qa={class:"col-12 md:col-12 flex flex-row is-margin-top"},Ea={class:"col-12 md:col-4"},Fa={class:"col-12 md:col-4"},Ra={class:"col-12 md:col-4"},Ua={class:"custom-button-container"},Na=q(()=>t("i",{class:"pi pi-sync",style:{"margin-right":"8px"}},null,-1)),Da={class:"card"},Oa={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},ja={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},xa={class:"mb-3"},za={class:"w-full sm:w-auto flex-order-0 sm:flex-order-1 mb-4 sm:mb-0"},Ba={class:"col-12 md:col-12 flex flex-row"},Aa={class:"col-12 md:col-3"},Ha={class:"p-input-icon-left w-full flex-order-1 sm:flex-order-0"},Ka={class:"col-12 md:col-3"},Ma={class:"p-input-icon-left w-full flex-order-1 sm:flex-order-0"},Ga=q(()=>t("i",{class:"pi pi-search",style:{"margin-top":"-10px"}},null,-1)),Qa={class:"col-12 md:col-4"},Wa={class:"p-input-icon-left w-full flex-order-1 sm:flex-order-0"},Ya=q(()=>t("i",{class:"pi pi-search",style:{"margin-top":"-10px"}},null,-1)),Ja={class:"col-12 md:col-2"},Xa={class:"p-input-icon-left w-full flex-order-1 sm:flex-order-0"},Za={class:"flex flex-wrap gap-2 btn-right"},et=ye({__name:"ListCustomer",setup(p){const{t:s}=He(),u=Ke(),T=Me(),c=b(!1),f=b(),g=b(!1),v=b(!0),K=b(),{push:E}=Ge(),{query:C}=Qe(),{register:be,update:we,remove:_e,getAll:F,form:n,state:m,setStateFilter:o,updateStatus:ve,changeUserPassword:$e}=ia(),{getAll:Se,state:$,setStateFilter:Ce}=ra(),M={name:s("placeholder.inputText"),address:s("placeholder.inputText"),tel:s("placeholder.inputText"),email:s("placeholder.inputText"),password:s("placeholder.inputText"),password_confirmation:s("placeholder.inputText"),id_no:s("placeholder.inputText"),id_image:s("placeholder.inputText")},G=b(),Q=b(),W=b(),Te=async e=>{W.value=e,K.value.visible=!0},ke=async e=>{Q.value=e,G.value.visible=!0},Y=async()=>{await B(),await V(),$.data.props.unshift({id:"all",name:s("messages.all")})},J=b(ge(M,v.value)),Le=()=>{J.value=ge(M,v.value)};We(v,()=>{Le()});const{handleSubmit:X,handleReset:x,setFieldValue:k}=da({validationSchema:J}),Ve=X(async e=>{if(n.id=e.id,n.name=e.name,n.address=e.address,n.tel=e.tel,n.email=e.email,n.id_no=e.id_no,n.id_image=I.value,n.profile=R.value,await we(),m.error)await ee();else{await Z(),await x(),await z(),g.value=!1,c.value=!1,v.value=!0,I.value="";const i=document.getElementById("id_image");i.value="",R.value="";const r=document.getElementById("profile");r.value=""}}),Ie=X(async e=>{if(n.name=e.name,n.address=e.address,n.email=e.email,n.tel=e.tel,n.password=e.password,n.password_confirmation=e.password_confirmation,n.id_no=e.id_no,n.id_image=I.value,n.profile=R.value,await be(),m.error)await ee();else{await Z(),await x(),await z(),I.value="";const i=document.getElementById("id_image");i.value="",g.value=!1}}),z=async()=>{Ce.limit=200,await Se(),n.country_id=$.data.props.length>0?$.data.props[0].id:void 0},Pe=async()=>{c.value=!1,v.value=!0,g.value?g.value=!1:g.value=!0},qe=async()=>{m.btnLoading=!1,await x(),c.value=!1,g.value=!1},Ee=async()=>{m.btnLoading=!0,c.value=!1,o.filter&&(o.filter.name="",o.filter.country_id="",o.filter.tel=""),await B(),await V(),m.btnLoading=!1},Fe=async e=>{await _e(e),await V()},Re=async e=>{await ve(e),await V()},Ue=async e=>{var i;k("id",e.id),k("name",e.name),k("address",e.address),k("email",e.email),k("tel",e.tel),k("id_no",e.id_no),n.country_id=(i=e.country)==null?void 0:i.id,e.user&&(n.user_id=e.user.id),c.value=!0,g.value=!0,v.value=!1,await ie(),await ie()};async function Ne(e){o.page=e.page+1,o.limit=e.rows;const{page:i,limit:r,filter:y}=o;E({name:"customer",query:{page:i,limit:r,search:y!=null&&y.name?y.name:void 0}}),await F()}const De=U(()=>{let e=0;return o.page&&o.limit&&(e=(o.page-1)*o.limit),e}),Oe=async e=>{T.require({message:s("confirmDelete.message"),header:s("confirmDelete.header"),rejectLabel:s("confirmDelete.rejectLabel"),acceptLabel:s("confirmDelete.acceptLabel"),rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-danger",accept:async()=>{await Fe(e),u.add({severity:"success",summary:s("toast.summary.delete"),detail:s("toast.detail.delete"),life:3e3})},reject:()=>{u.add({severity:"error",summary:s("toast.summary.cancel_delete"),detail:s("toast.detail.cancel_delete"),life:3e3})}})},je=async e=>{T.require({message:s("confirmUpdateStatus.message"),header:s("confirmUpdateStatus.header"),rejectLabel:s("confirmUpdateStatus.rejectLabel"),acceptLabel:s("confirmUpdateStatus.acceptLabel"),rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-danger",accept:async()=>{await Re(e),u.add({severity:"success",summary:s("toast.summary.success"),detail:s("toast.detail.successfully"),life:3e3})},reject:()=>{u.add({severity:"error",summary:s("toast.summary.cancel_update"),detail:s("toast.detail.cancel_update"),life:3e3})}})},Z=()=>{u.add({severity:"success",summary:s("toast.summary.success"),detail:s("toast.detail.successfully"),life:3e3})},ee=()=>{u.add({severity:"error",summary:s("toast.summary.error"),detail:`${m.error}`,life:3e3})};async function B(){var e,i;Object.keys(C).length!==0&&(o.page=C.page?Number(C.page):1,o.limit=C.limit?Number(C.limit):10,((e=o.filter)==null?void 0:e.name)===""?(o.filter.name=C.search?C.search:"",E({query:{page:o.page,limit:o.limit,search:void 0}})):E({query:{page:o.page,limit:o.limit,search:(i=o.filter)==null?void 0:i.name}})),await F()}Ye(async()=>{await B(),await V(),$.data.props.unshift({id:"all",name:s("messages.all")}),n.country_id=$.data.props.length>0?$.data.props[0].id:void 0});const V=async()=>{await z()},ae=U({get:()=>o.filter.name,set:e=>{o.filter?o.filter.name=e:o.filter={name:e}}}),te=U({get:()=>o.filter.country_id||"",set:e=>{o.filter&&(o.filter.country_id=e)}}),le=U({get:()=>{var e;return((e=o.filter)==null?void 0:e.tel)||""},set:e=>{o.filter&&(o.filter.tel=e)}});async function A(){await F()}async function se(e){var i;e.target.value===""&&(((i=o.filter)==null?void 0:i.name)!==void 0&&(o.filter.name=""),E({query:{name:void 0}}),await F())}const ie=async()=>{var e;if(f.value){const i=f.value.$el,r=i.getBoundingClientRect();r.top>=0&&r.bottom<=window.innerHeight?(e=i.querySelector("input"))==null||e.focus():(window.scrollTo({top:window.scrollY+r.top-window.innerHeight/2,behavior:"smooth"}),setTimeout(()=>{var y;(y=i.querySelector("input"))==null||y.focus()},500))}},I=b(),xe=async e=>{const i=e.target.files[0];if(!await fe(i)){await D({toast:u,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.profile_valid_file_mimes")}),e.target.value="";return}if(!await he(i)){await D({toast:u,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.profile_valid_file_size")}),e.target.value="";return}await me({axios:pe,file:i,state:m,selectedImage:I,toast:u,t:s})},R=b(),ze=async e=>{const i=e.target.files[0];if(!await fe(i)){await D({toast:u,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.profile_valid_file_mimes")}),e.target.value="";return}if(!await he(i)){await D({toast:u,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.profile_valid_file_size")}),e.target.value="";return}await me({axios:pe,file:i,state:m,selectedImage:R,toast:u,t:s})};return(e,i)=>(H(),oe("div",null,[l(Je,{name:"fade",mode:"out-in"},{default:w(()=>[g.value?(H(),oe("div",ya,[l(a(na),null,{legend:w(()=>[t("div",ba,[wa,t("span",_a,d(e.$t("messages.form_register_customer")),1)])]),default:w(()=>[t("form",{onSubmit:i[2]||(i[2]=Ze(r=>c.value?a(Ve)():a(Ie)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[t("div",va,[t("div",$a,[t("label",null,[L(d(e.$t("messages.select"))+" "+d(e.$t("messages.country"))+" ",1),Sa]),l(a(de),{style:{"margin-top":"8px"},modelValue:a(n).country_id,"onUpdate:modelValue":i[0]||(i[0]=r=>a(n).country_id=r),options:a($).data.props,optionLabel:"name",optionValue:"id",highlightOnSelect:!0,placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full md:w-14rem"},null,8,["modelValue","options","placeholder"])]),t("div",Ca,[l(P,{ref_key:"autoFocusCursor",ref:f,name:"name",label:e.$t("messages.full_name"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),t("div",Ta,[l(P,{name:"address",label:e.$t("messages.address"),required:"",placeholder:e.$t("placeholder.inputTextAddress"),class:"h-full"},null,8,["label","placeholder"])])]),t("div",ka,[t("div",La,[l(P,{name:"tel",label:e.$t("messages.phone_number"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),t("div",Va,[l(P,{name:"email",label:e.$t("messages.email"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",isEditing:c.value},null,8,["label","placeholder","isEditing"])]),t("div",Ia,[l(ce,{name:"password",label:e.$t("messages.password"),placeholder:e.$t("placeholder.inputText"),disabled:c.value},null,8,["label","placeholder","disabled"])]),t("div",Pa,[l(ce,{name:"password_confirmation",label:e.$t("messages.confirm_password"),placeholder:e.$t("placeholder.inputText"),disabled:c.value},null,8,["label","placeholder","disabled"])])]),t("div",qa,[t("div",Ea,[l(ue,{name:"profile",label:e.$t("messages.profile"),required:"",multiple:!0,class:"h-full",onChange:ze},null,8,["label"])]),t("div",Fa,[l(P,{name:"id_no",label:e.$t("messages.id_no"),required:"",placeholder:e.$t("placeholder.inputTextIdNo"),class:"h-full"},null,8,["label","placeholder"])]),t("div",Ra,[l(ue,{name:"id_image",label:e.$t("messages.id_image"),required:"",multiple:!0,class:"h-full",onChange:xe},null,8,["label"])])]),t("div",Ua,[l(a(_),{type:"submit",severity:"warning",loading:a(m).btnLoading,style:{"margin-right":"8px"}},{default:w(()=>[t("i",{class:Xe(c.value?"pi pi-pencil":"pi pi-plus-circle"),style:{"margin-right":"8px"}},null,2),L(" "+d(c.value?e.$t("button.edit"):e.$t("button.save"))+" "+d(e.$t("messages.customer")),1)]),_:1},8,["loading"]),l(a(_),{severity:"danger",loading:a(m).btnLoading,onClick:i[1]||(i[1]=r=>qe())},{default:w(()=>[Na,L(" "+d(e.$t("button.clear")),1)]),_:1},8,["loading"])])],32)]),_:1})])):ea("",!0)]),_:1}),t("div",Da,[t("div",Oa,[t("span",ja,[t("h2",xa,d(e.$t("table.title.customer")),1)]),t("span",za,[l(a(_),{label:g.value?e.$t("button.close"):e.$t("button.add")+" "+e.$t("messages.customer"),rounded:"",severity:g.value?"danger":"info",onClick:Pe,loading:a(m).btnLoading,disabled:a(O)(a(N).CUSTOMER.CREATE)},null,8,["label","severity","loading","disabled"])])]),l(a(sa),{value:a(m).data.props,loading:a(m).isLoading,lazy:"",tableStyle:"min-width: 50rem",totalRecords:a(m).data.total,onPage:Ne,paginator:"",first:De.value,scrollable:"",rows:a(o).limit,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:`${e.$t("table.pagination.show")} {first} ${e.$t("table.pagination.to")} {last} ${e.$t("table.pagination.from")} {totalRecords} ${e.$t("table.pagination.row")}`},{header:w(()=>[t("div",Ba,[t("div",Aa,[t("span",Ha,[l(a(de),{modelValue:te.value,"onUpdate:modelValue":i[3]||(i[3]=r=>te.value=r),options:a($).data.props,optionLabel:"name",optionValue:"id",highlightOnSelect:!0,placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full md:w-14rem",onChange:A},null,8,["modelValue","options","placeholder"])])]),t("div",Ka,[t("span",Ma,[Ga,l(a(ne),{modelValue:ae.value,"onUpdate:modelValue":i[4]||(i[4]=r=>ae.value=r),placeholder:`${e.$t("placeholder.textSearch")} (${e.$t("messages.full_name")})`,style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",onKeyup:re(A,["enter"]),onInput:se},null,8,["modelValue","placeholder"])])]),t("div",Qa,[t("span",Wa,[Ya,l(a(ne),{modelValue:le.value,"onUpdate:modelValue":i[5]||(i[5]=r=>le.value=r),placeholder:`${e.$t("placeholder.textSearch")} ${e.$t("messages.phone_number")}`,style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",onKeyup:re(A,["enter"]),onInput:se},null,8,["modelValue","placeholder"])])]),t("div",Ja,[t("span",Xa,[l(a(_),{icon:"pi pi-refresh",severity:"warning",onClick:i[6]||(i[6]=r=>Ee()),loading:a(m).btnLoading},null,8,["loading"])])])])]),default:w(()=>[l(a(h),{field:"id",header:e.$t("table.header.index")},{body:w(r=>[L(d(r.index+1),1)]),_:1},8,["header"]),l(a(h),{headerStyle:"min-width: 18rem",frozen:""},{body:w(({data:r})=>[t("div",Za,[l(a(_),{type:"button",label:r.status==="open"?e.$t("messages.open"):e.$t("messages.close"),rounded:"",severity:r.status==="open"?"success":"danger",onClick:y=>je(r.id),disabled:a(O)(a(N).CUSTOMER.UPDATE)},null,8,["label","severity","onClick","disabled"]),l(a(_),{type:"button",icon:"pi pi-eye",rounded:"",severity:"info",style:{color:"white"},onClick:y=>Te(r)},null,8,["onClick"]),l(a(_),{type:"button",icon:"pi pi-lock",rounded:"",severity:"danger",style:{color:"white"},onClick:y=>ke(r.user.id)},null,8,["onClick"]),l(a(_),{type:"button",icon:"pi pi-pencil",rounded:"",severity:"warning",style:{color:"white"},onClick:y=>Ue(r),disabled:a(O)(a(N).CUSTOMER.UPDATE)},null,8,["onClick","disabled"]),l(a(_),{type:"button",icon:"pi pi-trash",rounded:"",severity:"danger",onClick:y=>Oe(r.id),disabled:a(O)(a(N).CUSTOMER.DELETE)},null,8,["onClick","disabled"])])]),_:1}),l(a(h),{header:e.$t("table.header.profile"),headerStyle:"min-width: 8rem",frozen:""},{body:w(({data:r})=>[l(a(j),{src:r.user.profile,alt:"Image",preview:"",style:{"max-width":"80px"}},null,8,["src"])]),_:1},8,["header"]),l(a(h),{field:"id_image",header:e.$t("table.header.id_image"),headerStyle:"min-width: 8rem",frozen:""},{body:w(({data:r})=>[l(a(j),{src:r.id_image,alt:"Image",preview:"",style:{"max-width":"80px"}},null,8,["src"])]),_:1},8,["header"]),l(a(h),{field:"id_no",header:e.$t("table.header.id_no"),headerStyle:"min-width: 10rem"},null,8,["header"]),l(a(h),{field:"country.name",header:e.$t("table.header.country"),headerStyle:"min-width: 5rem"},null,8,["header"]),l(a(h),{field:"customer_number",header:e.$t("table.header.customer_number"),headerStyle:"min-width: 8rem"},null,8,["header"]),l(a(h),{field:"name",header:e.$t("table.header.full_name"),headerStyle:"min-width: 8rem"},null,8,["header"]),l(a(h),{field:"address",header:e.$t("table.header.address"),headerStyle:"min-width: 10rem"},null,8,["header"]),l(a(h),{field:"tel",header:e.$t("table.header.phone_number"),headerStyle:"min-width: 8rem"},null,8,["header"]),l(a(h),{field:"email",header:e.$t("table.header.email")},null,8,["header"]),l(a(h),{field:"status",header:e.$t("table.header.status"),headerStyle:"min-width: 5rem"},null,8,["header"]),l(a(h),{field:"created",header:e.$t("table.header.created_at"),headerStyle:"min-width: 8rem"},null,8,["header"]),l(a(h),{field:"updated",header:e.$t("table.header.updated_at"),headerStyle:"min-width: 8rem"},null,8,["header"])]),_:1},8,["value","loading","totalRecords","first","rows","currentPageReportTemplate"])]),l(oa,{ref_key:"editForm",ref:G,form:a(n),"user-id":Q.value,"change-user-password":a($e),state:a(m),onOnSuccess:Y},null,8,["form","user-id","change-user-password","state"]),l(ga,{ref_key:"createForm",ref:K,data:W.value,onOnSuccess:Y},null,8,["data"])]))}}),St=la(et,[["__scopeId","data-v-5e4f1f95"]]);export{St as default};
