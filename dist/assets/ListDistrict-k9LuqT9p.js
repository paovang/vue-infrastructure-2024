import{d as ie,u as oe,N as le,O as re,r as q,a as ne,I as ce,Q as F,o as de,e as me,f as i,U as pe,j as r,g as t,h as j,H as f,i as A,t as h,l as x,L as I,b as S,s as w,V as ue,p as fe,m as he,_ as ge}from"./index-f9jq13DX.js";import{s as $,a as we}from"./column.esm-6fLzdzdt.js";import{s as ye}from"./inputtext.esm-l38rGW1g.js";import{d as ve}from"./district.store-R8x_E7Eg.js";import{p as be}from"./province.store-zVy-RhGV.js";import{u as _e}from"./vee-validate.esm-fRyzWJ45.js";import{c as Se,a as $e}from"./index.esm-vvWMVO1x.js";import{_ as Te}from"./FormInputText.vue_vue_type_script_setup_true_lang-m2X-DRnb.js";import{s as Ce}from"./dropdown.esm-MTHqqHeI.js";import{v as T}from"./validation-permissions-Kh-bgT4b.js";import"./paginator.esm-S02HluZ3.js";import"./inputnumber.esm-mMVjjCt5.js";import"./overlayeventbus.esm-3DHB7Tlp.js";import"./index.esm-UaoHDiFz.js";import"./checkbox.esm-hIsej9kC.js";import"./index.esm-WYq0Lbc-.js";import"./axios.config-8JNuCx_V.js";const Pe=p=>Se({name:$e().required(p.name)}),xe=Pe,L=p=>(fe("data-v-8ab97515"),p=p(),he(),p),Ie={class:"card card-first"},Le={class:"col-12 md:col-12 flex flex-row"},Re={class:"col-12 md:col-5"},ke={class:"flex flex-column h-full"},De={class:"col-12 md:col-5"},Ve={class:"flex flex-column h-full"},Ee={class:"col-12 md:col-2 flex flex-column"},Ne=L(()=>i("i",{class:"pi pi-plus-circle",style:{"margin-right":"8px"}},null,-1)),qe=L(()=>i("i",{class:"pi pi-plus-circle",style:{"margin-right":"8px"}},null,-1)),Fe={class:"card"},je={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},Ae={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},Be={class:"mb-3"},Ue={class:"w-full sm:w-auto flex-order-0 sm:flex-order-1 mb-4 sm:mb-0"},Me={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},Oe={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},He=L(()=>i("i",{class:"pi pi-search",style:{"margin-top":"-10px"}},null,-1)),Ke={class:"flex flex-wrap gap-2 btn-right"},ze=ie({__name:"ListDistrict",setup(p){const{t:l}=oe(),y=le(),B=re(),u=q(!1),C=q(),{push:v}=ne(),{query:d}=ce(),{register:U,update:M,remove:O,getAll:b,form:m,state:n,setStateFilter:a}=ve(),{getAll:H,state:P,setStateFilter:K}=be(),z={name:l("placeholder.inputText")},{handleSubmit:R,handleReset:_,setFieldValue:k}=_e({validationSchema:xe(z)}),G=async()=>{n.btnLoading=!0,u.value=!1,a.filter&&(a.filter.name=""),await _(),await E(),await g(),n.btnLoading=!1},Q=async e=>{await O(e),await _(),await g()},W=async e=>{var s;u.value=!0,m.province_id=(s=e.province)==null?void 0:s.id,k("id",e.id),k("name",e.name),await se()},Y=R(async e=>{m.id=e.id,m.name=e.name,await M(),n.error?V():(await D(),await _(),await g(),u.value=!1)}),J=R(async e=>{m.name=e.name,await U(),n.error?await V():(await D(),await _(),await g())});async function X(e){a.page=e.page+1,a.limit=e.rows;const{page:s,limit:o,filter:c}=a;v({name:"district",query:{page:s,limit:o,search:c!=null&&c.name?c.name:void 0}}),await b()}const Z=F(()=>{let e=0;return a.page&&a.limit&&(e=(a.page-1)*a.limit),e}),ee=async e=>{B.require({message:l("confirmDelete.message"),header:l("confirmDelete.header"),rejectLabel:l("confirmDelete.rejectLabel"),acceptLabel:l("confirmDelete.acceptLabel"),rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-danger",accept:async()=>{await Q(e),y.add({severity:"success",summary:l("toast.summary.delete"),detail:l("toast.detail.delete"),life:3e3})},reject:()=>{y.add({severity:"error",summary:l("toast.summary.cancel_delete"),detail:l("toast.detail.cancel_delete"),life:3e3})}})},D=()=>{y.add({severity:"success",summary:l("toast.summary.success"),detail:l("toast.detail.successfully"),life:3e3})},V=()=>{y.add({severity:"error",summary:l("toast.summary.error"),detail:`${n.error}`,life:3e3})};async function E(){var e,s;Object.keys(d).length!==0&&(a.page=d.page?Number(d.page):1,a.limit=d.limit?Number(d.limit):10,((e=a.filter)==null?void 0:e.name)===""?(a.filter.name=d.search?d.search:"",v({query:{page:a.page,limit:a.limit,search:void 0}})):v({query:{page:a.page,limit:a.limit,search:(s=a.filter)==null?void 0:s.name}})),await b()}de(async()=>{await E(),await g()});const g=async()=>{K.limit=200,await H(),m.province_id=P.data.props.length>0?P.data.props[0].id:void 0},N=F({get:()=>a.filter.name,set:e=>{a.filter?a.filter.name=e:a.filter={name:e}}});async function te(){await b()}async function ae(e){var s;e.target.value===""&&(((s=a.filter)==null?void 0:s.name)!==void 0&&(a.filter.name=""),v({query:{name:void 0}}),await b())}const se=()=>{var e;if(C.value){const s=C.value.$el,o=s.getBoundingClientRect();o.top>=0&&o.bottom<=window.innerHeight?(e=s.querySelector("input"))==null||e.focus():(window.scrollTo({top:window.scrollY+o.top-window.innerHeight/2,behavior:"smooth"}),setTimeout(()=>{var c;(c=s.querySelector("input"))==null||c.focus()},500))}};return(e,s)=>(x(),me("div",null,[i("div",Ie,[i("form",{onSubmit:s[1]||(s[1]=pe(o=>u.value?t(Y)():t(J)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[i("div",Le,[i("div",Re,[i("div",ke,[r(Te,{ref_key:"autoFocusCursor",ref:C,name:"name",label:e.$t("messages.name"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])])]),i("div",De,[i("div",Ve,[r(t(Ce),{modelValue:t(m).province_id,"onUpdate:modelValue":s[0]||(s[0]=o=>t(m).province_id=o),options:t(P).data.props,optionLabel:"name",placeholder:"ກະລຸນາເລືອກກ່ອນ...",optionValue:"id",highlightOnSelect:!0,class:"w-full md:w-14rem"},null,8,["modelValue","options"])])]),i("div",Ee,[u.value?A("",!0):(x(),j(t(w),{key:0,type:"submit",disabled:t(T)(t(S).DISTRICT.CREATE)},{default:f(()=>[Ne,I(" "+h(e.$t("button.save"))+" "+h(e.$t("messages.district")),1)]),_:1},8,["disabled"])),u.value?(x(),j(t(w),{key:1,type:"submit",severity:"warning",disabled:t(T)(t(S).DISTRICT.UPDATE)},{default:f(()=>[qe,I(" "+h(e.$t("button.edit"))+" "+h(e.$t("messages.district")),1)]),_:1},8,["disabled"])):A("",!0)])])],32)]),i("div",Fe,[i("div",je,[i("span",Ae,[i("h2",Be,h(e.$t("table.title.district")),1)]),i("span",Ue,[r(t(w),{icon:"pi pi-refresh",rounded:"",severity:"warning",onClick:s[2]||(s[2]=o=>G()),loading:t(n).btnLoading},null,8,["loading"])])]),r(t(we),{value:t(n).data.props,loading:t(n).isLoading,lazy:"",tableStyle:"min-width: 50rem",totalRecords:t(n).data.total,onPage:X,paginator:"",first:Z.value,rows:t(a).limit,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:`${e.$t("table.pagination.show")} {first} ${e.$t("table.pagination.to")} {last} ${e.$t("table.pagination.from")} {totalRecords} ${e.$t("table.pagination.row")}`},{header:f(()=>[i("div",Me,[i("span",Oe,[He,r(t(ye),{modelValue:N.value,"onUpdate:modelValue":s[3]||(s[3]=o=>N.value=o),placeholder:e.$t("placeholder.textSearch"),style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",onKeyup:ue(te,["enter"]),onInput:ae},null,8,["modelValue","placeholder"])])])]),default:f(()=>[r(t($),{field:"id",header:e.$t("table.header.index"),style:{width:"25%"}},{body:f(o=>[I(h(o.index+1),1)]),_:1},8,["header"]),r(t($),{field:"name",header:e.$t("table.header.district"),style:{width:"25%"}},null,8,["header"]),r(t($),{field:"province.name",header:e.$t("table.header.province"),style:{width:"25%"}},null,8,["header"]),r(t($),{headerStyle:"width: 10rem"},{body:f(({data:o})=>[i("div",Ke,[r(t(w),{type:"button",icon:"pi pi-pencil",rounded:"",severity:"warning",style:{color:"white"},onClick:c=>W(o),disabled:t(T)(t(S).DISTRICT.UPDATE)},null,8,["onClick","disabled"]),r(t(w),{type:"button",icon:"pi pi-trash",rounded:"",severity:"danger",onClick:c=>ee(o.id),disabled:t(T)(t(S).DISTRICT.DELETE)},null,8,["onClick","disabled"])])]),_:1})]),_:1},8,["value","loading","totalRecords","first","rows","currentPageReportTemplate"])])]))}}),dt=ge(ze,[["__scopeId","data-v-8ab97515"]]);export{dt as default};
