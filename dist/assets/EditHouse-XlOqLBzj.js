import{d as B,C as Z,a4 as W,c as m,e as t,O as h,t as F,f as G,q as o,Y as X,n as K,b as e,o as _,L as xe,a as Me,A as f,G as Se,z as $,Q as Ce,p as Le,h as Oe,F as R,g as P,w as Ue,a3 as $e,P as k,_ as Fe}from"./index-1gkhu5AI.js";import{b as ee,s as Ge,u as Ne}from"./index.esm-vLmxGVPX.js";import{s as je,h as De,a as D}from"./panel.esm-zViWWg56.js";import{s as w}from"./dropdown.esm-EXqFucAq.js";import{a as Be}from"./index.esm-gXsFauFS.js";import{h as Je,s as Q}from"./divider.esm-kCB_NwHs.js";import{r as Te}from"./real-estate-service.store-xAMkQ21U.js";import{p as Ye}from"./province.store-jpU27fgB.js";import{d as ze}from"./district.store-xaVF5yDi.js";import{c as H}from"./axios.config-_uGP-K9E.js";import"./index.esm-0fkfUnNi.js";import"./index.esm-VhLUVDKt.js";const Ee={class:"flex flex-column gap-2 mb-3"},qe=["for"],Ae={key:0,class:"text-red-500"},Re=["id"],x=B({__name:"FormEditInputText",props:{name:{},label:{},required:{type:Boolean},placeholder:{},value:{},isEditing:{type:Boolean}},setup(v){const c=v,{value:u,errorMessage:y}=ee(c.name),l=Z();W(()=>c.value,M=>{u.value=M});const r=["country","province","district"],b=(l==null?void 0:l.name)!==null&&(l==null?void 0:l.name)!==void 0&&r.includes(l.name);return(M,g)=>(_(),m("div",Ee,[t(b)?G("",!0):(_(),m("label",{key:0,for:c.name},[h(F(c.label)+" ",1),c.required?(_(),m("span",Ae," *")):G("",!0)],8,qe)),o(t(Ge),{modelValue:t(u),"onUpdate:modelValue":g[0]||(g[0]=N=>X(u)?u.value=N:null),id:c.name,class:K({"p-invalid":t(y)}),type:"text","aria-describedby":`text-error-${c.name}`,placeholder:c.placeholder},null,8,["modelValue","id","class","aria-describedby","placeholder"]),e("small",{class:"p-error",id:`text-error-${c.name}`},F(t(y)),9,Re)]))}}),Pe={class:"flex flex-column gap-2 mb-3 w-full"},Qe=["for"],He={key:0,class:"text-red-500"},Ze=["id"],We=B({__name:"FormEditTextArea",props:{name:{},label:{},required:{type:Boolean},placeholder:{},value:{}},setup(v){const c=v,{value:u,errorMessage:y}=ee(()=>c.name);return W(()=>c.value,l=>{u.value=l}),(l,r)=>(_(),m("div",Pe,[e("label",{for:l.name},[h(F(l.label)+" ",1),l.required?(_(),m("span",He," *")):G("",!0)],8,Qe),o(t(je),{"auto-resize":"",rows:"5",modelValue:t(u),"onUpdate:modelValue":r[0]||(r[0]=b=>X(u)?u.value=b:null),id:l.name,class:K({"p-invalid":t(y)}),"aria-describedby":`text-error-${l.name}`,placeholder:l.placeholder},null,8,["modelValue","id","class","aria-describedby","placeholder"]),e("small",{class:"p-error",id:`text-error-${l.name}`},F(t(y)),9,Ze)]))}}),p=v=>(Le("data-v-9e44adfd"),v=v(),Oe(),v),Xe={class:"card"},Ke={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},el={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},ll=p(()=>e("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),tl=p(()=>e("br",null,null,-1)),al={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},il={class:"column is-mobile-12 is-2"},sl=p(()=>e("label",null,[h(" ປະເພດ ບໍລິການ "),e("span",{class:"text-red-500"}," *")],-1)),ol={class:"column is-mobile-12 is-2"},nl=p(()=>e("label",null,[h(" ຮູບເເບບ ບໍລິການ "),e("span",{class:"text-red-500"}," *")],-1)),rl={class:"column is-mobile-12 is-2"},dl=p(()=>e("label",null,[h(" ປະເພດຫ້ອງ "),e("span",{class:"text-red-500"}," *")],-1)),cl={class:"column is-mobile-12 is-2"},pl=p(()=>e("label",null,[h(" ເເຂວງ "),e("span",{class:"text-red-500"}," *")],-1)),ul={class:"column is-mobile-12 is-2"},ml=p(()=>e("label",null,[h(" ເມືອງ "),e("span",{class:"text-red-500"}," *")],-1)),_l={class:"column is-mobile-12 is-2"},hl={class:"column is-mobile-12 is-2"},yl={class:"column is-mobile-12 is-2"},vl={class:"column is-mobile-12 is-2"},fl={class:"column is-mobile-12 is-6"},gl={class:"column is-mobile-12 is-12"},wl={class:"column is-12"},bl={class:"column is-3"},Il=p(()=>e("label",null,[h(" ຮູບເເບບ ບໍລິການ "),e("span",{class:"text-red-500"}," *")],-1)),Vl={class:"column is-3"},kl=p(()=>e("label",null,[h(" ລາຄາ "),e("span",{class:"text-red-500"}," *")],-1)),xl={class:"column is-5"},Ml=p(()=>e("label",null," ລາຍລະອຽດ ",-1)),Sl=["onUpdate:modelValue"],Cl={class:"column is-1"},Ll=["onClick"],Ol=p(()=>e("i",{class:"pi pi-times-circle"},null,-1)),Ul=[Ol],$l={class:"column is-12"},Fl={class:"columns is-12 is-multiline"},Gl={class:"column is-mobile-12 is-3"},Nl={class:"card",style:{padding:"0rem !important"}},jl={class:"card-image"},Dl={class:"image is-4by3"},Bl=["src"],Jl={class:"content",style:{display:"flex","justify-content":"center"}},Tl={style:{padding:"10px !important"}},Yl={class:"column is-12"},zl={class:"columns is-12 is-multiline"},El={class:"card",style:{padding:"0rem !important"}},ql={class:"card-image"},Al={class:"image is-4by3"},Rl=["src"],Pl={class:"content",style:{display:"flex","justify-content":"center"}},Ql={style:{padding:"10px !important"}},Hl=p(()=>e("span",{style:{"margin-left":"10px"}},null,-1)),Zl={class:"column is-mobile-12 is-12",style:{"text-align":"right"}},Wl={class:"column is-mobile-12 is-12 text-right"},Xl=p(()=>e("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),Kl=B({__name:"EditHouse",setup(v){const c=xe(),u=Me(),y=Z(),{form:l,state:r,update:b,getOne:M,houseGetByOne:g,deleteGallery:N,updateGallery:le,addGallery:te}=Je(),{getOne:ae,realestateType:ie}=Te(),{getAll:se,state:oe,setStateFilter:ne}=Ye(),{getAll:J,state:re,setStateFilter:S}=ze(),C=f(),j=f(),T=f([{id:"",image:""}]),I=f(),Y=f(),de=async()=>{u.push({name:"owner.house"})},ce=async()=>{l.prices&&l.prices.push({price:"",unit_price:"",detail:""})},pe=async a=>{l.prices&&l.prices.splice(a,1)},{handleSubmit:ue}=Ne({validationSchema:De}),me=f([{id:"sale",name:"ຂາຍ"},{id:"rent",name:"ເຊົ່າ"}]),_e=f([{id:"air",name:"ເເອ"},{id:"fan",name:"ພັດລົມ"},{id:"no",name:"ບໍ່ມີ"}]),he=f([{id:"day",name:"ມື້"},{id:"month",name:"ເດືອນ"},{id:"year",name:"ປີ"}]);Se(async()=>{await V()});const V=async()=>{const a=Number(y.params.id);r.btnLoading=!0,await M(a),await ye(),r.btnLoading=!1},ye=async()=>{const a=g.data.props;l.room_type=a.room_type,l.service_model=a.service_model,l.village=a.village,l.zip_code=a.zip_code,l.wide=a.wide,l.long=a.long,l.remark=a.remark,l.location=a.location,l.prices=a.price,l.prices=a.price,C.value=a.image,T.value=a.gallery,ne.limit=1e3,await se(),await ae(),l.real_estate_type_id=a.real_estate_type?a.real_estate_type.id:void 0,l.province_id=a.province?a.province.id:void 0,S.filter&&(S.filter.province_id=l.province_id,await J(),await z())},ve=async a=>{S.filter&&(S.filter.province_id=a,await J(),await z())},z=async()=>{l.district_id=g.data.props.district?g.data.props.district.id:void 0},fe=ue(async a=>{l.id=String(y.params.id),l.village=a.village,l.zip_code=a.zipcode,l.wide=a.wide,l.long=a.long,l.remark=a.remark,l.location=a.location,l.image=j.value,await b(),r.error?await L():(await U(),await V(),await O())}),ge=()=>{document.getElementById("fileInput").click()},we=async a=>{var d;const i=(d=a.target.files)==null?void 0:d[0];i&&(await q(i,"image"),C.value=URL.createObjectURL(i))},E=(a,s)=>{l.id=a,Y.value=s,Y.value==="update"?document.getElementById("updateGalleryInput").click():document.getElementById("addGalleryInput").click()},be=async a=>{await N(a),r.error?await L():(await U(),await V(),await O())},Ie=async a=>{var d;const i=(d=a.target.files)==null?void 0:d[0];i&&(await q(i,"gallery"),l.gallery=I.value,await le(),r.error?await L():(await U(),await V(),await O()))},Ve=async a=>{const i=a.target.files;i&&(await ke(i),l.gallery=I.value,await te(),r.error?await L():(await U(),await V(),await O()))},L=()=>{c.add({severity:"error",summary:"ເກີດຂໍ້ຜິດພາດ.",detail:`${r.error}`,life:3e3})},O=()=>{c.add({severity:"success",summary:"ສຳເລັດເເລ້ວ.",detail:"ການດຳເນີນສຳເລັດເເລ້ວ",life:3e3})},U=async()=>{C.value="",j.value="",I.value="";const a=document.getElementById("fileInput");a.value="";const s=document.getElementById("updateGalleryInput");s.value="";const i=document.getElementById("addGalleryInput");i.value=""},ke=async a=>{r.btnLoading=!0;try{let s=new FormData;for(let n=0;n<a.length;n++)s.append("files[]",a[n]);const d=(await H.post("http://159.223.42.254/api/upload/multiple/files",s,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTU5LjIyMy40Mi4yNTQvYXBpL2F1dGgvbG9naW4iLCJpYXQiOjE3MDc5MjgwMDksIm5iZiI6MTcwNzkyODAwOSwianRpIjoia25Ma3BqRHdObUh4a2dyUyIsInN1YiI6IjIiLCJwcnYiOiIyM2JkNWM4OTQ5ZjYwMGFkYjM5ZTcwMWM0MDA4NzJkYjdhNTk3NmY3In0.FDSN40oY148SrIvrc0oj51Ln8dgwlYj8KDCEjvUPZ1U"}})).data.filename.map(n=>({image:`${n}`}));I.value=d,r.btnLoading=!1}catch(s){console.error("Upload failed:",s)}},q=async(a,s)=>{var i,d;r.btnLoading=!0;try{let n=new FormData;n.append("file",a);const A=await H.post("http://159.223.42.254/api/upload_file",n,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTU5LjIyMy40Mi4yNTQvYXBpL2F1dGgvbG9naW4iLCJpYXQiOjE3MDc5MjgwMDksIm5iZiI6MTcwNzkyODAwOSwianRpIjoia25Ma3BqRHdObUh4a2dyUyIsInN1YiI6IjIiLCJwcnYiOiIyM2JkNWM4OTQ5ZjYwMGFkYjM5ZTcwMWM0MDA4NzJkYjdhNTk3NmY3In0.FDSN40oY148SrIvrc0oj51Ln8dgwlYj8KDCEjvUPZ1U"}});s==="image"?j.value=(i=A.data)==null?void 0:i.filename:I.value=(d=A.data)==null?void 0:d.filename,r.btnLoading=!1}catch(n){console.error("Upload failed:",n)}};return(a,s)=>(_(),m("div",Xe,[e("div",Ke,[e("span",el,[e("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:s[0]||(s[0]=i=>de())},[ll,h(" ຟອມລົງທະບຽນຂໍ້ມູນ ")])])]),tl,o(t(Q)),e("form",{onSubmit:s[8]||(s[8]=Ce(i=>t(fe)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[e("div",al,[e("div",il,[sl,o(t(w),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:t(l).real_estate_type_id,"onUpdate:modelValue":s[1]||(s[1]=i=>t(l).real_estate_type_id=i),options:t(ie).props,optionLabel:"name",placeholder:"ກະລຸນາເລືອກກ່ອນ...",class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options"])]),e("div",ol,[nl,o(t(w),{style:{"margin-top":"8px"},modelValue:t(l).service_model,"onUpdate:modelValue":s[2]||(s[2]=i=>t(l).service_model=i),options:me.value,optionLabel:"name",placeholder:"ກະລຸນາເລືອກ",optionValue:"id",highlightOnSelect:!0,class:"w-full"},null,8,["modelValue","options"])]),e("div",rl,[dl,o(t(w),{style:{"margin-top":"8px"},modelValue:t(l).room_type,"onUpdate:modelValue":s[3]||(s[3]=i=>t(l).room_type=i),options:_e.value,optionLabel:"name",placeholder:"ກະລຸນາເລືອກ",class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options"])]),e("div",cl,[pl,o(t(w),{style:{"margin-top":"8px"},modelValue:t(l).province_id,"onUpdate:modelValue":s[4]||(s[4]=i=>t(l).province_id=i),options:t(oe).data.props,optionLabel:"name",placeholder:"ກະລຸນາເລືອກກ່ອນ...",class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:s[5]||(s[5]=i=>ve(t(l).province_id))},null,8,["modelValue","options"])]),e("div",ul,[ml,o(t(w),{style:{"margin-top":"8px"},modelValue:t(l).district_id,"onUpdate:modelValue":s[6]||(s[6]=i=>t(l).district_id=i),options:t(re).data.props,optionLabel:"name",placeholder:"ກະລຸນາເລືອກ...",class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options"])]),e("div",_l,[o(x,{name:"village",label:"ບ້ານ",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:t(l).village},null,8,["value"])]),e("div",hl,[o(x,{name:"zipcode",label:"zipcode",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:t(l).zip_code},null,8,["value"])]),e("div",yl,[o(x,{name:"wide",label:"ລວງກວ້າງ",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:t(l).wide},null,8,["value"])]),e("div",vl,[o(x,{name:"long",label:"ລວງຍາວ",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:t(l).long},null,8,["value"])]),e("div",fl,[o(x,{name:"location",label:"ລີ້ງເເຜນທີ່",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:t(l).location},null,8,["value"])]),e("div",gl,[o(We,{name:"remark",label:"ລາຍລະອຽດ",required:"",placeholder:"ກະລຸນາປ້ອນກ່ອນ...",class:"h-full",value:t(l).remark},null,8,["value"])]),e("div",wl,[o(t(D),{header:"ຕັ້ງຄ່າລາຄາ ຊື້ຂາຍ - ເຊົ່າ"},{default:$(()=>[(_(!0),m(R,null,P(t(l).prices,(i,d)=>(_(),m("div",{class:"columns is-12",key:d},[e("div",bl,[Il,o(t(w),{modelValue:i.unit_price,"onUpdate:modelValue":n=>i.unit_price=n,options:he.value,optionLabel:"name",placeholder:"ກະລຸນາເລືອກກ່ອນ...",class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",Vl,[kl,o(t(Be),{modelValue:i.price,"onUpdate:modelValue":n=>i.price=n,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue"])]),e("div",xl,[Ml,Ue(e("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":n=>i.detail=n,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,Sl),[[$e,i.detail]])]),e("div",Cl,[d>0?(_(),m("a",{key:0,onClick:n=>pe(d),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},Ul,8,Ll)):G("",!0)])]))),128)),e("div",{class:"column is-mobile-12 is-12"},[e("a",{onClick:ce,class:"button is-primary"},"ເພີ່ມລາຍການ")])]),_:1})]),e("div",$l,[o(t(D),{header:"ເລືອກໂປຮໄຟລ ເເລະ ເເກເລີລີ່"},{default:$(()=>[e("div",Fl,[e("div",Gl,[e("div",Nl,[e("div",jl,[e("figure",Dl,[e("img",{src:C.value,alt:"Placeholder image"},null,8,Bl)])]),e("div",Jl,[e("span",Tl,[o(t(k),{icon:"pi pi-pencil",severity:"warning",rounded:"",onClick:ge,style:{color:"white"}}),e("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:we},null,32)])])])])])]),_:1})]),e("div",Yl,[o(t(D),{header:"ໂປຮໄຟລ ເເລະ ເເກເລີລີ່"},{default:$(()=>[e("div",zl,[(_(!0),m(R,null,P(T.value,(i,d)=>(_(),m("div",{class:"column is-mobile-12 is-3",key:d},[e("div",El,[e("div",ql,[e("figure",Al,[e("img",{src:i==null?void 0:i.image,alt:"Placeholder image"},null,8,Rl)])]),e("div",Pl,[e("span",Ql,[o(t(k),{icon:"pi pi-trash",severity:"danger",rounded:"",onClick:n=>be(i.id)},null,8,["onClick"]),Hl,o(t(k),{icon:"pi pi-pencil",severity:"warning",rounded:"",onClick:n=>E(i.id,"update"),style:{color:"white"}},null,8,["onClick"])]),e("input",{type:"file",id:"updateGalleryInput",style:{display:"none"},onChange:Ie},null,32),e("input",{type:"file",id:"addGalleryInput",multiple:"",style:{display:"none"},onChange:Ve},null,32)])])]))),128)),o(t(Q)),e("div",Zl,[o(t(k),{icon:"pi pi-plus-circle",onClick:s[7]||(s[7]=i=>E(t(y).params.id,"add"))})])])]),_:1})]),e("div",Wl,[o(t(k),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:t(r).btnLoading},{default:$(()=>[Xl,h(" ອັບເດດ ຂໍ້ມູນ ")]),_:1},8,["loading"])])])],32)]))}}),ut=Fe(Kl,[["__scopeId","data-v-9e44adfd"]]);export{ut as default};
