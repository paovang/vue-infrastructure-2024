import{d as D,C as X,N as Y,c as _,e as a,P as g,t as u,f as E,q as i,$ as Z,n as ee,b as l,o as f,u as Ce,L as Fe,a as Le,A as v,H as Ge,z as x,U as Te,p as Ue,h as Be,F as Q,g as W,w as xe,a3 as Ee,Q as k,_ as qe}from"./index-yek1mn7E.js";import{s as ze}from"./inputtext.esm-BklhKf_6.js";import{b as le,u as De}from"./index.esm-CsopAXbI.js";import{s as Oe,h as Ae,a as z}from"./panel.esm-oi0q4hTl.js";import{s as w}from"./dropdown.esm-IZ0E9-4b.js";import{s as Ne}from"./inputnumber.esm-Nn9l_j-n.js";import{s as J}from"./divider.esm-jV1XlXJM.js";import{r as Me}from"./real-estate-service.store-FqJFvlMl.js";import{h as Pe}from"./house.store-wdlVeett.js";import{p as Re}from"./province.store-vcBr8ttq.js";import{d as He}from"./district.store-7KEAXFoT.js";import{c as K}from"./axios.config--_JM1QNx.js";import"./index.esm-G7H3l8T2.js";import"./index.esm-KoJT9sUO.js";import"./index.esm-o8nBkmt6.js";const je={class:"flex flex-column gap-2 mb-3"},Qe=["for"],We={key:0,class:"text-red-500"},Je=["id"],I=D({__name:"FormEditInputText",props:{name:{},label:{},required:{type:Boolean},placeholder:{},value:{},isEditing:{type:Boolean}},setup(y){const d=y,{value:m,errorMessage:b}=le(d.name),n=X();Y(()=>d.value,C=>{m.value=C});const t=["country","province","district"],c=(n==null?void 0:n.name)!==null&&(n==null?void 0:n.name)!==void 0&&t.includes(n.name);return(C,F)=>(f(),_("div",je,[a(c)?E("",!0):(f(),_("label",{key:0,for:d.name},[g(u(d.label)+" ",1),d.required?(f(),_("span",We," *")):E("",!0)],8,Qe)),i(a(ze),{modelValue:a(m),"onUpdate:modelValue":F[0]||(F[0]=$=>Z(m)?m.value=$:null),id:d.name,class:ee({"p-invalid":a(b)}),type:"text","aria-describedby":`text-error-${d.name}`,placeholder:d.placeholder},null,8,["modelValue","id","class","aria-describedby","placeholder"]),l("small",{class:"p-error",id:`text-error-${d.name}`},u(a(b)),9,Je)]))}}),Ke={class:"flex flex-column gap-2 mb-3 w-full"},Xe=["for"],Ye={key:0,class:"text-red-500"},Ze=["id"],el=D({__name:"FormEditTextArea",props:{name:{},label:{},required:{type:Boolean},placeholder:{},value:{}},setup(y){const d=y,{value:m,errorMessage:b}=le(()=>d.name);return Y(()=>d.value,n=>{m.value=n}),(n,t)=>(f(),_("div",Ke,[l("label",{for:n.name},[g(u(n.label)+" ",1),n.required?(f(),_("span",Ye," *")):E("",!0)],8,Xe),i(a(Oe),{"auto-resize":"",rows:"5",modelValue:a(m),"onUpdate:modelValue":t[0]||(t[0]=c=>Z(m)?m.value=c:null),id:n.name,class:ee({"p-invalid":a(b)}),"aria-describedby":`text-error-${n.name}`,placeholder:n.placeholder},null,8,["modelValue","id","class","aria-describedby","placeholder"]),l("small",{class:"p-error",id:`text-error-${n.name}`},u(a(b)),9,Ze)]))}}),h=y=>(Ue("data-v-6da5f70b"),y=y(),Be(),y),ll={class:"card"},tl={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},al={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},sl=h(()=>l("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),ol=h(()=>l("br",null,null,-1)),il={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},nl={class:"column is-mobile-12 is-2"},rl=h(()=>l("span",{class:"text-red-500"}," *",-1)),dl={class:"column is-mobile-12 is-2"},cl=h(()=>l("span",{class:"text-red-500"}," *",-1)),pl={class:"column is-mobile-12 is-2"},ul=h(()=>l("span",{class:"text-red-500"}," *",-1)),ml={class:"column is-mobile-12 is-2"},hl=h(()=>l("span",{class:"text-red-500"}," *",-1)),gl={class:"column is-mobile-12 is-2"},_l=h(()=>l("span",{class:"text-red-500"}," *",-1)),fl={class:"column is-mobile-12 is-2"},yl={class:"column is-mobile-12 is-2"},vl={class:"column is-mobile-12 is-2"},bl={class:"column is-mobile-12 is-2"},wl={class:"column is-mobile-12 is-6"},$l={class:"column is-mobile-12 is-12"},Vl={class:"column is-12"},Sl={class:"column is-3"},kl=h(()=>l("span",{class:"text-red-500"}," *",-1)),Il={class:"column is-3"},Cl=h(()=>l("span",{class:"text-red-500"}," *",-1)),Fl={class:"column is-5"},Ll=["onUpdate:modelValue","placeholder"],Gl={class:"column is-1"},Tl=["onClick"],Ul=h(()=>l("i",{class:"pi pi-times-circle"},null,-1)),Bl=[Ul],xl={class:"column is-mobile-12 is-12"},El={class:"column is-12"},ql={class:"columns is-12 is-multiline"},zl={class:"column is-mobile-12 is-3"},Dl={class:"card",style:{padding:"0rem !important"}},Ol={class:"card-image"},Al={class:"image is-4by3"},Nl=["src"],Ml={class:"content",style:{display:"flex","justify-content":"center"}},Pl={style:{padding:"10px !important"}},Rl={class:"column is-12"},Hl={class:"columns is-12 is-multiline"},jl={class:"card",style:{padding:"0rem !important"}},Ql={class:"card-image"},Wl={class:"image is-4by3"},Jl=["src"],Kl={class:"content",style:{display:"flex","justify-content":"center"}},Xl={style:{padding:"10px !important"}},Yl=h(()=>l("span",{style:{"margin-left":"10px"}},null,-1)),Zl={class:"column is-mobile-12 is-12",style:{"text-align":"right"}},et={class:"column is-mobile-12 is-12 text-right"},lt=h(()=>l("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),tt=D({__name:"EditHouse",setup(y){const{t:d}=Ce(),m=Fe(),b=Le(),n=X(),{form:t,state:c,update:C,getOne:F,houseGetByOne:$,deleteGallery:te,updateGallery:ae,addGallery:se}=Pe(),{getOne:oe,realestateType:ie}=Me(),{getAll:ne,state:re,setStateFilter:de}=Re(),{getAll:O,state:ce,setStateFilter:L}=He(),G=v(),q=v(),A=v([{id:"",image:""}]),V=v(),N=v(),M=localStorage.getItem("token"),pe=async()=>{b.push({name:"owner.house"})},ue=async()=>{t.prices&&t.prices.push({price:"",unit_price:"",detail:""})},me=async e=>{t.prices&&t.prices.splice(e,1)},{handleSubmit:he}=De({validationSchema:Ae}),ge=v([{id:"sale",name:"ຂາຍ"},{id:"rent",name:"ເຊົ່າ"}]),_e=v([{id:"air",name:"ເເອ"},{id:"fan",name:"ພັດລົມ"},{id:"no",name:"ບໍ່ມີ"}]),fe=v([{id:"day",name:"ມື້"},{id:"month",name:"ເດືອນ"},{id:"year",name:"ປີ"}]);Ge(async()=>{await S()});const S=async()=>{const e=Number(n.params.id);c.btnLoading=!0,await F(e),await ye(),c.btnLoading=!1},ye=async()=>{const e=$.data.props;t.room_type=e.room_type,t.service_model=e.service_model,t.village=e.village,t.zip_code=e.zip_code,t.wide=e.wide,t.long=e.long,t.remark=e.remark,t.location=e.location,t.prices=e.price,t.prices=e.price,G.value=e.image,A.value=e.gallery,de.limit=1e3,await ne(),await oe(),t.real_estate_type_id=e.real_estate_type?e.real_estate_type.id:void 0,t.province_id=e.province?e.province.id:void 0,L.filter&&(L.filter.province_id=t.province_id,await O(),await P())},ve=async e=>{L.filter&&(L.filter.province_id=e,await O(),await P())},P=async()=>{t.district_id=$.data.props.district?$.data.props.district.id:void 0},be=he(async e=>{t.id=String(n.params.id),t.village=e.village,t.zip_code=e.zipcode,t.wide=e.wide,t.long=e.long,t.remark=e.remark,t.location=e.location,t.image=q.value,await C(),c.error?await T():(await B(),await S(),await U())}),we=()=>{document.getElementById("fileInput").click()},$e=async e=>{var p;const s=(p=e.target.files)==null?void 0:p[0];s&&(await H(s,"image"),G.value=URL.createObjectURL(s))},R=(e,o)=>{t.id=e,N.value=o,N.value==="update"?document.getElementById("updateGalleryInput").click():document.getElementById("addGalleryInput").click()},Ve=async e=>{await te(e),c.error?await T():(await B(),await S(),await U())},Se=async e=>{var p;const s=(p=e.target.files)==null?void 0:p[0];s&&(await H(s,"gallery"),t.gallery=V.value,await ae(),c.error?await T():(await B(),await S(),await U()))},ke=async e=>{const s=e.target.files;s&&(await Ie(s),t.gallery=V.value,await se(),c.error?await T():(await B(),await S(),await U()))},T=()=>{m.add({severity:"error",summary:d("toast.summary.error"),detail:`${c.error}`,life:3e3})},U=()=>{m.add({severity:"success",summary:d("toast.summary.success"),detail:d("toast.detail.successfully"),life:3e3})},B=async()=>{G.value="",q.value="",V.value="";const e=document.getElementById("fileInput");e.value="";const o=document.getElementById("updateGalleryInput");o.value="";const s=document.getElementById("addGalleryInput");s.value=""},Ie=async e=>{c.btnLoading=!0;try{let o=new FormData;for(let r=0;r<e.length;r++)o.append("files[]",e[r]);const p=(await K.post("http://127.0.0.1:8000/api/upload/multiple/files",o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${M}`}})).data.filename.map(r=>({image:`${r}`}));V.value=p,c.btnLoading=!1}catch(o){console.error("Upload failed:",o)}},H=async(e,o)=>{var s,p;c.btnLoading=!0;try{let r=new FormData;r.append("file",e);const j=await K.post("http://127.0.0.1:8000/api/upload_file",r,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${M}`}});o==="image"?q.value=(s=j.data)==null?void 0:s.filename:V.value=(p=j.data)==null?void 0:p.filename,c.btnLoading=!1}catch(r){console.error("Upload failed:",r)}};return(e,o)=>(f(),_("div",ll,[l("div",tl,[l("span",al,[l("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:o[0]||(o[0]=s=>pe())},[sl,g(" "+u(e.$t("messages.form_register")),1)])])]),ol,i(a(J)),l("form",{onSubmit:o[8]||(o[8]=Te(s=>a(be)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[l("div",il,[l("div",nl,[l("label",null,[g(u(e.$t("messages.realestate_type"))+" ",1),rl]),i(a(w),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:a(t).real_estate_type_id,"onUpdate:modelValue":o[1]||(o[1]=s=>a(t).real_estate_type_id=s),options:a(ie).props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",dl,[l("label",null,[g(u(e.$t("messages.service_model"))+" ",1),cl]),i(a(w),{style:{"margin-top":"8px"},modelValue:a(t).service_model,"onUpdate:modelValue":o[2]||(o[2]=s=>a(t).service_model=s),options:ge.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),optionValue:"id",highlightOnSelect:!0,class:"w-full"},null,8,["modelValue","options","placeholder"])]),l("div",pl,[l("label",null,[g(u(e.$t("messages.room_type"))+" ",1),ul]),i(a(w),{style:{"margin-top":"8px"},modelValue:a(t).room_type,"onUpdate:modelValue":o[3]||(o[3]=s=>a(t).room_type=s),options:_e.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",ml,[l("label",null,[g(u(e.$t("messages.province"))+" ",1),hl]),i(a(w),{style:{"margin-top":"8px"},modelValue:a(t).province_id,"onUpdate:modelValue":o[4]||(o[4]=s=>a(t).province_id=s),options:a(re).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:o[5]||(o[5]=s=>ve(a(t).province_id))},null,8,["modelValue","options","placeholder"])]),l("div",gl,[l("label",null,[g(u(e.$t("messages.district"))+" ",1),_l]),i(a(w),{style:{"margin-top":"8px"},modelValue:a(t).district_id,"onUpdate:modelValue":o[6]||(o[6]=s=>a(t).district_id=s),options:a(ce).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options","placeholder"])]),l("div",fl,[i(I,{name:"village",label:e.$t("messages.village"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).village},null,8,["label","placeholder","value"])]),l("div",yl,[i(I,{name:"zipcode",label:e.$t("messages.zip_code"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).zip_code},null,8,["label","placeholder","value"])]),l("div",vl,[i(I,{name:"wide",label:e.$t("messages.wide"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).wide},null,8,["label","placeholder","value"])]),l("div",bl,[i(I,{name:"long",label:e.$t("messages.long"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).long},null,8,["label","placeholder","value"])]),l("div",wl,[i(I,{name:"location",label:e.$t("messages.location"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).location},null,8,["label","placeholder","value"])]),l("div",$l,[i(el,{name:"remark",label:e.$t("messages.remark"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).remark},null,8,["label","placeholder","value"])]),l("div",Vl,[i(a(z),{header:e.$t("messages.setting_price_for_rent")},{default:x(()=>[(f(!0),_(Q,null,W(a(t).prices,(s,p)=>(f(),_("div",{class:"columns is-12",key:p},[l("div",Sl,[l("label",null,[g(u(e.$t("messages.service_model"))+" ",1),kl]),i(a(w),{modelValue:s.unit_price,"onUpdate:modelValue":r=>s.unit_price=r,options:fe.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),l("div",Il,[l("label",null,[g(u(e.$t("messages.price"))+" ",1),Cl]),i(a(Ne),{modelValue:s.price,"onUpdate:modelValue":r=>s.price=r,placeholder:e.$t("placeholder.inputText"),required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),l("div",Fl,[l("label",null,u(e.$t("messages.details")),1),xe(l("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":r=>s.detail=r,placeholder:e.$t("placeholder.inputText"),style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,Ll),[[Ee,s.detail]])]),l("div",Gl,[p>0?(f(),_("a",{key:0,onClick:r=>me(p),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},Bl,8,Tl)):E("",!0)])]))),128)),l("div",xl,[l("a",{onClick:ue,class:"button is-primary"},u(e.$t("button.add_item")),1)])]),_:1},8,["header"])]),l("div",El,[i(a(z),{header:e.$t("messages.profile")},{default:x(()=>[l("div",ql,[l("div",zl,[l("div",Dl,[l("div",Ol,[l("figure",Al,[l("img",{src:G.value,alt:"Placeholder image"},null,8,Nl)])]),l("div",Ml,[l("span",Pl,[i(a(k),{icon:"pi pi-pencil",severity:"warning",rounded:"",onClick:we,style:{color:"white"}}),l("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:$e},null,32)])])])])])]),_:1},8,["header"])]),l("div",Rl,[i(a(z),{header:e.$t("messages.profile_and_gallery")},{default:x(()=>[l("div",Hl,[(f(!0),_(Q,null,W(A.value,(s,p)=>(f(),_("div",{class:"column is-mobile-12 is-3",key:p},[l("div",jl,[l("div",Ql,[l("figure",Wl,[l("img",{src:s==null?void 0:s.image,alt:"Placeholder image"},null,8,Jl)])]),l("div",Kl,[l("span",Xl,[i(a(k),{icon:"pi pi-trash",severity:"danger",rounded:"",onClick:r=>Ve(s.id)},null,8,["onClick"]),Yl,i(a(k),{icon:"pi pi-pencil",severity:"warning",rounded:"",onClick:r=>R(s.id,"update"),style:{color:"white"}},null,8,["onClick"])]),l("input",{type:"file",id:"updateGalleryInput",style:{display:"none"},onChange:Se},null,32),l("input",{type:"file",id:"addGalleryInput",multiple:"",style:{display:"none"},onChange:ke},null,32)])])]))),128)),i(a(J)),l("div",Zl,[i(a(k),{icon:"pi pi-plus-circle",onClick:o[7]||(o[7]=s=>R(a(n).params.id,"add"))})])])]),_:1},8,["header"])]),l("div",et,[i(a(k),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:a(c).btnLoading},{default:x(()=>[lt,g(" "+u(e.$t("button.edit_data")),1)]),_:1},8,["loading"])])])],32)]))}}),yt=qe(tt,[["__scopeId","data-v-6da5f70b"]]);export{yt as default};
