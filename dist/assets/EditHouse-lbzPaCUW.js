import{d as B,C as Z,M as W,c as g,e as a,O as h,t as p,f as G,q as o,Y as X,n as K,b as l,o as y,K as ke,a as Se,A as f,G as Me,z as F,Q as Ce,p as Le,h as Oe,F as R,g as P,w as Te,a2 as Ue,P as k,_ as Fe}from"./index-YYtgFme3.js";import{s as Ge}from"./inputtext.esm-gcF-MEFb.js";import{b as ee,u as Ne}from"./index.esm-OxTSjBgV.js";import{s as je,h as De,a as D}from"./panel.esm-HWLDz_ne.js";import{s as b}from"./dropdown.esm-SRD51U9I.js";import{s as Be}from"./inputnumber.esm-MPm90Esl.js";import{s as Q}from"./divider.esm-iedPcHC-.js";import{r as Je}from"./real-estate-service.store-WQ9jzG22.js";import{h as Ye}from"./house.store-bSaETxkl.js";import{p as ze}from"./province.store-s1nTWhzi.js";import{d as Ee}from"./district.store-UTKpOVcx.js";import{c as H}from"./axios.config-EpIlfGdK.js";import"./index.esm-yogEuK8u.js";import"./index.esm-MPGM0ma0.js";import"./index.esm-tt5XFFtY.js";const xe={class:"flex flex-column gap-2 mb-3"},Ae=["for"],qe={key:0,class:"text-red-500"},Re=["id"],S=B({__name:"FormEditInputText",props:{name:{},label:{},required:{type:Boolean},placeholder:{},value:{},isEditing:{type:Boolean}},setup(v){const c=v,{value:m,errorMessage:_}=ee(c.name),t=Z();W(()=>c.value,M=>{m.value=M});const r=["country","province","district"],$=(t==null?void 0:t.name)!==null&&(t==null?void 0:t.name)!==void 0&&r.includes(t.name);return(M,w)=>(y(),g("div",xe,[a($)?G("",!0):(y(),g("label",{key:0,for:c.name},[h(p(c.label)+" ",1),c.required?(y(),g("span",qe," *")):G("",!0)],8,Ae)),o(a(Ge),{modelValue:a(m),"onUpdate:modelValue":w[0]||(w[0]=N=>X(m)?m.value=N:null),id:c.name,class:K({"p-invalid":a(_)}),type:"text","aria-describedby":`text-error-${c.name}`,placeholder:c.placeholder},null,8,["modelValue","id","class","aria-describedby","placeholder"]),l("small",{class:"p-error",id:`text-error-${c.name}`},p(a(_)),9,Re)]))}}),Pe={class:"flex flex-column gap-2 mb-3 w-full"},Qe=["for"],He={key:0,class:"text-red-500"},Ze=["id"],We=B({__name:"FormEditTextArea",props:{name:{},label:{},required:{type:Boolean},placeholder:{},value:{}},setup(v){const c=v,{value:m,errorMessage:_}=ee(()=>c.name);return W(()=>c.value,t=>{m.value=t}),(t,r)=>(y(),g("div",Pe,[l("label",{for:t.name},[h(p(t.label)+" ",1),t.required?(y(),g("span",He," *")):G("",!0)],8,Qe),o(a(je),{"auto-resize":"",rows:"5",modelValue:a(m),"onUpdate:modelValue":r[0]||(r[0]=$=>X(m)?m.value=$:null),id:t.name,class:K({"p-invalid":a(_)}),"aria-describedby":`text-error-${t.name}`,placeholder:t.placeholder},null,8,["modelValue","id","class","aria-describedby","placeholder"]),l("small",{class:"p-error",id:`text-error-${t.name}`},p(a(_)),9,Ze)]))}}),u=v=>(Le("data-v-7bf7b594"),v=v(),Oe(),v),Xe={class:"card"},Ke={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},el={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},ll=u(()=>l("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),tl=u(()=>l("br",null,null,-1)),al={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},sl={class:"column is-mobile-12 is-2"},il=u(()=>l("span",{class:"text-red-500"}," *",-1)),ol={class:"column is-mobile-12 is-2"},nl=u(()=>l("span",{class:"text-red-500"}," *",-1)),rl={class:"column is-mobile-12 is-2"},dl=u(()=>l("span",{class:"text-red-500"}," *",-1)),cl={class:"column is-mobile-12 is-2"},pl=u(()=>l("span",{class:"text-red-500"}," *",-1)),ul={class:"column is-mobile-12 is-2"},ml=u(()=>l("span",{class:"text-red-500"}," *",-1)),hl={class:"column is-mobile-12 is-2"},gl={class:"column is-mobile-12 is-2"},yl={class:"column is-mobile-12 is-2"},_l={class:"column is-mobile-12 is-2"},vl={class:"column is-mobile-12 is-6"},fl={class:"column is-mobile-12 is-12"},wl={class:"column is-12"},bl={class:"column is-3"},$l=u(()=>l("span",{class:"text-red-500"}," *",-1)),Il={class:"column is-3"},Vl=u(()=>l("span",{class:"text-red-500"}," *",-1)),kl={class:"column is-5"},Sl=["onUpdate:modelValue","placeholder"],Ml={class:"column is-1"},Cl=["onClick"],Ll=u(()=>l("i",{class:"pi pi-times-circle"},null,-1)),Ol=[Ll],Tl={class:"column is-mobile-12 is-12"},Ul={class:"column is-12"},Fl={class:"columns is-12 is-multiline"},Gl={class:"column is-mobile-12 is-3"},Nl={class:"card",style:{padding:"0rem !important"}},jl={class:"card-image"},Dl={class:"image is-4by3"},Bl=["src"],Jl={class:"content",style:{display:"flex","justify-content":"center"}},Yl={style:{padding:"10px !important"}},zl={class:"column is-12"},El={class:"columns is-12 is-multiline"},xl={class:"card",style:{padding:"0rem !important"}},Al={class:"card-image"},ql={class:"image is-4by3"},Rl=["src"],Pl={class:"content",style:{display:"flex","justify-content":"center"}},Ql={style:{padding:"10px !important"}},Hl=u(()=>l("span",{style:{"margin-left":"10px"}},null,-1)),Zl={class:"column is-mobile-12 is-12",style:{"text-align":"right"}},Wl={class:"column is-mobile-12 is-12 text-right"},Xl=u(()=>l("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),Kl=B({__name:"EditHouse",setup(v){const c=ke(),m=Se(),_=Z(),{form:t,state:r,update:$,getOne:M,houseGetByOne:w,deleteGallery:N,updateGallery:le,addGallery:te}=Ye(),{getOne:ae,realestateType:se}=Je(),{getAll:ie,state:oe,setStateFilter:ne}=ze(),{getAll:J,state:re,setStateFilter:C}=Ee(),L=f(),j=f(),Y=f([{id:"",image:""}]),I=f(),z=f(),de=async()=>{m.push({name:"owner.house"})},ce=async()=>{t.prices&&t.prices.push({price:"",unit_price:"",detail:""})},pe=async e=>{t.prices&&t.prices.splice(e,1)},{handleSubmit:ue}=Ne({validationSchema:De}),me=f([{id:"sale",name:"ຂາຍ"},{id:"rent",name:"ເຊົ່າ"}]),he=f([{id:"air",name:"ເເອ"},{id:"fan",name:"ພັດລົມ"},{id:"no",name:"ບໍ່ມີ"}]),ge=f([{id:"day",name:"ມື້"},{id:"month",name:"ເດືອນ"},{id:"year",name:"ປີ"}]);Me(async()=>{await V()});const V=async()=>{const e=Number(_.params.id);r.btnLoading=!0,await M(e),await ye(),r.btnLoading=!1},ye=async()=>{const e=w.data.props;t.room_type=e.room_type,t.service_model=e.service_model,t.village=e.village,t.zip_code=e.zip_code,t.wide=e.wide,t.long=e.long,t.remark=e.remark,t.location=e.location,t.prices=e.price,t.prices=e.price,L.value=e.image,Y.value=e.gallery,ne.limit=1e3,await ie(),await ae(),t.real_estate_type_id=e.real_estate_type?e.real_estate_type.id:void 0,t.province_id=e.province?e.province.id:void 0,C.filter&&(C.filter.province_id=t.province_id,await J(),await E())},_e=async e=>{C.filter&&(C.filter.province_id=e,await J(),await E())},E=async()=>{t.district_id=w.data.props.district?w.data.props.district.id:void 0},ve=ue(async e=>{t.id=String(_.params.id),t.village=e.village,t.zip_code=e.zipcode,t.wide=e.wide,t.long=e.long,t.remark=e.remark,t.location=e.location,t.image=j.value,await $(),r.error?await O():(await U(),await V(),await T())}),fe=()=>{document.getElementById("fileInput").click()},we=async e=>{var d;const s=(d=e.target.files)==null?void 0:d[0];s&&(await A(s,"image"),L.value=URL.createObjectURL(s))},x=(e,i)=>{t.id=e,z.value=i,z.value==="update"?document.getElementById("updateGalleryInput").click():document.getElementById("addGalleryInput").click()},be=async e=>{await N(e),r.error?await O():(await U(),await V(),await T())},$e=async e=>{var d;const s=(d=e.target.files)==null?void 0:d[0];s&&(await A(s,"gallery"),t.gallery=I.value,await le(),r.error?await O():(await U(),await V(),await T()))},Ie=async e=>{const s=e.target.files;s&&(await Ve(s),t.gallery=I.value,await te(),r.error?await O():(await U(),await V(),await T()))},O=()=>{c.add({severity:"error",summary:"ເກີດຂໍ້ຜິດພາດ.",detail:`${r.error}`,life:3e3})},T=()=>{c.add({severity:"success",summary:"ສຳເລັດເເລ້ວ.",detail:"ການດຳເນີນສຳເລັດເເລ້ວ",life:3e3})},U=async()=>{L.value="",j.value="",I.value="";const e=document.getElementById("fileInput");e.value="";const i=document.getElementById("updateGalleryInput");i.value="";const s=document.getElementById("addGalleryInput");s.value=""},Ve=async e=>{r.btnLoading=!0;try{let i=new FormData;for(let n=0;n<e.length;n++)i.append("files[]",e[n]);const d=(await H.post("http://159.223.42.254/api/upload/multiple/files",i,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTU5LjIyMy40Mi4yNTQvYXBpL2F1dGgvbG9naW4iLCJpYXQiOjE3MDc5MjgwMDksIm5iZiI6MTcwNzkyODAwOSwianRpIjoia25Ma3BqRHdObUh4a2dyUyIsInN1YiI6IjIiLCJwcnYiOiIyM2JkNWM4OTQ5ZjYwMGFkYjM5ZTcwMWM0MDA4NzJkYjdhNTk3NmY3In0.FDSN40oY148SrIvrc0oj51Ln8dgwlYj8KDCEjvUPZ1U"}})).data.filename.map(n=>({image:`${n}`}));I.value=d,r.btnLoading=!1}catch(i){console.error("Upload failed:",i)}},A=async(e,i)=>{var s,d;r.btnLoading=!0;try{let n=new FormData;n.append("file",e);const q=await H.post("http://159.223.42.254/api/upload_file",n,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTU5LjIyMy40Mi4yNTQvYXBpL2F1dGgvbG9naW4iLCJpYXQiOjE3MDc5MjgwMDksIm5iZiI6MTcwNzkyODAwOSwianRpIjoia25Ma3BqRHdObUh4a2dyUyIsInN1YiI6IjIiLCJwcnYiOiIyM2JkNWM4OTQ5ZjYwMGFkYjM5ZTcwMWM0MDA4NzJkYjdhNTk3NmY3In0.FDSN40oY148SrIvrc0oj51Ln8dgwlYj8KDCEjvUPZ1U"}});i==="image"?j.value=(s=q.data)==null?void 0:s.filename:I.value=(d=q.data)==null?void 0:d.filename,r.btnLoading=!1}catch(n){console.error("Upload failed:",n)}};return(e,i)=>(y(),g("div",Xe,[l("div",Ke,[l("span",el,[l("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:i[0]||(i[0]=s=>de())},[ll,h(" "+p(e.$t("messages.form_register")),1)])])]),tl,o(a(Q)),l("form",{onSubmit:i[8]||(i[8]=Ce(s=>a(ve)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[l("div",al,[l("div",sl,[l("label",null,[h(p(e.$t("messages.realestate_type"))+" ",1),il]),o(a(b),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:a(t).real_estate_type_id,"onUpdate:modelValue":i[1]||(i[1]=s=>a(t).real_estate_type_id=s),options:a(se).props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",ol,[l("label",null,[h(p(e.$t("messages.service_model"))+" ",1),nl]),o(a(b),{style:{"margin-top":"8px"},modelValue:a(t).service_model,"onUpdate:modelValue":i[2]||(i[2]=s=>a(t).service_model=s),options:me.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),optionValue:"id",highlightOnSelect:!0,class:"w-full"},null,8,["modelValue","options","placeholder"])]),l("div",rl,[l("label",null,[h(p(e.$t("messages.room_type"))+" ",1),dl]),o(a(b),{style:{"margin-top":"8px"},modelValue:a(t).room_type,"onUpdate:modelValue":i[3]||(i[3]=s=>a(t).room_type=s),options:he.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",cl,[l("label",null,[h(p(e.$t("messages.province"))+" ",1),pl]),o(a(b),{style:{"margin-top":"8px"},modelValue:a(t).province_id,"onUpdate:modelValue":i[4]||(i[4]=s=>a(t).province_id=s),options:a(oe).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:i[5]||(i[5]=s=>_e(a(t).province_id))},null,8,["modelValue","options","placeholder"])]),l("div",ul,[l("label",null,[h(p(e.$t("messages.district"))+" ",1),ml]),o(a(b),{style:{"margin-top":"8px"},modelValue:a(t).district_id,"onUpdate:modelValue":i[6]||(i[6]=s=>a(t).district_id=s),options:a(re).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options","placeholder"])]),l("div",hl,[o(S,{name:"village",label:e.$t("messages.village"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).village},null,8,["label","placeholder","value"])]),l("div",gl,[o(S,{name:"zipcode",label:e.$t("messages.zip_code"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).zip_code},null,8,["label","placeholder","value"])]),l("div",yl,[o(S,{name:"wide",label:e.$t("messages.wide"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).wide},null,8,["label","placeholder","value"])]),l("div",_l,[o(S,{name:"long",label:e.$t("messages.long"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).long},null,8,["label","placeholder","value"])]),l("div",vl,[o(S,{name:"location",label:e.$t("messages.location"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).location},null,8,["label","placeholder","value"])]),l("div",fl,[o(We,{name:"remark",label:e.$t("messages.remark"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",value:a(t).remark},null,8,["label","placeholder","value"])]),l("div",wl,[o(a(D),{header:e.$t("messages.setting_price_for_rent")},{default:F(()=>[(y(!0),g(R,null,P(a(t).prices,(s,d)=>(y(),g("div",{class:"columns is-12",key:d},[l("div",bl,[l("label",null,[h(p(e.$t("messages.service_model"))+" ",1),$l]),o(a(b),{modelValue:s.unit_price,"onUpdate:modelValue":n=>s.unit_price=n,options:ge.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),l("div",Il,[l("label",null,[h(p(e.$t("messages.price"))+" ",1),Vl]),o(a(Be),{modelValue:s.price,"onUpdate:modelValue":n=>s.price=n,placeholder:e.$t("placeholder.inputText"),required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),l("div",kl,[l("label",null,p(e.$t("messages.details")),1),Te(l("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":n=>s.detail=n,placeholder:e.$t("placeholder.inputText"),style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,Sl),[[Ue,s.detail]])]),l("div",Ml,[d>0?(y(),g("a",{key:0,onClick:n=>pe(d),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},Ol,8,Cl)):G("",!0)])]))),128)),l("div",Tl,[l("a",{onClick:ce,class:"button is-primary"},p(e.$t("button.add_item")),1)])]),_:1},8,["header"])]),l("div",Ul,[o(a(D),{header:e.$t("messages.profile")},{default:F(()=>[l("div",Fl,[l("div",Gl,[l("div",Nl,[l("div",jl,[l("figure",Dl,[l("img",{src:L.value,alt:"Placeholder image"},null,8,Bl)])]),l("div",Jl,[l("span",Yl,[o(a(k),{icon:"pi pi-pencil",severity:"warning",rounded:"",onClick:fe,style:{color:"white"}}),l("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:we},null,32)])])])])])]),_:1},8,["header"])]),l("div",zl,[o(a(D),{header:e.$t("messages.profile_and_gallery")},{default:F(()=>[l("div",El,[(y(!0),g(R,null,P(Y.value,(s,d)=>(y(),g("div",{class:"column is-mobile-12 is-3",key:d},[l("div",xl,[l("div",Al,[l("figure",ql,[l("img",{src:s==null?void 0:s.image,alt:"Placeholder image"},null,8,Rl)])]),l("div",Pl,[l("span",Ql,[o(a(k),{icon:"pi pi-trash",severity:"danger",rounded:"",onClick:n=>be(s.id)},null,8,["onClick"]),Hl,o(a(k),{icon:"pi pi-pencil",severity:"warning",rounded:"",onClick:n=>x(s.id,"update"),style:{color:"white"}},null,8,["onClick"])]),l("input",{type:"file",id:"updateGalleryInput",style:{display:"none"},onChange:$e},null,32),l("input",{type:"file",id:"addGalleryInput",multiple:"",style:{display:"none"},onChange:Ie},null,32)])])]))),128)),o(a(Q)),l("div",Zl,[o(a(k),{icon:"pi pi-plus-circle",onClick:i[7]||(i[7]=s=>x(a(_).params.id,"add"))})])])]),_:1},8,["header"])]),l("div",Wl,[o(a(k),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:a(r).btnLoading},{default:F(()=>[Xl,h(" "+p(e.$t("button.edit_data")),1)]),_:1},8,["loading"])])])],32)]))}}),gt=Fe(Kl,[["__scopeId","data-v-7bf7b594"]]);export{gt as default};
