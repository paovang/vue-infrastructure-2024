import{d as Te,u as Ce,M as Ue,N as ze,a as De,r as u,o as Ee,e as p,f as l,Q as v,t as c,y as n,g as o,E,V as Be,p as Me,k as Ae,j as h,F as H,i as W,w as Ne,a3 as qe,h as B,U as J,J as Q,b as Oe,_ as Re}from"./index-lHHUaHrB.js";import{_ as w}from"./FormInputText.vue_vue_type_script_setup_true_lang-1RZ3WOlU.js";import{_ as Ge}from"./FormTextArea.vue_vue_type_script_setup_true_lang--59uXYVu.js";import{s as L}from"./dropdown.esm-JPa_IcjP.js";import{s as K}from"./inputnumber.esm-IRPXUiZQ.js";import{u as je}from"./vee-validate.esm-AoIqEz5p.js";import{h as Pe,s as X}from"./panel.esm-qxOAwIch.js";import{c as Y}from"./axios.config-gXfSTYZr.js";import{s as Z}from"./divider.esm-JnR7MM4A.js";import{r as xe}from"./real-estate-service.store-sixJQanJ.js";import{h as He}from"./house.store-xMeoTQI7.js";import{p as We}from"./province.store-RylszeyK.js";import{d as Je}from"./district.store-3ybyljRH.js";import{a as Qe,s as ee,i as Ke}from"./toast-FY7odgkM.js";import{v as Xe}from"./validation-permissions-3Nt-MlCt.js";import"./inputtext.esm-AWs-KwBd.js";import"./textarea.esm-65UX8DVH.js";import"./overlayeventbus.esm-01Kc7sQv.js";import"./index.esm-z9dUg8cd.js";import"./index.esm-fXjYgF1E.js";import"./index.esm-cGoAmfMp.js";const g=T=>(Me("data-v-ae869a95"),T=T(),Ae(),T),Ye={class:"card"},Ze={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},el={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},ll=g(()=>l("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),al=g(()=>l("br",null,null,-1)),sl={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},tl={class:"column is-mobile-12 is-2"},ol=g(()=>l("span",{class:"text-red-500"}," *",-1)),il={class:"column is-mobile-12 is-2"},nl=g(()=>l("span",{class:"text-red-500"}," *",-1)),rl={class:"column is-mobile-12 is-2"},dl=g(()=>l("span",{class:"text-red-500"}," *",-1)),cl={class:"column is-mobile-12 is-2"},ml={class:"column is-mobile-12 is-2"},ul=g(()=>l("span",{class:"text-red-500"}," *",-1)),pl={class:"column is-mobile-12 is-2"},hl=g(()=>l("span",{class:"text-red-500"}," *",-1)),gl={class:"column is-mobile-12 is-2 set-margin-top"},vl={class:"column is-mobile-12 is-2 set-margin-top"},_l={class:"column is-mobile-12 is-2 set-margin-top"},fl={class:"column is-mobile-12 is-2 set-margin-top"},yl={class:"column is-mobile-12 is-2 set-margin-top"},bl={class:"column is-mobile-12 is-2 set-margin-top"},wl={class:"column is-mobile-12 is-2 set-margin-top"},$l={class:"column is-mobile-12 is-10 set-margin-top"},Sl={class:"column is-mobile-12 is-12 set-margin-top"},Vl={class:"column is-12"},Fl={class:"column is-3"},kl=g(()=>l("span",{class:"text-red-500"}," *",-1)),Ll={class:"column is-3"},Il=g(()=>l("span",{class:"text-red-500"}," *",-1)),Tl={key:0,class:"column is-5"},Cl=["onUpdate:modelValue"],Ul={key:1,class:"column is-5"},zl={class:"column is-1"},Dl=["onClick"],El=g(()=>l("i",{class:"pi pi-times-circle"},null,-1)),Bl=[El],Ml={class:"column is-mobile-12 is-12"},Al={class:"column is-12"},Nl={class:"column is-mobile-12 is-12"},ql=g(()=>l("span",{class:"text-red-500"}," *",-1)),Ol={key:0},Rl={key:1,style:{color:"#029217"}},Gl={class:"column is-mobile-12 is-12"},jl=g(()=>l("span",{class:"text-red-500"}," *",-1)),Pl={key:0},xl={key:1,style:{color:"#029217"}},Hl={key:0,class:"column is-mobile-12 is-12"},Wl={class:"column is-mobile-12 is-12 text-right"},Jl=g(()=>l("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),Ql=Te({__name:"AddHouse",setup(T){const{t:s}=Ce(),y=Ue(),le=ze(),ae=De(),{form:i,state:$,register:se}=He(),{getOne:te,realestateType:M}=xe(),{getAll:oe,state:A,setStateFilter:ie}=We(),{getAll:O,state:N,setStateFilter:C}=Je(),b=u(null),_=u(),R=u(2e3),G=u(1900),ne=async()=>{ae.push({name:"owner.house"})},re=()=>{document.getElementById("fileInput").click()},de=async e=>{var d;const t=e.target,a=(d=t.files)==null?void 0:d[0];if(a){if(!await Qe(a)){await ee({toast:y,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.real_estate_profile_valid_file_mimes")}),t.value="",b.value="",S.value="";return}if(!await Ke(a)){await ee({toast:y,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.real_estate_profile_valid_file_size")}),t.value="",b.value="",S.value="";return}const r=new Image;r.src=URL.createObjectURL(a),r.onload=async()=>{const f=r.width,V=r.height;f>R.value||V>G.value?(b.value="",S.value="",t.value="",await Fe(s("messages.dimensions"))):(b.value=s("uploadFile.uploading"),await Se(a),b.value=s("uploadFile.upload_success"))}}},ce=()=>{document.getElementById("galleryInput").click(),F.value=[]},F=u([]),me=async e=>{const t=e.target,a=t.files,d=1*1024*1024,r=5*1024*1024;if(a){let f=0;for(let V=0;V<a.length;V++){const D=a[V];f+=D.size;try{await ue(D,d)}catch(Ie){F.value.push(Ie)}}if(f>r){F.value.push(s("toast.summary.maximum_allowed_size_5MB")),_.value="",_.value="",t.value="";return}F.value.length<=0?(_.value=s("uploadFile.uploading")+a.length,await Ve(a),_.value=s("uploadFile.upload_success")+"("+a.length+" "+s("uploadFile.file")+")"):(_.value="",_.value="",t.value="")}},ue=(e,t)=>new Promise((a,d)=>{if(e.size>t)d(`${e.name} => `+s("toast.summary.real_estate_profile_valid_file_size_1MB"));else if(!["image/jpeg","image/jpg"].includes(e.type))d(`${e.name} => `+s("toast.summary.real_estate_profile_valid_file_mimes"));else{const f=new Image;f.src=URL.createObjectURL(e),f.onload=()=>{const V=f.width,D=f.height;V>R.value||D>G.value?d(`${e.name} => `+s("messages.dimensions")):a("")},f.onerror=()=>{d(`Error loading image ${e.name}.`)}}}),m=u([{price:"",unit_price:"",detail:"",est_m:""}]),pe=async()=>{var e;m.value&&(((e=m.value)==null?void 0:e.length)>2?y.add({severity:"error",summary:s("toast.summary.must_be_length_three"),detail:s("toast.detail.cancel_delete"),life:3e3}):m.value.push({price:"",unit_price:"",detail:""}))},he=async e=>{m.value&&m.value.splice(e,1)},I=u(!1),ge=async e=>{e==="rent"?(I.value=!0,k.value=U.value.slice(1,4),m&&m.value&&(m.value[0].unit_price=k.value[0].id,m.value[0].est_m=0)):(I.value=!1,k.value=U.value.slice(0,1),m&&m.value&&(m.value[0].unit_price=k.value[0].id))},{handleSubmit:ve}=je({validationSchema:Pe}),_e=u([{id:"sale",name:s("messages.service_sale")},{id:"rent",name:s("messages.service_rent")}]),fe=u([{id:"air",name:s("messages.air")},{id:"fan",name:s("messages.fan")},{id:"no",name:s("messages.none")}]),U=u([{id:"sale",name:s("messages.service_sale")},{id:"day",name:s("messages.service_daily")},{id:"month",name:s("messages.service_monthly")},{id:"year",name:s("messages.service_yearly")}]),k=u(),j=localStorage.getItem("token"),z=u(),S=u();Ee(async()=>{await ye(),m&&m.value&&(m.value[0].unit_price=U.value[0].id),k.value=U.value.slice(0,1)});const ye=async()=>{i.room_type="air",i.service_model="sale",ie.limit=1e3,await oe(),await te(),i.real_estate_type_id=M.props.length>0?M.props[0].id:void 0,i.province_id=A.data.props.length>0?A.data.props[0].id:void 0,C.filter&&(C.filter.province_id=i.province_id,await O(),await P())},be=async e=>{C.filter&&(C.filter.province_id=e,await O(),await P())},P=async()=>{i.district_id=N.data.props.length>0?N.data.props[0].id:void 0},we=ve(async e=>{i.district_id?S.value?z.value?(i.village=e.village,i.zip_code=e.zipcode,i.wide=e.wide,i.long=e.long,i.total_bath=e.bath,i.total_bed=e.bed,i.garage=e.garage,i.name=e.name,i.remark=e.remark,i.location=e.location,i.prices=m.value,i.image=S.value,i.gallery=z.value,await se(),$.error?await ke():await Le()):await q(s("placeholder.dropdownSelect")+" "+s("messages.gallery")):await q(s("placeholder.dropdownSelect")+" "+s("messages.image")):await q(s("placeholder.dropdownSelect")+" "+s("messages.district"))}),$e=async()=>{b.value="",_.value="",S.value="",z.value="";const e=document.getElementById("fileInput");e.value="";const t=document.getElementById("galleryInput");t.value=""},Se=async e=>{var t;$.btnLoading=!0;try{let a=new FormData;a.append("file",e);const d=await Y.post("http://188.166.183.153:8000/api/upload_file",a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${j}`}});S.value=(t=d.data)==null?void 0:t.filename,$.btnLoading=!1}catch(a){await x(a)}},Ve=async e=>{$.btnLoading=!0;try{let t=new FormData;for(let r=0;r<e.length;r++)t.append("files[]",e[r]);const d=(await Y.post("http://188.166.183.153:8000/api/upload/multiple/files",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${j}`}})).data.filename.map(r=>({image:`${r}`}));z.value=d,$.btnLoading=!1}catch(t){await x(t)}},x=e=>{y.add({severity:"error",summary:s("toast.summary.error"),detail:e,life:3e3})},Fe=e=>{y.add({severity:"error",summary:s("toast.summary.error"),detail:e,life:3e3})},q=e=>{y.add({severity:"error",summary:s("toast.summary.error"),detail:e,life:3e3})},ke=()=>{y.add({severity:"error",summary:s("toast.summary.error"),detail:`${$.error}`,life:3e3})},Le=async()=>{le.require({message:s("confirmDuplicate.message"),header:s("confirmDuplicate.header"),rejectLabel:s("confirmDuplicate.rejectLabel"),acceptLabel:s("confirmDuplicate.acceptLabel"),rejectClass:"p-button-danger",acceptClass:"p-button-info",accept:async()=>{await $e(),y.add({severity:"success",summary:s("toast.summary.duplicate"),detail:s("toast.detail.success_duplicate"),life:3e3})},reject:async()=>{window.location.reload(),y.add({severity:"error",summary:s("toast.summary.not_duplicate"),detail:s("toast.detail.cancel_duplicate"),life:3e3})}})};return(e,t)=>(h(),p("div",Ye,[l("div",Ze,[l("span",el,[l("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:t[0]||(t[0]=a=>ne())},[ll,v(" "+c(e.$t("messages.form_register")),1)])])]),al,n(o(Z)),l("form",{onSubmit:t[8]||(t[8]=Be(a=>o(we)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[l("div",sl,[l("div",tl,[l("label",null,[v(c(e.$t("messages.realestate_type"))+" ",1),ol]),n(o(L),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:o(i).real_estate_type_id,"onUpdate:modelValue":t[1]||(t[1]=a=>o(i).real_estate_type_id=a),options:o(M).props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",il,[l("label",null,[v(c(e.$t("messages.service_model"))+" ",1),nl]),n(o(L),{style:{"margin-top":"8px"},modelValue:o(i).service_model,"onUpdate:modelValue":t[2]||(t[2]=a=>o(i).service_model=a),options:_e.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),optionValue:"id",highlightOnSelect:!0,class:"w-full",onChange:t[3]||(t[3]=a=>ge(o(i).service_model))},null,8,["modelValue","options","placeholder"])]),l("div",rl,[l("label",null,[v(c(e.$t("messages.room_type"))+" ",1),dl]),n(o(L),{style:{"margin-top":"8px"},modelValue:o(i).room_type,"onUpdate:modelValue":t[4]||(t[4]=a=>o(i).room_type=a),options:fe.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",cl,[n(w,{name:"name",label:e.$t("messages.real_estate_name"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",ml,[l("label",null,[v(c(e.$t("messages.province"))+" ",1),ul]),n(o(L),{style:{"margin-top":"8px"},modelValue:o(i).province_id,"onUpdate:modelValue":t[5]||(t[5]=a=>o(i).province_id=a),options:o(A).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:t[6]||(t[6]=a=>be(o(i).province_id))},null,8,["modelValue","options","placeholder"])]),l("div",pl,[l("label",null,[v(c(e.$t("messages.district"))+" ",1),hl]),n(o(L),{style:{"margin-top":"8px"},modelValue:o(i).district_id,"onUpdate:modelValue":t[7]||(t[7]=a=>o(i).district_id=a),options:o(N).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options","placeholder"])]),l("div",gl,[n(w,{name:"village",label:e.$t("messages.village"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",vl,[n(w,{name:"zipcode",label:e.$t("messages.zip_code"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",_l,[n(w,{name:"bed",label:e.$t("messages.total_bed"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",fl,[n(w,{name:"bath",label:e.$t("messages.total_bath"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",yl,[n(w,{name:"wide",label:e.$t("messages.wide"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",bl,[n(w,{name:"long",label:e.$t("messages.long"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",wl,[n(w,{name:"garage",label:e.$t("messages.garage"),required:"",placeholder:e.$t("placeholder.inputTextGarage"),class:"h-full"},null,8,["label","placeholder"])]),l("div",$l,[n(w,{name:"location",label:e.$t("messages.location"),required:"",placeholder:e.$t("placeholder.inputTextLocation"),class:"h-full"},null,8,["label","placeholder"])]),l("div",Sl,[n(Ge,{name:"remark",label:e.$t("messages.details"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",Vl,[n(o(X),{header:e.$t("messages.setting_price_for_rent")},{default:E(()=>[(h(!0),p(H,null,W(m.value,(a,d)=>(h(),p("div",{class:"columns is-12",key:d},[l("div",Fl,[l("label",null,[v(c(e.$t("messages.service_model"))+" ",1),kl]),n(o(L),{modelValue:a.unit_price,"onUpdate:modelValue":r=>a.unit_price=r,options:k.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),l("div",Ll,[l("label",null,[v(c(e.$t("messages.price"))+" ",1),Il]),n(o(K),{modelValue:a.price,"onUpdate:modelValue":r=>a.price=r,placeholder:e.$t("placeholder.inputNumber"),required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),I.value?(h(),p("div",Tl,[l("label",null,c(e.$t("messages.details")),1),Ne(l("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":r=>a.detail=r,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,Cl),[[qe,a.detail]])])):B("",!0),I.value?B("",!0):(h(),p("div",Ul,[l("label",null,c(e.$t("messages.est_m")),1),n(o(K),{modelValue:a.est_m,"onUpdate:modelValue":r=>a.est_m=r,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue"])])),l("div",zl,[d>0?(h(),p("a",{key:0,onClick:r=>he(d),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},Bl,8,Dl)):B("",!0)])]))),128)),l("div",Ml,[n(o(J),{onClick:pe,class:"button is-primary",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},disabled:!I.value},{default:E(()=>[v(c(e.$t("button.add_item")),1)]),_:1},8,["disabled"])])]),_:1},8,["header"])]),l("div",Al,[n(o(X),{header:e.$t("messages.profile_and_gallery")},{default:E(()=>[l("div",Nl,[l("label",null,[v(c(e.$t("messages.profile"))+" ",1),ql]),l("label",{class:"upload-box",onClick:re,style:Q({border:b.value?"1px dashed #029217":"1px dashed red"})},[b.value?(h(),p("div",Rl,c(b.value),1)):(h(),p("div",Ol,c(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:de},null,32)]),n(o(Z)),l("div",Gl,[l("label",null,[v(c(e.$t("messages.gallery"))+" ",1),jl]),l("label",{class:"upload-box",onClick:ce,style:Q({border:_.value?"1px dashed #029217":"1px dashed red"})},[_.value?(h(),p("div",xl,c(_.value),1)):(h(),p("div",Pl,c(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"galleryInput",multiple:"",style:{display:"none"},onChange:me},null,32)]),F.value.length>0?(h(),p("div",Hl,[(h(!0),p(H,null,W(F.value,(a,d)=>(h(),p("p",{style:{color:"red"},key:d},c(d+1)+". "+c(a),1))),128))])):B("",!0)]),_:1},8,["header"])]),l("div",Wl,[n(o(J),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:o($).btnLoading,disabled:o(Xe)(o(Oe).REAL_ESTATE.CREATE)},{default:E(()=>[Jl,v(" "+c(e.$t("button.save_data")),1)]),_:1},8,["loading","disabled"])])])],32)]))}}),_a=Re(Ql,[["__scopeId","data-v-ae869a95"]]);export{_a as default};
