import{d as Ce,u as Ue,K as Ee,L as ze,a as De,r as u,o as Be,e as p,f as l,O as v,t as c,y as n,g as o,E as D,Q as Me,p as Ae,k as Ne,j as h,F as H,i as W,w as Oe,a3 as qe,h as B,P as J,J as K,b as Re,_ as xe}from"./index-LdcnITiF.js";import{_ as w}from"./FormInputText.vue_vue_type_script_setup_true_lang-ALDzYzIN.js";import{_ as Ge}from"./FormTextArea.vue_vue_type_script_setup_true_lang-LBWg284A.js";import{s as T}from"./dropdown.esm-oIwyeOio.js";import{s as Q}from"./inputnumber.esm-Dul35HHC.js";import{u as Pe}from"./vee-validate.esm-TkVb9r70.js";import{h as je,s as X}from"./panel.esm-F4JQ1Cu3.js";import{a as Y}from"./axios.config-jCy-uYyV.js";import{s as Z}from"./divider.esm-fsbycYed.js";import{r as He}from"./real-estate-service.store-gw5M_ZVy.js";import{h as We}from"./house.store-4V6w_eJQ.js";import{p as Je}from"./province.store-1myXvhxs.js";import{d as Ke}from"./district.store-SNtGphvz.js";import{a as Qe,s as ee,i as Xe}from"./toast-FY7odgkM.js";import{v as Ye}from"./validation-permissions-Lk98cRZM.js";import"./inputtext.esm-629idsIU.js";import"./textarea.esm-z09XvRq1.js";import"./overlayeventbus.esm-V-1ctxGJ.js";import"./index.esm-Rt67Lz-c.js";import"./index.esm-IlFBAx8L.js";import"./index.esm-skEhRz7Y.js";const g=I=>(Ae("data-v-303e56d0"),I=I(),Ne(),I),Ze={class:"card"},el={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},ll={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},al=g(()=>l("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),sl=g(()=>l("br",null,null,-1)),tl={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},ol={class:"column is-mobile-12 is-2"},il=g(()=>l("span",{class:"text-red-500"}," *",-1)),nl={class:"column is-mobile-12 is-2"},rl=g(()=>l("span",{class:"text-red-500"}," *",-1)),dl={class:"column is-mobile-12 is-2"},cl=g(()=>l("span",{class:"text-red-500"}," *",-1)),ml={class:"column is-mobile-12 is-2"},ul={class:"column is-mobile-12 is-2"},pl=g(()=>l("span",{class:"text-red-500"}," *",-1)),hl={class:"column is-mobile-12 is-2"},gl=g(()=>l("span",{class:"text-red-500"}," *",-1)),vl={class:"column is-mobile-12 is-2 set-margin-top"},_l={class:"column is-mobile-12 is-2 set-margin-top"},fl={class:"column is-mobile-12 is-2 set-margin-top"},yl={class:"column is-mobile-12 is-2 set-margin-top"},bl={class:"column is-mobile-12 is-2 set-margin-top"},wl={class:"column is-mobile-12 is-2 set-margin-top"},$l={class:"column is-mobile-12 is-2 set-margin-top"},Sl={class:"column is-mobile-12 is-10 set-margin-top"},Vl={class:"column is-mobile-12 is-12 set-margin-top"},Fl={class:"column is-12"},kl={class:"column is-3"},Tl=g(()=>l("span",{class:"text-red-500"}," *",-1)),Ll={class:"column is-3"},Il=g(()=>l("span",{class:"text-red-500"}," *",-1)),Cl={key:0,class:"column is-5"},Ul=["onUpdate:modelValue"],El={key:1,class:"column is-5"},zl={class:"column is-1"},Dl=["onClick"],Bl=g(()=>l("i",{class:"pi pi-times-circle"},null,-1)),Ml=[Bl],Al={class:"column is-mobile-12 is-12"},Nl={class:"column is-12"},Ol={class:"column is-mobile-12 is-12"},ql=g(()=>l("span",{class:"text-red-500"}," *",-1)),Rl={key:0},xl={key:1,style:{color:"#029217"}},Gl={class:"column is-mobile-12 is-12"},Pl=g(()=>l("span",{class:"text-red-500"}," *",-1)),jl={key:0},Hl={key:1,style:{color:"#029217"}},Wl={key:0,class:"column is-mobile-12 is-12"},Jl={class:"column is-mobile-12 is-12 text-right"},Kl=g(()=>l("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),Ql=Ce({__name:"AddHouse",setup(I){const{t:a}=Ue(),y=Ee(),le=ze(),ae=De(),{form:i,state:$,register:se}=We(),{getOne:te,realestateType:M}=He(),{getAll:oe,state:A,setStateFilter:ie}=Je(),{getAll:q,state:N,setStateFilter:C}=Ke(),b=u(null),_=u(),R=u(2e3),x=u(1900),ne=async()=>{ae.push({name:"owner.house"})},re=()=>{document.getElementById("fileInput").click()},de=async e=>{var d;const t=e.target,s=(d=t.files)==null?void 0:d[0];if(s){if(!await Qe(s)){await ee({toast:y,error:"error",summary:a("toast.summary.error"),detail:a("toast.summary.real_estate_profile_valid_file_mimes")}),t.value="",b.value="",S.value="";return}if(!await Xe(s)){await ee({toast:y,error:"error",summary:a("toast.summary.error"),detail:a("toast.summary.real_estate_profile_valid_file_size")}),t.value="",b.value="",S.value="";return}const r=new Image;r.src=URL.createObjectURL(s),r.onload=async()=>{const f=r.width,V=r.height;f>R.value||V>x.value?(b.value="",S.value="",t.value="",await ke(a("messages.dimensions"))):(b.value=a("uploadFile.uploading"),await Ve(s),b.value=a("uploadFile.upload_success"))}}},ce=()=>{document.getElementById("galleryInput").click(),F.value=[]},F=u([]),me=async e=>{const t=e.target,s=t.files,d=1*1024*1024,r=5*1024*1024;if(s){let f=0;for(let V=0;V<s.length;V++){const z=s[V];f+=z.size;try{await ue(z,d)}catch(Ie){F.value.push(Ie)}}if(f>r){F.value.push(a("toast.summary.maximum_allowed_size_5MB")),_.value="",_.value="",t.value="";return}F.value.length<=0?(_.value=a("uploadFile.uploading")+s.length,await Fe(s),_.value=a("uploadFile.upload_success")+"("+s.length+" "+a("uploadFile.file")+")"):(_.value="",_.value="",t.value="")}},ue=(e,t)=>new Promise((s,d)=>{if(e.size>t)d(`${e.name} => `+a("toast.summary.real_estate_profile_valid_file_size_1MB"));else if(!["image/jpeg","image/jpg"].includes(e.type))d(`${e.name} => `+a("toast.summary.real_estate_profile_valid_file_mimes"));else{const f=new Image;f.src=URL.createObjectURL(e),f.onload=()=>{const V=f.width,z=f.height;V>R.value||z>x.value?d(`${e.name} => `+a("messages.dimensions")):s("")},f.onerror=()=>{d(`Error loading image ${e.name}.`)}}}),m=u([{price:"",unit_price:"",detail:"",est_m:""}]),pe=async()=>{var e;m.value&&(((e=m.value)==null?void 0:e.length)>2?y.add({severity:"error",summary:a("toast.summary.must_be_length_three"),detail:a("toast.detail.cancel_delete"),life:3e3}):m.value.push({price:"",unit_price:"",detail:""}))},he=async e=>{m.value&&m.value.splice(e,1)},L=u(!1),ge=async e=>{e==="rent"?(L.value=!0,k.value=U.value.slice(1,4),m&&m.value&&(m.value[0].unit_price=k.value[0].id,m.value[0].est_m=0)):(L.value=!1,k.value=U.value.slice(0,1),m&&m.value&&(m.value[0].unit_price=k.value[0].id))},ve={village:a("placeholder.inputText"),location:a("placeholder.inputText"),name:a("placeholder.inputText"),wide:a("placeholder.inputText")},{handleSubmit:_e}=Pe({validationSchema:je(ve)}),fe=u([{id:"sale",name:a("messages.service_sale")},{id:"rent",name:a("messages.service_rent")}]),ye=u([{id:"air",name:a("messages.air")},{id:"fan",name:a("messages.fan")},{id:"no",name:a("messages.none")}]),U=u([{id:"sale",name:a("messages.service_sale")},{id:"day",name:a("messages.service_daily")},{id:"month",name:a("messages.service_monthly")},{id:"year",name:a("messages.service_yearly")}]),k=u(),G=localStorage.getItem("token"),E=u(),S=u();Be(async()=>{await be(),m&&m.value&&(m.value[0].unit_price=U.value[0].id),k.value=U.value.slice(0,1)});const be=async()=>{i.room_type="air",i.service_model="sale",ie.limit=1e3,await oe(),await te(),i.real_estate_type_id=M.props.length>0?M.props[0].id:void 0,i.province_id=A.data.props.length>0?A.data.props[0].id:void 0,C.filter&&(C.filter.province_id=i.province_id,await q(),await P())},we=async e=>{C.filter&&(C.filter.province_id=e,await q(),await P())},P=async()=>{i.district_id=N.data.props.length>0?N.data.props[0].id:void 0},$e=_e(async e=>{i.district_id?S.value?E.value?(i.village=e.village,i.zip_code=e.zipcode,i.wide=e.wide,i.long=e.long,i.total_bath=e.bath,i.total_bed=e.bed,i.garage=e.garage,i.name=e.name,i.remark=e.remark,i.location=e.location,i.prices=m.value,i.image=S.value,i.gallery=E.value,await se(),$.error?await Te():await Le()):await O(a("placeholder.dropdownSelect")+" "+a("messages.gallery")):await O(a("placeholder.dropdownSelect")+" "+a("messages.image")):await O(a("placeholder.dropdownSelect")+" "+a("messages.district"))}),Se=async()=>{b.value="",_.value="",S.value="",E.value="";const e=document.getElementById("fileInput");e.value="";const t=document.getElementById("galleryInput");t.value=""},Ve=async e=>{var t;$.btnLoading=!0;try{let s=new FormData;s.append("file",e);const d=await Y.post("http://188.166.183.153:8000/api/upload_file",s,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${G}`}});S.value=(t=d.data)==null?void 0:t.filename,$.btnLoading=!1}catch(s){await j(s)}},Fe=async e=>{$.btnLoading=!0;try{let t=new FormData;for(let r=0;r<e.length;r++)t.append("files[]",e[r]);const d=(await Y.post("http://188.166.183.153:8000/api/upload/multiple/files",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${G}`}})).data.filename.map(r=>({image:`${r}`}));E.value=d,$.btnLoading=!1}catch(t){await j(t)}},j=e=>{y.add({severity:"error",summary:a("toast.summary.error"),detail:e,life:3e3})},ke=e=>{y.add({severity:"error",summary:a("toast.summary.error"),detail:e,life:3e3})},O=e=>{y.add({severity:"error",summary:a("toast.summary.error"),detail:e,life:3e3})},Te=()=>{y.add({severity:"error",summary:a("toast.summary.error"),detail:`${$.error}`,life:3e3})},Le=async()=>{le.require({message:a("confirmDuplicate.message"),header:a("confirmDuplicate.header"),rejectLabel:a("confirmDuplicate.rejectLabel"),acceptLabel:a("confirmDuplicate.acceptLabel"),rejectClass:"p-button-danger",acceptClass:"p-button-info",accept:async()=>{await Se(),y.add({severity:"success",summary:a("toast.summary.duplicate"),detail:a("toast.detail.success_duplicate"),life:3e3})},reject:async()=>{window.location.reload(),y.add({severity:"error",summary:a("toast.summary.not_duplicate"),detail:a("toast.detail.cancel_duplicate"),life:3e3})}})};return(e,t)=>(h(),p("div",Ze,[l("div",el,[l("span",ll,[l("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:t[0]||(t[0]=s=>ne())},[al,v(" "+c(e.$t("messages.form_register")),1)])])]),sl,n(o(Z)),l("form",{onSubmit:t[8]||(t[8]=Me(s=>o($e)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[l("div",tl,[l("div",ol,[l("label",null,[v(c(e.$t("messages.realestate_type"))+" ",1),il]),n(o(T),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:o(i).real_estate_type_id,"onUpdate:modelValue":t[1]||(t[1]=s=>o(i).real_estate_type_id=s),options:o(M).props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",nl,[l("label",null,[v(c(e.$t("messages.service_model"))+" ",1),rl]),n(o(T),{style:{"margin-top":"8px"},modelValue:o(i).service_model,"onUpdate:modelValue":t[2]||(t[2]=s=>o(i).service_model=s),options:fe.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),optionValue:"id",highlightOnSelect:!0,class:"w-full",onChange:t[3]||(t[3]=s=>ge(o(i).service_model))},null,8,["modelValue","options","placeholder"])]),l("div",dl,[l("label",null,[v(c(e.$t("messages.room_type"))+" ",1),cl]),n(o(T),{style:{"margin-top":"8px"},modelValue:o(i).room_type,"onUpdate:modelValue":t[4]||(t[4]=s=>o(i).room_type=s),options:ye.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",ml,[n(w,{name:"name",label:e.$t("messages.real_estate_name"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",ul,[l("label",null,[v(c(e.$t("messages.province"))+" ",1),pl]),n(o(T),{style:{"margin-top":"8px"},modelValue:o(i).province_id,"onUpdate:modelValue":t[5]||(t[5]=s=>o(i).province_id=s),options:o(A).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:t[6]||(t[6]=s=>we(o(i).province_id))},null,8,["modelValue","options","placeholder"])]),l("div",hl,[l("label",null,[v(c(e.$t("messages.district"))+" ",1),gl]),n(o(T),{style:{"margin-top":"8px"},modelValue:o(i).district_id,"onUpdate:modelValue":t[7]||(t[7]=s=>o(i).district_id=s),options:o(N).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options","placeholder"])]),l("div",vl,[n(w,{name:"village",label:e.$t("messages.village"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",_l,[n(w,{name:"zipcode",label:e.$t("messages.zip_code"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",fl,[n(w,{name:"bed",label:e.$t("messages.total_bed"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",yl,[n(w,{name:"bath",label:e.$t("messages.total_bath"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",bl,[n(w,{name:"wide",label:e.$t("messages.wide"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",wl,[n(w,{name:"long",label:e.$t("messages.long"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",$l,[n(w,{name:"garage",label:e.$t("messages.garage"),required:"",placeholder:e.$t("placeholder.inputTextGarage"),class:"h-full"},null,8,["label","placeholder"])]),l("div",Sl,[n(w,{name:"location",label:e.$t("messages.location"),required:"",placeholder:e.$t("placeholder.inputTextLocation"),class:"h-full"},null,8,["label","placeholder"])]),l("div",Vl,[n(Ge,{name:"remark",label:e.$t("messages.details"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",Fl,[n(o(X),{header:e.$t("messages.setting_price_for_rent")},{default:D(()=>[(h(!0),p(H,null,W(m.value,(s,d)=>(h(),p("div",{class:"columns is-12",key:d},[l("div",kl,[l("label",null,[v(c(e.$t("messages.service_model"))+" ",1),Tl]),n(o(T),{modelValue:s.unit_price,"onUpdate:modelValue":r=>s.unit_price=r,options:k.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),l("div",Ll,[l("label",null,[v(c(e.$t("messages.price"))+" ",1),Il]),n(o(Q),{modelValue:s.price,"onUpdate:modelValue":r=>s.price=r,placeholder:e.$t("placeholder.inputNumber"),required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),L.value?(h(),p("div",Cl,[l("label",null,c(e.$t("messages.details")),1),Oe(l("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":r=>s.detail=r,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,Ul),[[qe,s.detail]])])):B("",!0),L.value?B("",!0):(h(),p("div",El,[l("label",null,c(e.$t("messages.est_m")),1),n(o(Q),{modelValue:s.est_m,"onUpdate:modelValue":r=>s.est_m=r,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue"])])),l("div",zl,[d>0?(h(),p("a",{key:0,onClick:r=>he(d),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},Ml,8,Dl)):B("",!0)])]))),128)),l("div",Al,[n(o(J),{onClick:pe,class:"button is-primary",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},disabled:!L.value},{default:D(()=>[v(c(e.$t("button.add_item")),1)]),_:1},8,["disabled"])])]),_:1},8,["header"])]),l("div",Nl,[n(o(X),{header:e.$t("messages.profile_and_gallery")},{default:D(()=>[l("div",Ol,[l("label",null,[v(c(e.$t("messages.profile"))+" ",1),ql]),l("label",{class:"upload-box",onClick:re,style:K({border:b.value?"1px dashed #029217":"1px dashed red"})},[b.value?(h(),p("div",xl,c(b.value),1)):(h(),p("div",Rl,c(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:de},null,32)]),n(o(Z)),l("div",Gl,[l("label",null,[v(c(e.$t("messages.gallery"))+" ",1),Pl]),l("label",{class:"upload-box",onClick:ce,style:K({border:_.value?"1px dashed #029217":"1px dashed red"})},[_.value?(h(),p("div",Hl,c(_.value),1)):(h(),p("div",jl,c(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"galleryInput",multiple:"",style:{display:"none"},onChange:me},null,32)]),F.value.length>0?(h(),p("div",Wl,[(h(!0),p(H,null,W(F.value,(s,d)=>(h(),p("p",{style:{color:"red"},key:d},c(d+1)+". "+c(s),1))),128))])):B("",!0)]),_:1},8,["header"])]),l("div",Jl,[n(o(J),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:o($).btnLoading,disabled:o(Ye)(o(Re).REAL_ESTATE.CREATE)},{default:D(()=>[Kl,v(" "+c(e.$t("button.save_data")),1)]),_:1},8,["loading","disabled"])])])],32)]))}}),fa=xe(Ql,[["__scopeId","data-v-303e56d0"]]);export{fa as default};
