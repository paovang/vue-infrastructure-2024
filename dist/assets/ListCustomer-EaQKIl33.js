import{d as De,u as je,K as Oe,L as ze,r as y,a as Be,H as Ae,M as Ke,N as I,o as Me,e as ae,y as s,E as h,T as He,f as i,t as b,g as a,j as te,O as F,P as _,n as Ge,Q as Qe,h as We,b as R,U as le,p as Ye,k as Je,_ as Xe}from"./index-aMgELBJ-.js";import{s as u,a as Ze}from"./column.esm-S8UrWKfI.js";import{s as se}from"./inputtext.esm-di_aazzo.js";import{c as ea,_ as aa}from"./Change-User-Password.Component.vue_vue_type_script_setup_true_lang-k1r0Nm7i.js";import{c as ta}from"./country.store-YjmqVfHj.js";import{s as ie}from"./dropdown.esm-YEbONByr.js";import{s as la}from"./fieldset.esm-2NseS1EP.js";import{_ as k}from"./FormInputText.vue_vue_type_script_setup_true_lang-JVz6intB.js";import{u as sa}from"./vee-validate.esm-WZUAy-nj.js";import{c as ia,a as v}from"./index.esm-xITqWIWR.js";import{_ as oe}from"./FormInputPassword.vue_vue_type_script_setup_true_lang-AFtoS74W.js";import{_ as re,u as ne}from"./upload-file-G037xkO1.js";import{a as de}from"./axios.config-vTwtgIHJ.js";import{s as ce}from"./image.esm-tiZeRayn.js";import{v as me,s as U,i as ue}from"./toast-FY7odgkM.js";import{v as x}from"./validation-permissions-VWIyVsaS.js";import"./paginator.esm-wGkjL54G.js";import"./inputnumber.esm-S-nhYIdZ.js";import"./overlayeventbus.esm-KdN2ogOU.js";import"./index.esm-0T1azjBh.js";import"./checkbox.esm-N4I5mddD.js";import"./index.esm-vd1-HgH0.js";import"./index.esm-SKRKswmN.js";import"./index.esm-Mi3e6iwC.js";const oa=(m,t=!1)=>{let d=ia({name:v().required(m.name),address:v().required(m.address),tel:v().required(m.tel),email:v().required(m.email),id_no:v().required(m.id_no)});return t&&(d=d.shape({password:v().required(m.password),password_confirmation:v().required(m.password_confirmation),id_image:v().required(m.id_image)})),d},pe=oa,P=m=>(Ye("data-v-799d9a9c"),m=m(),Je(),m),ra={key:0,class:"card"},na={class:"flex align-items-center pl-2"},da=P(()=>i("i",{class:"pi pi-users",style:{"font-size":"20px"}},null,-1)),ca={class:"font-bold"},ma={class:"col-12 md:col-12 flex flex-row"},ua={class:"col-12 md:col-3"},pa=P(()=>i("span",{class:"text-red-500"}," *",-1)),fa={class:"col-12 md:col-3"},ha={class:"col-12 md:col-6"},ga={class:"col-12 md:col-12 flex flex-row is-margin-top"},ya={class:"col-12 md:col-3"},wa={class:"col-12 md:col-3"},ba={class:"col-12 md:col-3"},_a={class:"col-12 md:col-3"},va={class:"col-12 md:col-12 flex flex-row is-margin-top"},$a={class:"col-12 md:col-4"},Sa={class:"col-12 md:col-4"},Ca={class:"col-12 md:col-4"},Ta={class:"custom-button-container"},La=P(()=>i("i",{class:"pi pi-sync",style:{"margin-right":"8px"}},null,-1)),ka={class:"card"},Pa={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},Va={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},qa={class:"mb-3"},Ea={class:"w-full sm:w-auto flex-order-0 sm:flex-order-1 mb-4 sm:mb-0"},Ia={class:"col-12 md:col-12 flex flex-row"},Fa={class:"col-12 md:col-3"},Ra={class:"p-input-icon-left w-full flex-order-1 sm:flex-order-0"},Ua={class:"col-12 md:col-3"},xa={class:"p-input-icon-left w-full flex-order-1 sm:flex-order-0"},Na=P(()=>i("i",{class:"pi pi-search",style:{"margin-top":"-10px"}},null,-1)),Da={class:"col-12 md:col-4"},ja={class:"p-input-icon-left w-full flex-order-1 sm:flex-order-0"},Oa=P(()=>i("i",{class:"pi pi-search",style:{"margin-top":"-10px"}},null,-1)),za={class:"col-12 md:col-2"},Ba={class:"p-input-icon-left w-full flex-order-1 sm:flex-order-0"},Aa={class:"flex flex-wrap gap-2 btn-right"},Ka=De({__name:"ListCustomer",setup(m){const{t}=je(),d=Oe(),B=ze(),p=y(!1),N=y(),g=y(!1),S=y(!0),{push:V}=Be(),{query:$}=Ae(),{register:fe,update:he,remove:ge,getAll:q,form:n,state:c,setStateFilter:o,updateStatus:ye,changeUserPassword:we}=ea(),{getAll:be,state:w,setStateFilter:_e}=ta(),A={name:t("placeholder.inputText"),address:t("placeholder.inputText"),tel:t("placeholder.inputText"),email:t("placeholder.inputText"),password:t("placeholder.inputText"),password_confirmation:t("placeholder.inputText"),id_no:t("placeholder.inputText"),id_image:t("placeholder.inputText")},K=y(),M=y(),ve=async e=>{M.value=e,K.value.visible=!0},$e=async()=>{await O(),await T(),w.data.props.unshift({id:"all",name:t("messages.all")})},H=y(pe(A,S.value)),Se=()=>{H.value=pe(A,S.value)};Ke(S,()=>{Se()});const{handleSubmit:G,handleReset:D,setFieldValue:C}=sa({validationSchema:H}),Ce=G(async e=>{if(n.id=e.id,n.name=e.name,n.address=e.address,n.tel=e.tel,n.email=e.email,n.id_no=e.id_no,n.id_image=L.value,n.profile=E.value,await he(),c.error)await W();else{await Q(),await D(),await j(),g.value=!1,p.value=!1,S.value=!0,L.value="";const l=document.getElementById("id_image");l.value="",E.value="";const r=document.getElementById("profile");r.value=""}}),Te=G(async e=>{if(n.name=e.name,n.address=e.address,n.email=e.email,n.tel=e.tel,n.password=e.password,n.password_confirmation=e.password_confirmation,n.id_no=e.id_no,n.id_image=L.value,n.profile=E.value,await fe(),c.error)await W();else{await Q(),await D(),await j(),L.value="";const l=document.getElementById("id_image");l.value="",g.value=!1}}),j=async()=>{_e.limit=200,await be(),n.country_id=w.data.props.length>0?w.data.props[0].id:void 0},Le=async()=>{p.value=!1,S.value=!0,g.value?g.value=!1:g.value=!0},ke=async()=>{c.btnLoading=!1,await D(),p.value=!1,g.value=!1},Pe=async()=>{c.btnLoading=!0,p.value=!1,o.filter&&(o.filter.name="",o.filter.country_id="",o.filter.tel=""),await O(),await T(),c.btnLoading=!1},Ve=async e=>{await ge(e),await T()},qe=async e=>{await ye(e),await T()},Ee=async e=>{var l;C("id",e.id),C("name",e.name),C("address",e.address),C("email",e.email),C("tel",e.tel),C("id_no",e.id_no),n.country_id=(l=e.country)==null?void 0:l.id,e.user&&(n.user_id=e.user.id),p.value=!0,g.value=!0,S.value=!1,await ee(),await ee()};async function Ie(e){o.page=e.page+1,o.limit=e.rows;const{page:l,limit:r,filter:f}=o;V({name:"customer",query:{page:l,limit:r,search:f!=null&&f.name?f.name:void 0}}),await q()}const Fe=I(()=>{let e=0;return o.page&&o.limit&&(e=(o.page-1)*o.limit),e}),Re=async e=>{B.require({message:t("confirmDelete.message"),header:t("confirmDelete.header"),rejectLabel:t("confirmDelete.rejectLabel"),acceptLabel:t("confirmDelete.acceptLabel"),rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-danger",accept:async()=>{await Ve(e),d.add({severity:"success",summary:t("toast.summary.delete"),detail:t("toast.detail.delete"),life:3e3})},reject:()=>{d.add({severity:"error",summary:t("toast.summary.cancel_delete"),detail:t("toast.detail.cancel_delete"),life:3e3})}})},Ue=async e=>{B.require({message:t("confirmUpdateStatus.message"),header:t("confirmUpdateStatus.header"),rejectLabel:t("confirmUpdateStatus.rejectLabel"),acceptLabel:t("confirmUpdateStatus.acceptLabel"),rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-danger",accept:async()=>{await qe(e),d.add({severity:"success",summary:t("toast.summary.success"),detail:t("toast.detail.successfully"),life:3e3})},reject:()=>{d.add({severity:"error",summary:t("toast.summary.cancel_update"),detail:t("toast.detail.cancel_update"),life:3e3})}})},Q=()=>{d.add({severity:"success",summary:t("toast.summary.success"),detail:t("toast.detail.successfully"),life:3e3})},W=()=>{d.add({severity:"error",summary:t("toast.summary.error"),detail:`${c.error}`,life:3e3})};async function O(){var e,l;Object.keys($).length!==0&&(o.page=$.page?Number($.page):1,o.limit=$.limit?Number($.limit):10,((e=o.filter)==null?void 0:e.name)===""?(o.filter.name=$.search?$.search:"",V({query:{page:o.page,limit:o.limit,search:void 0}})):V({query:{page:o.page,limit:o.limit,search:(l=o.filter)==null?void 0:l.name}})),await q()}Me(async()=>{await O(),await T(),w.data.props.unshift({id:"all",name:t("messages.all")}),n.country_id=w.data.props.length>0?w.data.props[0].id:void 0});const T=async()=>{await j()},Y=I({get:()=>o.filter.name,set:e=>{o.filter?o.filter.name=e:o.filter={name:e}}}),J=I({get:()=>o.filter.country_id||"",set:e=>{o.filter&&(o.filter.country_id=e)}}),X=I({get:()=>{var e;return((e=o.filter)==null?void 0:e.tel)||""},set:e=>{o.filter&&(o.filter.tel=e)}});async function z(){await q()}async function Z(e){var l;e.target.value===""&&(((l=o.filter)==null?void 0:l.name)!==void 0&&(o.filter.name=""),V({query:{name:void 0}}),await q())}const ee=async()=>{var e;if(N.value){const l=N.value.$el,r=l.getBoundingClientRect();r.top>=0&&r.bottom<=window.innerHeight?(e=l.querySelector("input"))==null||e.focus():(window.scrollTo({top:window.scrollY+r.top-window.innerHeight/2,behavior:"smooth"}),setTimeout(()=>{var f;(f=l.querySelector("input"))==null||f.focus()},500))}},L=y(),xe=async e=>{const l=e.target.files[0];if(!await me(l)){await U({toast:d,error:"error",summary:t("toast.summary.error"),detail:t("toast.summary.profile_valid_file_mimes")}),e.target.value="";return}if(!await ue(l)){await U({toast:d,error:"error",summary:t("toast.summary.error"),detail:t("toast.summary.profile_valid_file_size")}),e.target.value="";return}await ne({axios:de,file:l,state:c,selectedImage:L,toast:d,t})},E=y(),Ne=async e=>{const l=e.target.files[0];if(!await me(l)){await U({toast:d,error:"error",summary:t("toast.summary.error"),detail:t("toast.summary.profile_valid_file_mimes")}),e.target.value="";return}if(!await ue(l)){await U({toast:d,error:"error",summary:t("toast.summary.error"),detail:t("toast.summary.profile_valid_file_size")}),e.target.value="";return}await ne({axios:de,file:l,state:c,selectedImage:E,toast:d,t})};return(e,l)=>(te(),ae("div",null,[s(He,{name:"fade",mode:"out-in"},{default:h(()=>[g.value?(te(),ae("div",ra,[s(a(la),null,{legend:h(()=>[i("div",na,[da,i("span",ca,b(e.$t("messages.form_register_customer")),1)])]),default:h(()=>[i("form",{onSubmit:l[2]||(l[2]=Qe(r=>p.value?a(Ce)():a(Te)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[i("div",ma,[i("div",ua,[i("label",null,[F(b(e.$t("messages.select"))+" "+b(e.$t("messages.country"))+" ",1),pa]),s(a(ie),{style:{"margin-top":"8px"},modelValue:a(n).country_id,"onUpdate:modelValue":l[0]||(l[0]=r=>a(n).country_id=r),options:a(w).data.props,optionLabel:"name",optionValue:"id",highlightOnSelect:!0,placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full md:w-14rem"},null,8,["modelValue","options","placeholder"])]),i("div",fa,[s(k,{ref_key:"autoFocusCursor",ref:N,name:"name",label:e.$t("messages.full_name"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),i("div",ha,[s(k,{name:"address",label:e.$t("messages.address"),required:"",placeholder:e.$t("placeholder.inputTextAddress"),class:"h-full"},null,8,["label","placeholder"])])]),i("div",ga,[i("div",ya,[s(k,{name:"tel",label:e.$t("messages.phone_number"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),i("div",wa,[s(k,{name:"email",label:e.$t("messages.email"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full",isEditing:p.value},null,8,["label","placeholder","isEditing"])]),i("div",ba,[s(oe,{name:"password",label:e.$t("messages.password"),placeholder:e.$t("placeholder.inputText"),disabled:p.value},null,8,["label","placeholder","disabled"])]),i("div",_a,[s(oe,{name:"password_confirmation",label:e.$t("messages.confirm_password"),placeholder:e.$t("placeholder.inputText"),disabled:p.value},null,8,["label","placeholder","disabled"])])]),i("div",va,[i("div",$a,[s(re,{name:"profile",label:e.$t("messages.profile"),required:"",multiple:!0,class:"h-full",onChange:Ne},null,8,["label"])]),i("div",Sa,[s(k,{name:"id_no",label:e.$t("messages.id_no"),required:"",placeholder:e.$t("placeholder.inputTextIdNo"),class:"h-full"},null,8,["label","placeholder"])]),i("div",Ca,[s(re,{name:"id_image",label:e.$t("messages.id_image"),required:"",multiple:!0,class:"h-full",onChange:xe},null,8,["label"])])]),i("div",Ta,[s(a(_),{type:"submit",severity:"warning",loading:a(c).btnLoading,style:{"margin-right":"8px"}},{default:h(()=>[i("i",{class:Ge(p.value?"pi pi-pencil":"pi pi-plus-circle"),style:{"margin-right":"8px"}},null,2),F(" "+b(p.value?e.$t("button.edit"):e.$t("button.save"))+" "+b(e.$t("messages.customer")),1)]),_:1},8,["loading"]),s(a(_),{severity:"danger",loading:a(c).btnLoading,onClick:l[1]||(l[1]=r=>ke())},{default:h(()=>[La,F(" "+b(e.$t("button.clear")),1)]),_:1},8,["loading"])])],32)]),_:1})])):We("",!0)]),_:1}),i("div",ka,[i("div",Pa,[i("span",Va,[i("h2",qa,b(e.$t("table.title.customer")),1)]),i("span",Ea,[s(a(_),{label:g.value?e.$t("button.close"):e.$t("button.add")+" "+e.$t("messages.customer"),rounded:"",severity:g.value?"danger":"info",onClick:Le,loading:a(c).btnLoading,disabled:a(x)(a(R).CUSTOMER.CREATE)},null,8,["label","severity","loading","disabled"])])]),s(a(Ze),{value:a(c).data.props,loading:a(c).isLoading,lazy:"",tableStyle:"min-width: 50rem",totalRecords:a(c).data.total,onPage:Ie,paginator:"",first:Fe.value,scrollable:"",rows:a(o).limit,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:`${e.$t("table.pagination.show")} {first} ${e.$t("table.pagination.to")} {last} ${e.$t("table.pagination.from")} {totalRecords} ${e.$t("table.pagination.row")}`},{header:h(()=>[i("div",Ia,[i("div",Fa,[i("span",Ra,[s(a(ie),{modelValue:J.value,"onUpdate:modelValue":l[3]||(l[3]=r=>J.value=r),options:a(w).data.props,optionLabel:"name",optionValue:"id",highlightOnSelect:!0,placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full md:w-14rem",onChange:z},null,8,["modelValue","options","placeholder"])])]),i("div",Ua,[i("span",xa,[Na,s(a(se),{modelValue:Y.value,"onUpdate:modelValue":l[4]||(l[4]=r=>Y.value=r),placeholder:`${e.$t("placeholder.textSearch")} (${e.$t("messages.full_name")})`,style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",onKeyup:le(z,["enter"]),onInput:Z},null,8,["modelValue","placeholder"])])]),i("div",Da,[i("span",ja,[Oa,s(a(se),{modelValue:X.value,"onUpdate:modelValue":l[5]||(l[5]=r=>X.value=r),placeholder:`${e.$t("placeholder.textSearch")} ${e.$t("messages.phone_number")}`,style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",onKeyup:le(z,["enter"]),onInput:Z},null,8,["modelValue","placeholder"])])]),i("div",za,[i("span",Ba,[s(a(_),{icon:"pi pi-refresh",severity:"warning",onClick:l[6]||(l[6]=r=>Pe()),loading:a(c).btnLoading},null,8,["loading"])])])])]),default:h(()=>[s(a(u),{field:"id",header:e.$t("table.header.index")},{body:h(r=>[F(b(r.index+1),1)]),_:1},8,["header"]),s(a(u),{headerStyle:"min-width: 17rem",frozen:""},{body:h(({data:r})=>[i("div",Aa,[s(a(_),{type:"button",label:r.status==="open"?e.$t("messages.open"):e.$t("messages.close"),rounded:"",severity:r.status==="open"?"success":"danger",onClick:f=>Ue(r.id),disabled:a(x)(a(R).CUSTOMER.UPDATE)},null,8,["label","severity","onClick","disabled"]),s(a(_),{type:"button",icon:"pi pi-lock",rounded:"",severity:"danger",style:{color:"white"},onClick:f=>ve(r.user.id)},null,8,["onClick"]),s(a(_),{type:"button",icon:"pi pi-pencil",rounded:"",severity:"warning",style:{color:"white"},onClick:f=>Ee(r),disabled:a(x)(a(R).CUSTOMER.UPDATE)},null,8,["onClick","disabled"]),s(a(_),{type:"button",icon:"pi pi-trash",rounded:"",severity:"danger",onClick:f=>Re(r.id),disabled:a(x)(a(R).CUSTOMER.DELETE)},null,8,["onClick","disabled"])])]),_:1}),s(a(u),{header:e.$t("table.header.profile"),headerStyle:"min-width: 8rem",frozen:""},{body:h(({data:r})=>[s(a(ce),{src:r.user.profile,alt:"Image",preview:"",style:{"max-width":"80px"}},null,8,["src"])]),_:1},8,["header"]),s(a(u),{field:"id_image",header:e.$t("table.header.id_image"),headerStyle:"min-width: 8rem",frozen:""},{body:h(({data:r})=>[s(a(ce),{src:r.id_image,alt:"Image",preview:"",style:{"max-width":"80px"}},null,8,["src"])]),_:1},8,["header"]),s(a(u),{field:"id_no",header:e.$t("table.header.id_no"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(a(u),{field:"country.name",header:e.$t("table.header.country"),headerStyle:"min-width: 5rem"},null,8,["header"]),s(a(u),{field:"customer_number",header:e.$t("table.header.customer_number"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(u),{field:"name",header:e.$t("table.header.full_name"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(u),{field:"address",header:e.$t("table.header.address"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(a(u),{field:"tel",header:e.$t("table.header.phone_number"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(u),{field:"email",header:e.$t("table.header.email")},null,8,["header"]),s(a(u),{field:"status",header:e.$t("table.header.status"),headerStyle:"min-width: 5rem"},null,8,["header"]),s(a(u),{field:"created",header:e.$t("table.header.created_at"),headerStyle:"min-width: 8rem"},null,8,["header"])]),_:1},8,["value","loading","totalRecords","first","rows","currentPageReportTemplate"])]),s(aa,{ref_key:"editForm",ref:K,form:a(n),"user-id":M.value,"change-user-password":a(we),state:a(c),onOnSuccess:$e},null,8,["form","user-id","change-user-password","state"])]))}}),ht=Xe(Ka,[["__scopeId","data-v-799d9a9c"]]);export{ht as default};
