import{d as z,c as m,b as l,O as p,t as r,f as B,q as n,e as a,Y as pe,n as ue,o as h,u as me,K as he,L as fe,a as ge,A as v,G as ye,z as j,Q as ve,p as _e,h as be,F as we,g as $e,w as Ie,a2 as Se,H as N,P as Ve,_ as Me}from"./index-YYtgFme3.js";import{_ as S}from"./FormInputText.vue_vue_type_script_setup_true_lang-QBUKwU28.js";import{s as ke,h as Fe,a as J}from"./panel.esm-HWLDz_ne.js";import{b as Le,u as Ce}from"./index.esm-OxTSjBgV.js";import{s as I}from"./dropdown.esm-SRD51U9I.js";import{s as De}from"./inputnumber.esm-MPm90Esl.js";import{c as Y}from"./axios.config-EpIlfGdK.js";import{s as A}from"./divider.esm-iedPcHC-.js";import{r as Oe}from"./real-estate-service.store-WQ9jzG22.js";import{h as je}from"./house.store-bSaETxkl.js";import{p as Ue}from"./province.store-s1nTWhzi.js";import{d as Te}from"./district.store-UTKpOVcx.js";import"./inputtext.esm-gcF-MEFb.js";import"./index.esm-yogEuK8u.js";import"./index.esm-MPGM0ma0.js";import"./index.esm-tt5XFFtY.js";const Ne={class:"flex flex-column gap-2 mb-3 w-full"},Je=["for"],Ye={key:0,class:"text-red-500"},Ae=["id"],ze=z({__name:"FormTextArea",props:{name:{},label:{},required:{type:Boolean},placeholder:{},value:{}},setup(_){const i=_,{value:f,errorMessage:V}=Le(()=>i.name);return i.value&&(f.value=i.value),(g,t)=>(h(),m("div",Ne,[l("label",{for:g.name},[p(r(g.label)+" ",1),g.required?(h(),m("span",Ye," *")):B("",!0)],8,Je),n(a(ke),{"auto-resize":"",rows:"5",modelValue:a(f),"onUpdate:modelValue":t[0]||(t[0]=y=>pe(f)?f.value=y:null),id:g.name,class:ue({"p-invalid":a(V)}),"aria-describedby":`text-error-${g.name}`,placeholder:g.placeholder},null,8,["modelValue","id","class","aria-describedby","placeholder"]),l("small",{class:"p-error",id:`text-error-${g.name}`},r(a(V)),9,Ae)]))}}),d=_=>(_e("data-v-b02e413e"),_=_(),be(),_),Be={class:"card"},Ge={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},qe={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},Ee=d(()=>l("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),Qe=d(()=>l("br",null,null,-1)),xe={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},Re={class:"column is-mobile-12 is-2"},Ze=d(()=>l("span",{class:"text-red-500"}," *",-1)),He={class:"column is-mobile-12 is-2"},Pe=d(()=>l("span",{class:"text-red-500"}," *",-1)),We={class:"column is-mobile-12 is-2"},Xe=d(()=>l("span",{class:"text-red-500"}," *",-1)),Ke={class:"column is-mobile-12 is-2"},el=d(()=>l("span",{class:"text-red-500"}," *",-1)),ll={class:"column is-mobile-12 is-2"},sl=d(()=>l("span",{class:"text-red-500"}," *",-1)),al={class:"column is-mobile-12 is-2"},tl={class:"column is-mobile-12 is-2"},ol={class:"column is-mobile-12 is-2"},il={class:"column is-mobile-12 is-2"},nl={class:"column is-mobile-12 is-6"},rl={class:"column is-mobile-12 is-12"},dl={class:"column is-12"},cl={class:"column is-3"},pl=d(()=>l("span",{class:"text-red-500"}," *",-1)),ul={class:"column is-3"},ml=d(()=>l("span",{class:"text-red-500"}," *",-1)),hl={class:"column is-5"},fl=["onUpdate:modelValue"],gl={class:"column is-1"},yl=["onClick"],vl=d(()=>l("i",{class:"pi pi-times-circle"},null,-1)),_l=[vl],bl={class:"column is-mobile-12 is-12"},wl={class:"column is-12"},$l={class:"column is-mobile-12 is-12"},Il=d(()=>l("span",{class:"text-red-500"}," *",-1)),Sl={key:0},Vl={key:1,style:{color:"#029217"}},Ml={class:"column is-mobile-12 is-12"},kl=d(()=>l("span",{class:"text-red-500"}," *",-1)),Fl={key:0},Ll={key:1,style:{color:"#029217"}},Cl={class:"column is-mobile-12 is-12 text-right"},Dl=d(()=>l("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),Ol=z({__name:"AddHouse",setup(_){const{t:i}=me(),f=he(),V=fe(),g=ge(),{form:t,state:y,register:G}=je(),{getOne:q,realestateType:L}=Oe(),{getAll:E,state:C,setStateFilter:Q}=Ue(),{getAll:U,state:D,setStateFilter:M}=Te(),b=v(null),w=v(),x=async()=>{g.push({name:"owner.house"})},R=()=>{document.getElementById("fileInput").click()},Z=async e=>{var u;const s=(u=e.target.files)==null?void 0:u[0];s&&(b.value=i("uploadFile.uploading"),await ne(s),b.value=i("uploadFile.upload_success"))},H=()=>{document.getElementById("galleryInput").click()},P=async e=>{const s=e.target.files;s&&(w.value=i("uploadFile.uploading")+s.length,await re(s),w.value=i("uploadFile.upload_success")+"("+s.length+" "+i("uploadFile.file")+")")},$=v([{price:"",unit_price:"",detail:""}]),W=async()=>{$.value&&$.value.push({price:"",unit_price:"",detail:""})},X=async e=>{$.value&&$.value.splice(e,1)},{handleSubmit:K}=Ce({validationSchema:Fe}),ee=v([{id:"sale",name:"ຂາຍ"},{id:"rent",name:"ເຊົ່າ"}]),le=v([{id:"air",name:"ເເອ"},{id:"fan",name:"ພັດລົມ"},{id:"no",name:"ບໍ່ມີ"}]),se=v([{id:"day",name:"ມື້"},{id:"month",name:"ເດືອນ"},{id:"year",name:"ປີ"}]),k=v(),F=v();ye(async()=>{await ae()});const ae=async()=>{t.room_type="air",t.service_model="sale",Q.limit=1e3,await E(),await q(),t.real_estate_type_id=L.props.length>0?L.props[0].id:void 0,t.province_id=C.data.props.length>0?C.data.props[0].id:void 0,M.filter&&(M.filter.province_id=t.province_id,await U(),await T())},te=async e=>{M.filter&&(M.filter.province_id=e,await U(),await T())},T=async()=>{t.district_id=D.data.props.length>0?D.data.props[0].id:void 0},oe=K(async e=>{t.district_id?F.value?k.value?(t.village=e.village,t.zip_code=e.zipcode,t.wide=e.wide,t.long=e.long,t.remark=e.remark,t.location=e.location,t.prices=$.value,t.image=F.value,t.gallery=k.value,await G(),y.error?await de():await ce()):await O(i("placeholder.dropdownSelect")+" "+i("messages.gallery")):await O(i("placeholder.dropdownSelect")+" "+i("messages.image")):await O(i("placeholder.dropdownSelect")+" "+i("messages.district"))}),ie=async()=>{b.value="",w.value="",F.value="",k.value="";const e=document.getElementById("fileInput");e.value="";const o=document.getElementById("galleryInput");o.value=""},ne=async e=>{var o;y.btnLoading=!0;try{let s=new FormData;s.append("file",e);const u=await Y.post("http://159.223.42.254/api/upload_file",s,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTU5LjIyMy40Mi4yNTQvYXBpL2F1dGgvbG9naW4iLCJpYXQiOjE3MDc5MjgwMDksIm5iZiI6MTcwNzkyODAwOSwianRpIjoia25Ma3BqRHdObUh4a2dyUyIsInN1YiI6IjIiLCJwcnYiOiIyM2JkNWM4OTQ5ZjYwMGFkYjM5ZTcwMWM0MDA4NzJkYjdhNTk3NmY3In0.FDSN40oY148SrIvrc0oj51Ln8dgwlYj8KDCEjvUPZ1U"}});F.value=(o=u.data)==null?void 0:o.filename,y.btnLoading=!1}catch(s){console.error("Upload failed:",s)}},re=async e=>{y.btnLoading=!0;try{let o=new FormData;for(let c=0;c<e.length;c++)o.append("files[]",e[c]);const u=(await Y.post("http://159.223.42.254/api/upload/multiple/files",o,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTU5LjIyMy40Mi4yNTQvYXBpL2F1dGgvbG9naW4iLCJpYXQiOjE3MDc5MjgwMDksIm5iZiI6MTcwNzkyODAwOSwianRpIjoia25Ma3BqRHdObUh4a2dyUyIsInN1YiI6IjIiLCJwcnYiOiIyM2JkNWM4OTQ5ZjYwMGFkYjM5ZTcwMWM0MDA4NzJkYjdhNTk3NmY3In0.FDSN40oY148SrIvrc0oj51Ln8dgwlYj8KDCEjvUPZ1U"}})).data.filename.map(c=>({image:`${c}`}));k.value=u,y.btnLoading=!1}catch(o){console.error("Upload failed:",o)}},O=e=>{f.add({severity:"error",summary:i("toast.summary.error"),detail:e,life:3e3})},de=()=>{f.add({severity:"error",summary:i("toast.summary.error"),detail:`${y.error}`,life:3e3})},ce=async()=>{V.require({message:i("confirmDuplicate.message"),header:i("confirmDuplicate.header"),rejectLabel:i("confirmDuplicate.rejectLabel"),acceptLabel:i("confirmDuplicate.acceptLabel"),rejectClass:"p-button-danger",acceptClass:"p-button-info",accept:async()=>{await ie(),f.add({severity:"success",summary:i("toast.summary.duplicate"),detail:i("toast.detail.success_duplicate"),life:3e3})},reject:async()=>{window.location.reload(),f.add({severity:"error",summary:i("toast.summary.not_duplicate"),detail:i("toast.detail.cancel_duplicate"),life:3e3})}})};return(e,o)=>(h(),m("div",Be,[l("div",Ge,[l("span",qe,[l("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:o[0]||(o[0]=s=>x())},[Ee,p(" "+r(e.$t("messages.form_register")),1)])])]),Qe,n(a(A)),l("form",{onSubmit:o[7]||(o[7]=ve(s=>a(oe)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[l("div",xe,[l("div",Re,[l("label",null,[p(r(e.$t("messages.realestate_type"))+" ",1),Ze]),n(a(I),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:a(t).real_estate_type_id,"onUpdate:modelValue":o[1]||(o[1]=s=>a(t).real_estate_type_id=s),options:a(L).props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",He,[l("label",null,[p(r(e.$t("messages.service_model"))+" ",1),Pe]),n(a(I),{style:{"margin-top":"8px"},modelValue:a(t).service_model,"onUpdate:modelValue":o[2]||(o[2]=s=>a(t).service_model=s),options:ee.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),optionValue:"id",highlightOnSelect:!0,class:"w-full"},null,8,["modelValue","options","placeholder"])]),l("div",We,[l("label",null,[p(r(e.$t("messages.room_type"))+" ",1),Xe]),n(a(I),{style:{"margin-top":"8px"},modelValue:a(t).room_type,"onUpdate:modelValue":o[3]||(o[3]=s=>a(t).room_type=s),options:le.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",Ke,[l("label",null,[p(r(e.$t("messages.province"))+" ",1),el]),n(a(I),{style:{"margin-top":"8px"},modelValue:a(t).province_id,"onUpdate:modelValue":o[4]||(o[4]=s=>a(t).province_id=s),options:a(C).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:o[5]||(o[5]=s=>te(a(t).province_id))},null,8,["modelValue","options","placeholder"])]),l("div",ll,[l("label",null,[p(r(e.$t("messages.district"))+" ",1),sl]),n(a(I),{style:{"margin-top":"8px"},modelValue:a(t).district_id,"onUpdate:modelValue":o[6]||(o[6]=s=>a(t).district_id=s),options:a(D).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options","placeholder"])]),l("div",al,[n(S,{name:"village",label:e.$t("messages.village"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",tl,[n(S,{name:"zipcode",label:e.$t("messages.zip_code"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",ol,[n(S,{name:"wide",label:e.$t("messages.wide"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",il,[n(S,{name:"long",label:e.$t("messages.long"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",nl,[n(S,{name:"location",label:e.$t("messages.location"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",rl,[n(ze,{name:"remark",label:e.$t("messages.details"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",dl,[n(a(J),{header:e.$t("messages.setting_price_for_rent")},{default:j(()=>[(h(!0),m(we,null,$e($.value,(s,u)=>(h(),m("div",{class:"columns is-12",key:u},[l("div",cl,[l("label",null,[p(r(e.$t("messages.service_model"))+" ",1),pl]),n(a(I),{modelValue:s.unit_price,"onUpdate:modelValue":c=>s.unit_price=c,options:se.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),l("div",ul,[l("label",null,[p(r(e.$t("messages.price"))+" ",1),ml]),n(a(De),{modelValue:s.price,"onUpdate:modelValue":c=>s.price=c,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue"])]),l("div",hl,[l("label",null,r(e.$t("messages.details")),1),Ie(l("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":c=>s.detail=c,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,fl),[[Se,s.detail]])]),l("div",gl,[u>0?(h(),m("a",{key:0,onClick:c=>X(u),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},_l,8,yl)):B("",!0)])]))),128)),l("div",bl,[l("a",{onClick:W,class:"button is-primary"},r(e.$t("button.add_item")),1)])]),_:1},8,["header"])]),l("div",wl,[n(a(J),{header:e.$t("messages.profile_and_gallery")},{default:j(()=>[l("div",$l,[l("label",null,[p(r(e.$t("messages.profile"))+" ",1),Il]),l("label",{class:"upload-box",onClick:R,style:N({border:b.value?"1px dashed #029217":"1px dashed red"})},[b.value?(h(),m("div",Vl,r(b.value),1)):(h(),m("div",Sl,r(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:Z},null,32)]),n(a(A)),l("div",Ml,[l("label",null,[p(r(e.$t("messages.gallery"))+" ",1),kl]),l("label",{class:"upload-box",onClick:H,style:N({border:w.value?"1px dashed #029217":"1px dashed red"})},[w.value?(h(),m("div",Ll,r(w.value),1)):(h(),m("div",Fl,r(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"galleryInput",multiple:"",style:{display:"none"},onChange:P},null,32)])]),_:1},8,["header"])]),l("div",Cl,[n(a(Ve),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:a(y).btnLoading},{default:j(()=>[Dl,p(" "+r(e.$t("button.save_data")),1)]),_:1},8,["loading"])])])],32)]))}}),Hl=Me(Ol,[["__scopeId","data-v-b02e413e"]]);export{Hl as default};
