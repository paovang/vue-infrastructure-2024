import{d as se,u as ie,a as oe,H as de,M as ne,N as me,r as U,o as ce,P as N,e as pe,f as d,t as m,y as r,g as t,E as y,j as ue,b as g,Q as b,K as h,V as he}from"./index-MjRCg0YL.js";import{s as i,a as fe}from"./column.esm-ZuQ6nTrb.js";import{s as ye}from"./inputtext.esm-UqIFFayD.js";import{s as R}from"./dropdown.esm-UQOMQvoi.js";import{h as ge}from"./house.store-KF0lRLJC.js";import{r as be}from"./real-estate-service.store-sWgzdwol.js";import{p as _e}from"./province.store-2p96Wi7g.js";import{d as we}from"./district.store-_2b0VM5h.js";import{v as _}from"./validation-permissions-4yz6MH5P.js";import"./paginator.esm-925-p7Bs.js";import"./inputnumber.esm-VOjNxSDR.js";import"./overlayeventbus.esm-GnOA58Nm.js";import"./index.esm-sUZKYg91.js";import"./checkbox.esm-BfZt4cKm.js";import"./index.esm-qFr5hdpl.js";import"./axios.config-EMV3l8KB.js";const ve={class:"card"},Se={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},$e={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},Ce={class:"mb-3"},Le={class:"w-full sm:w-auto flex-order-0 sm:flex-order-1 mb-4 sm:mb-0"},Ee={class:"col-12 md:col-12 flex flex-row",style:{"margin-top":"-15px"}},Pe={class:"col-12 md:col-5"},Re=d("span",{class:"text-red-500"}," *",-1),Te={class:"col-12 md:col-3"},Ae=d("span",{class:"text-red-500"}," *",-1),Ve={class:"col-12 md:col-2"},ke=d("span",{class:"text-red-500"}," *",-1),De={class:"col-12 md:col-2"},je=d("span",{class:"text-red-500"}," *",-1),Ue={class:"flex flex-wrap gap-2"},Ne={class:"p-badge p-component",style:{"margin-left":"5px","border-radius":"5px !important"}},et=se({__name:"ListHouse",setup(Oe){const{t:l}=ie(),w=oe(),{query:f}=de(),c=ne(),C=me(),{form:o,getAll:v,state:p,setStateFilter:a,remove:O,updateStatus:q,customerRefer:F}=ge(),{getOne:H,realestateType:S}=be(),{getAll:I,state:L,setStateFilter:B}=_e(),{getAll:M,state:E,setStateFilter:T}=we(),K=U([{id:"all",name:l("messages.all")},{id:"sale",name:l("messages.service_sale")},{id:"rent",name:l("messages.service_rent")}]),z=U([{id:"all",name:l("messages.all")},{id:"air",name:l("messages.air")},{id:"fan",name:l("messages.fan")},{id:"no",name:l("messages.none")}]),A=e=>e==="rent"||e==="buy",G=e=>{switch(e){case"open":return"success";case"close":return"danger";case"rent":return"warning";case"buy":return"danger";default:return"info"}};async function P(){Object.keys(f).length!==0&&(a.page=f.page?Number(f.page):1,a.limit=f.limit?Number(f.limit):10,w.push({query:{page:a.page,limit:a.limit}})),await k()}ce(async()=>{a.filter&&(a.filter.real_estate_type_id="",a.filter.service_model="",a.filter.room_type="",a.filter.district_id="",a.filter.province_id="",a.filter.village="",a.filter.wide="",a.filter.long="",a.limit=10,a.page=1,a.filter.status=""),await P()});const Q=async e=>{await F(e),p.error?await D():await P()},W=async e=>{w.push({name:"owner.edit.house",params:{id:e}})},J=async e=>{await O(e),p.error?await D():await P()};async function X(e){a.page=e.page+1,a.limit=e.rows;const{page:n,limit:s}=a;w.push({name:"owner.house",query:{page:n,limit:s}}),await v()}const Y=N(()=>{let e=0;return a.page&&a.limit&&(e=(a.page-1)*a.limit),e}),$=async()=>{a.filter&&(a.filter.real_estate_type_id=o.real_estate_type_id==="all"?"":o.real_estate_type_id,a.filter.service_model=o.service_model==="all"?"":o.service_model,a.filter.room_type=o.room_type==="all"?"":o.room_type,a.filter.district_id=o.district_id==="all"?"":o.district_id),await v()};async function Z(e){var s,u,j;const n=e.target.name;e.target.value===""&&(n==="village"&&((s=a.filter)==null?void 0:s.village)!==void 0&&(a.filter.village=""),n==="wide"&&((u=a.filter)==null?void 0:u.wide)!==void 0&&(a.filter.wide=""),n==="long"&&((j=a.filter)==null?void 0:j.long)!==void 0&&(a.filter.long=""),await v())}const V=N({get:()=>a.filter.village||"",set:e=>{a.filter&&(a.filter.village=e)}}),k=async()=>{await v(),await H(),S.props.unshift({id:"all",name:l("messages.all")}),o.room_type="all",o.service_model="all",B.limit=1e3,await I(),L.data.props.unshift({id:"all",name:l("messages.all")}),o.real_estate_type_id=S.props.length>0?S.props[0].id:void 0,o.province_id=L.data.props.length>0?L.data.props[0].id:void 0,T.filter&&(T.filter.province_id=o.province_id,await M(),E.data.props.unshift({id:"all",name:l("messages.all")}),await x())},x=async()=>{o.district_id=E.data.props.length>0?E.data.props[0].id:void 0},ee=async e=>{C.require({message:l("confirmCustomerRefer.message"),header:l("confirmCustomerRefer.header"),rejectLabel:l("confirmCustomerRefer.rejectLabel"),acceptLabel:l("confirmCustomerRefer.acceptLabel"),rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-info",accept:async()=>{await Q(e),c.add({severity:"success",summary:l("toast.summary.delete"),detail:l("toast.detail.delete"),life:3e3})},reject:()=>{c.add({severity:"error",summary:l("toast.summary.cancel_delete"),detail:l("toast.detail.cancel_delete"),life:3e3})}})},te=async e=>{C.require({message:l("confirmDelete.message"),header:l("confirmDelete.header"),rejectLabel:l("confirmDelete.rejectLabel"),acceptLabel:l("confirmDelete.acceptLabel"),rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-danger",accept:async()=>{await J(e),c.add({severity:"success",summary:l("toast.summary.delete"),detail:l("toast.detail.delete"),life:3e3})},reject:()=>{c.add({severity:"error",summary:l("toast.summary.cancel_delete"),detail:l("toast.detail.cancel_delete"),life:3e3})}})},ae=async e=>{await q(e),await k()},le=async e=>{C.require({message:l("confirmUpdateStatus.message"),header:l("confirmUpdateStatus.header"),rejectLabel:l("confirmUpdateStatus.rejectLabel"),acceptLabel:l("confirmUpdateStatus.acceptLabel"),rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-success",accept:async()=>{await ae(e),c.add({severity:"success",summary:l("toast.summary.success"),detail:l("toast.detail.successfully"),life:3e3})},reject:()=>{c.add({severity:"error",summary:l("toast.summary.cancel_update"),detail:l("toast.detail.cancel_update"),life:3e3})}})},D=()=>{c.add({severity:"error",summary:l("toast.summary.error"),detail:`${p.error}`,life:3e3})},re=async()=>{w.push({name:"owner.add.house"})};return(e,n)=>(ue(),pe("div",ve,[d("div",Se,[d("span",$e,[d("h2",Ce,m(e.$t("table.title.real_estate")),1)]),d("span",Le,[r(t(b),{label:e.$t("button.add"),severity:"info",onClick:n[0]||(n[0]=s=>re()),disabled:t(_)(t(g).REAL_ESTATE.CREATE)},null,8,["label","disabled"])])]),r(t(fe),{value:t(p).data.props,onPage:X,paginator:"",first:Y.value,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem",loading:t(p).isLoading,lazy:"",scrollable:"",totalRecords:t(p).data.total,rows:t(a).limit,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:`${e.$t("table.pagination.show")} {first} ${e.$t("table.pagination.to")} {last} ${e.$t("table.pagination.from")} {totalRecords} ${e.$t("table.pagination.row")}`},{header:y(()=>[d("div",Ee,[d("div",Pe,[d("label",null,[h(m(e.$t("messages.search"))+" ",1),Re]),r(t(ye),{modelValue:V.value,"onUpdate:modelValue":n[1]||(n[1]=s=>V.value=s),placeholder:e.$t("placeholder.textSearch"),style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",name:"village",onKeyup:he($,["enter"]),onInput:Z},null,8,["modelValue","placeholder"])]),d("div",Te,[d("label",null,[h(m(e.$t("messages.realestate_type"))+" ",1),Ae]),r(t(R),{name:"real_estate_type",modelValue:t(o).real_estate_type_id,"onUpdate:modelValue":n[2]||(n[2]=s=>t(o).real_estate_type_id=s),options:t(S).props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,onChange:$},null,8,["modelValue","options","placeholder"])]),d("div",Ve,[d("label",null,[h(m(e.$t("messages.service_model"))+" ",1),ke]),r(t(R),{modelValue:t(o).service_model,"onUpdate:modelValue":n[3]||(n[3]=s=>t(o).service_model=s),options:K.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),optionValue:"id",highlightOnSelect:!0,class:"w-full",onChange:$},null,8,["modelValue","options","placeholder"])]),d("div",De,[d("label",null,[h(m(e.$t("messages.room_type"))+" ",1),je]),r(t(R),{modelValue:t(o).room_type,"onUpdate:modelValue":n[4]||(n[4]=s=>t(o).room_type=s),options:z.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,onChange:$},null,8,["modelValue","options","placeholder"])])])]),default:y(()=>[r(t(i),{headerStyle:"min-width: 20rem",frozen:""},{body:y(({data:s})=>[d("div",Ue,[r(t(b),{type:"button",severity:"info",rounded:"",style:{color:"white","font-weight":"bold"},onClick:u=>ee(s.id),disabled:A(s.status)||t(_)(t(g).REAL_ESTATE.UPDATE),class:"btn-refer"},{default:y(()=>[h(m(e.$t("messages.refer"))+" ",1),d("span",Ne,m(s.refer),1)]),_:2},1032,["onClick","disabled"]),r(t(b),{type:"button",label:s.status,rounded:"",severity:G(s.status),disabled:A(s.status)||t(_)(t(g).REAL_ESTATE.UPDATE),style:{color:"white"},onClick:u=>le(s.id)},null,8,["label","severity","disabled","onClick"]),r(t(b),{type:"button",icon:"pi pi-pencil",rounded:"",severity:"warning",style:{color:"white"},onClick:u=>W(s.id),disabled:t(_)(t(g).REAL_ESTATE.UPDATE)},null,8,["onClick","disabled"]),r(t(b),{type:"button",icon:"pi pi-trash",rounded:"",severity:"danger",onClick:u=>te(s.id),disabled:t(_)(t(g).REAL_ESTATE.DELETE)},null,8,["onClick","disabled"])])]),_:1}),r(t(i),{field:"id",header:e.$t("table.header.index")},{body:y(s=>[h(m(s.index+1),1)]),_:1},8,["header"]),r(t(i),{field:"real_esate_number",header:e.$t("table.header.real_esate_number"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"name",header:e.$t("table.header.real_estate_name"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"trans_real_estate_type.name",header:e.$t("table.header.realestate_type"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"service_model",header:e.$t("table.header.service_model"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"room_type",header:e.$t("table.header.room_type"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"owner_name",header:e.$t("table.header.owner"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"agent_name",header:e.$t("table.header.name"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"village",header:e.$t("table.header.address"),headerStyle:"min-width: 15rem"},null,8,["header"]),r(t(i),{field:"long",header:e.$t("table.header.long"),headerStyle:"min-width: 7rem"},null,8,["header"]),r(t(i),{field:"wide",header:e.$t("table.header.wide"),headerStyle:"min-width: 6rem"},null,8,["header"]),r(t(i),{field:"total_bed",header:e.$t("table.header.total_bed"),headerStyle:"min-width: 9rem"},null,8,["header"]),r(t(i),{field:"total_bath",header:e.$t("table.header.total_bath"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"build_in",header:e.$t("table.header.build_in"),headerStyle:"min-width: 6rem"},null,8,["header"]),r(t(i),{field:"garage",header:e.$t("table.header.garage"),headerStyle:"min-width: 6rem"},null,8,["header"]),r(t(i),{field:"status",header:e.$t("table.header.status"),headerStyle:"min-width: 5rem"},null,8,["header"]),r(t(i),{field:"created_by.name",header:e.$t("table.header.created_by"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"updated_by.name",header:e.$t("table.header.updated_by"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"created_at",header:e.$t("table.header.created_at"),headerStyle:"min-width: 8rem"},null,8,["header"]),r(t(i),{field:"updated_at",header:e.$t("table.header.updated_at"),headerStyle:"min-width: 8rem"},null,8,["header"])]),_:1},8,["value","first","loading","totalRecords","rows","currentPageReportTemplate"])]))}});export{et as default};
