import{d as ce,u as pe,M as ue,N as me,a as he,C as m,I as fe,c as h,e as l,Q as p,t as r,v as n,f as o,A as T,V as ge,p as _e,i as ye,o as f,F as ve,h as be,w as we,a4 as $e,g as Se,J as q,U as Ve,_ as Fe}from"./index-llMO1yHS.js";import{_ as b}from"./FormInputText.vue_vue_type_script_setup_true_lang-6XtTriDy.js";import{_ as ke}from"./FormTextArea.vue_vue_type_script_setup_true_lang-AKWtBdcz.js";import{s as w}from"./dropdown.esm-I5cFhe2s.js";import{s as Ie}from"./inputnumber.esm-YpFAgp4f.js";import{u as Ce}from"./index.esm-uJ5y799G.js";import{h as Le,s as z}from"./panel.esm-_mzX--g_.js";import{c as N}from"./axios.config-loFPrKFG.js";import{s as x}from"./divider.esm-yddHqRWU.js";import{r as De}from"./real-estate-service.store-G8DDK5fY.js";import{h as Te}from"./house.store-Vi_kqDxC.js";import{p as Ue}from"./province.store-dP5Z3wo8.js";import{d as Be}from"./district.store-oIYv0VNN.js";import"./inputtext.esm-sVJ0Aq9M.js";import"./textarea.esm-IXGSqSQ0.js";import"./index.esm-AA3GWlcV.js";import"./index.esm-6JEny88C.js";import"./index.esm-JbkfZnsm.js";const d=$=>(_e("data-v-807e7c4a"),$=$(),ye(),$),Ae={class:"card"},qe={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},ze={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},Ne=d(()=>l("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),xe=d(()=>l("br",null,null,-1)),Ee={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},Me={class:"column is-mobile-12 is-2"},Oe=d(()=>l("span",{class:"text-red-500"}," *",-1)),Ge={class:"column is-mobile-12 is-2"},je=d(()=>l("span",{class:"text-red-500"}," *",-1)),Pe={class:"column is-mobile-12 is-2"},He=d(()=>l("span",{class:"text-red-500"}," *",-1)),Je={class:"column is-mobile-12 is-2"},Qe={class:"column is-mobile-12 is-2"},Re=d(()=>l("span",{class:"text-red-500"}," *",-1)),We={class:"column is-mobile-12 is-2"},Ke=d(()=>l("span",{class:"text-red-500"}," *",-1)),Xe={class:"column is-mobile-12 is-2"},Ye={class:"column is-mobile-12 is-2"},Ze={class:"column is-mobile-12 is-2"},el={class:"column is-mobile-12 is-2"},ll={class:"column is-mobile-12 is-4"},tl={class:"column is-mobile-12 is-12"},sl={class:"column is-12"},al={class:"column is-3"},ol=d(()=>l("span",{class:"text-red-500"}," *",-1)),il={class:"column is-3"},nl=d(()=>l("span",{class:"text-red-500"}," *",-1)),rl={class:"column is-5"},dl=["onUpdate:modelValue"],cl={class:"column is-1"},pl=["onClick"],ul=d(()=>l("i",{class:"pi pi-times-circle"},null,-1)),ml=[ul],hl={class:"column is-mobile-12 is-12"},fl={class:"column is-12"},gl={class:"column is-mobile-12 is-12"},_l=d(()=>l("span",{class:"text-red-500"}," *",-1)),yl={key:0},vl={key:1,style:{color:"#029217"}},bl={class:"column is-mobile-12 is-12"},wl=d(()=>l("span",{class:"text-red-500"}," *",-1)),$l={key:0},Sl={key:1,style:{color:"#029217"}},Vl={class:"column is-mobile-12 is-12 text-right"},Fl=d(()=>l("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),kl=ce({__name:"AddHouse",setup($){const{t:i}=pe(),S=ue(),E=me(),M=he(),{form:s,state:g,register:O}=Te(),{getOne:G,realestateType:I}=De(),{getAll:j,state:C,setStateFilter:P}=Ue(),{getAll:U,state:L,setStateFilter:V}=Be(),_=m(null),y=m(),H=async()=>{M.push({name:"owner.house"})},J=()=>{document.getElementById("fileInput").click()},Q=async e=>{var u;const t=(u=e.target.files)==null?void 0:u[0];t&&(_.value=i("uploadFile.uploading"),await ie(t),_.value=i("uploadFile.upload_success"))},R=()=>{document.getElementById("galleryInput").click()},W=async e=>{const t=e.target.files;t&&(y.value=i("uploadFile.uploading")+t.length,await ne(t),y.value=i("uploadFile.upload_success")+"("+t.length+" "+i("uploadFile.file")+")")},v=m([{price:"",unit_price:"",detail:""}]),K=async()=>{v.value&&v.value.push({price:"",unit_price:"",detail:""})},X=async e=>{v.value&&v.value.splice(e,1)},{handleSubmit:Y}=Ce({validationSchema:Le}),Z=m([{id:"sale",name:"ຂາຍ"},{id:"rent",name:"ເຊົ່າ"}]),ee=m([{id:"air",name:"ເເອ"},{id:"fan",name:"ພັດລົມ"},{id:"no",name:"ບໍ່ມີ"}]),le=m([{id:"day",name:"ມື້"},{id:"month",name:"ເດືອນ"},{id:"year",name:"ປີ"}]),B=localStorage.getItem("token"),F=m(),k=m();fe(async()=>{await te()});const te=async()=>{s.room_type="air",s.service_model="sale",P.limit=1e3,await j(),await G(),s.real_estate_type_id=I.props.length>0?I.props[0].id:void 0,s.province_id=C.data.props.length>0?C.data.props[0].id:void 0,V.filter&&(V.filter.province_id=s.province_id,await U(),await A())},se=async e=>{V.filter&&(V.filter.province_id=e,await U(),await A())},A=async()=>{s.district_id=L.data.props.length>0?L.data.props[0].id:void 0},ae=Y(async e=>{s.district_id?k.value?F.value?(s.village=e.village,s.zip_code=e.zipcode,s.wide=e.wide,s.long=e.long,s.name=e.name,s.remark=e.remark,s.location=e.location,s.prices=v.value,s.image=k.value,s.gallery=F.value,await O(),g.error?await re():await de()):await D(i("placeholder.dropdownSelect")+" "+i("messages.gallery")):await D(i("placeholder.dropdownSelect")+" "+i("messages.image")):await D(i("placeholder.dropdownSelect")+" "+i("messages.district"))}),oe=async()=>{_.value="",y.value="",k.value="",F.value="";const e=document.getElementById("fileInput");e.value="";const a=document.getElementById("galleryInput");a.value=""},ie=async e=>{var a;g.btnLoading=!0;try{let t=new FormData;t.append("file",e);const u=await N.post("http://127.0.0.1:8000/api/upload_file",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${B}`}});k.value=(a=u.data)==null?void 0:a.filename,g.btnLoading=!1}catch(t){console.error("Upload failed:",t)}},ne=async e=>{g.btnLoading=!0;try{let a=new FormData;for(let c=0;c<e.length;c++)a.append("files[]",e[c]);const u=(await N.post("http://127.0.0.1:8000/api/upload/multiple/files",a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${B}`}})).data.filename.map(c=>({image:`${c}`}));F.value=u,g.btnLoading=!1}catch(a){console.error("Upload failed:",a)}},D=e=>{S.add({severity:"error",summary:i("toast.summary.error"),detail:e,life:3e3})},re=()=>{S.add({severity:"error",summary:i("toast.summary.error"),detail:`${g.error}`,life:3e3})},de=async()=>{E.require({message:i("confirmDuplicate.message"),header:i("confirmDuplicate.header"),rejectLabel:i("confirmDuplicate.rejectLabel"),acceptLabel:i("confirmDuplicate.acceptLabel"),rejectClass:"p-button-danger",acceptClass:"p-button-info",accept:async()=>{await oe(),S.add({severity:"success",summary:i("toast.summary.duplicate"),detail:i("toast.detail.success_duplicate"),life:3e3})},reject:async()=>{window.location.reload(),S.add({severity:"error",summary:i("toast.summary.not_duplicate"),detail:i("toast.detail.cancel_duplicate"),life:3e3})}})};return(e,a)=>(f(),h("div",Ae,[l("div",qe,[l("span",ze,[l("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:a[0]||(a[0]=t=>H())},[Ne,p(" "+r(e.$t("messages.form_register")),1)])])]),xe,n(o(x)),l("form",{onSubmit:a[7]||(a[7]=ge(t=>o(ae)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[l("div",Ee,[l("div",Me,[l("label",null,[p(r(e.$t("messages.realestate_type"))+" ",1),Oe]),n(o(w),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:o(s).real_estate_type_id,"onUpdate:modelValue":a[1]||(a[1]=t=>o(s).real_estate_type_id=t),options:o(I).props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",Ge,[l("label",null,[p(r(e.$t("messages.service_model"))+" ",1),je]),n(o(w),{style:{"margin-top":"8px"},modelValue:o(s).service_model,"onUpdate:modelValue":a[2]||(a[2]=t=>o(s).service_model=t),options:Z.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),optionValue:"id",highlightOnSelect:!0,class:"w-full"},null,8,["modelValue","options","placeholder"])]),l("div",Pe,[l("label",null,[p(r(e.$t("messages.room_type"))+" ",1),He]),n(o(w),{style:{"margin-top":"8px"},modelValue:o(s).room_type,"onUpdate:modelValue":a[3]||(a[3]=t=>o(s).room_type=t),options:ee.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",Je,[n(b,{name:"name",label:e.$t("messages.name"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",Qe,[l("label",null,[p(r(e.$t("messages.province"))+" ",1),Re]),n(o(w),{style:{"margin-top":"8px"},modelValue:o(s).province_id,"onUpdate:modelValue":a[4]||(a[4]=t=>o(s).province_id=t),options:o(C).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:a[5]||(a[5]=t=>se(o(s).province_id))},null,8,["modelValue","options","placeholder"])]),l("div",We,[l("label",null,[p(r(e.$t("messages.district"))+" ",1),Ke]),n(o(w),{style:{"margin-top":"8px"},modelValue:o(s).district_id,"onUpdate:modelValue":a[6]||(a[6]=t=>o(s).district_id=t),options:o(L).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options","placeholder"])]),l("div",Xe,[n(b,{name:"village",label:e.$t("messages.village"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",Ye,[n(b,{name:"zipcode",label:e.$t("messages.zip_code"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",Ze,[n(b,{name:"wide",label:e.$t("messages.wide"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",el,[n(b,{name:"long",label:e.$t("messages.long"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",ll,[n(b,{name:"location",label:e.$t("messages.location"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",tl,[n(ke,{name:"remark",label:e.$t("messages.details"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",sl,[n(o(z),{header:e.$t("messages.setting_price_for_rent")},{default:T(()=>[(f(!0),h(ve,null,be(v.value,(t,u)=>(f(),h("div",{class:"columns is-12",key:u},[l("div",al,[l("label",null,[p(r(e.$t("messages.service_model"))+" ",1),ol]),n(o(w),{modelValue:t.unit_price,"onUpdate:modelValue":c=>t.unit_price=c,options:le.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),l("div",il,[l("label",null,[p(r(e.$t("messages.price"))+" ",1),nl]),n(o(Ie),{modelValue:t.price,"onUpdate:modelValue":c=>t.price=c,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue"])]),l("div",rl,[l("label",null,r(e.$t("messages.details")),1),we(l("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":c=>t.detail=c,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,dl),[[$e,t.detail]])]),l("div",cl,[u>0?(f(),h("a",{key:0,onClick:c=>X(u),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},ml,8,pl)):Se("",!0)])]))),128)),l("div",hl,[l("a",{onClick:K,class:"button is-primary"},r(e.$t("button.add_item")),1)])]),_:1},8,["header"])]),l("div",fl,[n(o(z),{header:e.$t("messages.profile_and_gallery")},{default:T(()=>[l("div",gl,[l("label",null,[p(r(e.$t("messages.profile"))+" ",1),_l]),l("label",{class:"upload-box",onClick:J,style:q({border:_.value?"1px dashed #029217":"1px dashed red"})},[_.value?(f(),h("div",vl,r(_.value),1)):(f(),h("div",yl,r(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:Q},null,32)]),n(o(x)),l("div",bl,[l("label",null,[p(r(e.$t("messages.gallery"))+" ",1),wl]),l("label",{class:"upload-box",onClick:R,style:q({border:y.value?"1px dashed #029217":"1px dashed red"})},[y.value?(f(),h("div",Sl,r(y.value),1)):(f(),h("div",$l,r(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"galleryInput",multiple:"",style:{display:"none"},onChange:W},null,32)])]),_:1},8,["header"])]),l("div",Vl,[n(o(Ve),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:o(g).btnLoading},{default:T(()=>[Fl,p(" "+r(e.$t("button.save_data")),1)]),_:1},8,["loading"])])])],32)]))}}),Hl=Fe(kl,[["__scopeId","data-v-807e7c4a"]]);export{Hl as default};
