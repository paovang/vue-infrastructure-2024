import{d as F,u as O,M as B,r as w,l as I,E as b,g as a,j as q,f as l,y as s,Q as E,U as j,L as x,H as D,a as z,P as M,o as H,e as K,t as y,V as G,b as J,K as Q,J as W}from"./index-T5neeANX.js";import{a as A}from"./appointment.store-gxqeBvef.js";import{s as o,a as X}from"./column.esm-7MOUDEH8.js";import{s as Y}from"./dropdown.esm-thKvbGdv.js";import{s as U}from"./inputtext.esm-FOZVrLy4.js";import{_ as Z}from"./FormTextArea.vue_vue_type_script_setup_true_lang-gRn7otTe.js";import{u as ee}from"./vee-validate.esm-T0mW44dS.js";import{c as te,a as ae}from"./index.esm-243pfhuq.js";import{v as se}from"./validation-permissions-YNoT00ST.js";import"./axios.config-EMV3l8KB.js";import"./index.esm-hVcZBCEW.js";import"./overlayeventbus.esm-kH0sz69E.js";import"./index.esm-Ezx94t0w.js";import"./checkbox.esm-UzkgcCDo.js";import"./textarea.esm-v7u-JEEH.js";const le=v=>te({reason:ae().required(v.reason)}),ie=le,ne={class:"flex flex-column align-items-center justify-content-center"},oe={class:"col-12 md:col-12"},re={class:"flex flex-column"},de={class:"col-12 md:col-12"},me={class:"flex flex-column"},pe=F({__name:"Update.Component",props:{id:{}},emits:["onSuccess","onHide"],setup(v,{expose:r,emit:c}){const{t}=O(),h=B(),d=w(!1);r({visible:d});const $=c,f=w(!1),V=v,S={reason:t("placeholder.inputText")},{form:p,update:C,state:u}=A(),{handleSubmit:L,handleReset:T}=ee({validationSchema:ie(S)}),P=L(async m=>{p.id=V.id,p.reason=m.reason,await C(),u.error?await N():(await k(),await R(),d.value=!1)}),k=async()=>{await T(),$("onSuccess")},N=()=>{h.add({severity:"error",summary:t("toast.summary.error"),detail:`${u.error}`,life:3e3})},R=()=>{h.add({severity:"success",summary:t("toast.summary.success"),detail:t("toast.detail.successfully"),life:3e3})};return(m,g)=>(q(),I(a(x),{visible:d.value,"onUpdate:visible":g[1]||(g[1]=_=>d.value=_),modal:"",onHide:k,header:m.$t("messages.update_appointment"),style:{width:"50vw"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[l("form",{onSubmit:g[0]||(g[0]=j(_=>a(P)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[l("div",ne,[l("div",oe,[l("div",re,[s(Z,{name:"reason",label:m.$t("messages.reason"),required:"",placeholder:m.$t("placeholder.inputText")},null,8,["label","placeholder"])])])]),l("div",de,[l("div",me,[s(a(E),{type:"submit",severity:"danger",label:m.$t("button.update")+" "+m.$t("button.appointment"),loading:f.value},null,8,["label","loading"])])])],32)]),_:1},8,["visible","header"]))}}),ue={class:"card"},ce={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},he={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},fe={class:"mb-3"},ge={class:"col-12 md:col-12 flex flex-row",style:{"margin-top":"-15px"}},ye={class:"col-12 md:col-5"},be={class:"p-input-icon-left w-full flex-order-1 sm:flex-order-0"},_e=l("i",{class:"pi pi-search",style:{"margin-top":"-10px"}},null,-1),we={class:"col-12 md:col-3"},ve={class:"col-12 md:col-3"},$e={class:"col-12 md:col-1",style:{"text-align":"right"}},Se={class:"flex flex-wrap gap-2 btn-right"},Ie=F({__name:"ListAppointment",setup(v){const{form:r,getAll:c,setStateFilter:t,state:h}=A(),{query:d}=D(),$=z(),{t:f}=O(),V=w([{id:"all",name:f("messages.all")},{id:"pending",name:f("messages.pending")},{id:"done",name:f("messages.success")},{id:"cancel",name:f("messages.cancel")}]),S=w(),p=w(),C=async()=>{var e,i;r.status="pending",r.date_appointment="",p.value="",((e=t.filter)==null?void 0:e.name)!==void 0&&(t.filter.name=""),((i=t.filter)==null?void 0:i.date_appointment)!==void 0&&(t.filter.date_appointment=""),await u()},u=async()=>{t.filter&&(t.filter.status=r.status==="all"?"":r.status,t.filter.date_appointment=p.value),await c()},L=e=>e==="done"?"green":e==="cancel"?"red":"";async function T(e){var i;e.target.value===""&&(((i=t.filter)==null?void 0:i.name)!==void 0&&(t.filter.name="",t.filter.date_appointment=""),await c())}const P=M({get:()=>t.filter.name||"",set:e=>{t.filter?t.filter.name=e:t.filter={name:e}}}),k=async(e,i)=>{i!=="done"&&(r.id=e,S.value.visible=!0)},N=async()=>{await _()};async function R(e){t.page=e.page+1,t.limit=e.rows;const{page:i,limit:n}=t;$.push({name:"owner.appointment",query:{page:i,limit:n}}),await c()}const m=M(()=>{let e=0;return t.page&&t.limit&&(e=(t.page-1)*t.limit),e});async function g(){Object.keys(d).length!==0&&(t.page=d.page?Number(d.page):1,t.limit=d.limit?Number(d.limit):10,$.push({query:{page:t.page,limit:t.limit}})),await _()}const _=async()=>{r.status="pending",r.date_appointment="",t.filter&&(t.filter.status=r.status==="all"?"":r.status,t.filter.date_appointment="",t.filter.name=""),await c()};return H(async()=>{t.filter&&(t.filter.status="pending",t.page=1,t.limit=10),await g()}),(e,i)=>(q(),K("div",ue,[l("div",ce,[l("span",he,[l("h2",fe,y(e.$t("table.title.appointment")),1)])]),s(a(X),{value:a(h).data.props,onPage:R,paginator:"",first:m.value,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem",loading:a(h).isLoading,lazy:"",scrollable:"",totalRecords:a(h).data.total,rows:a(t).limit,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:`${e.$t("table.pagination.show")} {first} ${e.$t("table.pagination.to")} {last} ${e.$t("table.pagination.from")} {totalRecords} ${e.$t("table.pagination.row")}`},{header:b(()=>[l("div",ge,[l("div",ye,[l("label",null,y(e.$t("messages.search")),1),l("span",be,[_e,s(a(U),{modelValue:P.value,"onUpdate:modelValue":i[0]||(i[0]=n=>P.value=n),placeholder:`${e.$t("placeholder.textSearch")} (${e.$t("messages.reserve_number")}, ${e.$t("messages.real_esate_number")}, ${e.$t("messages.service_model")})`,style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",onKeyup:G(u,["enter"]),onInput:T},null,8,["modelValue","placeholder"])])]),l("div",we,[l("label",null,y(e.$t("messages.status")),1),s(a(Y),{name:"real_estate_type",modelValue:a(r).status,"onUpdate:modelValue":i[1]||(i[1]=n=>a(r).status=n),options:V.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,onChange:u},null,8,["modelValue","options","placeholder"])]),l("div",ve,[l("label",null,y(e.$t("messages.date_appointment")),1),s(a(U),{modelValue:p.value,"onUpdate:modelValue":i[2]||(i[2]=n=>p.value=n),type:"date",style:{width:"100% !important"},onChange:u},null,8,["modelValue"])]),l("div",$e,[s(a(E),{icon:"pi pi-refresh",severity:"warning",style:{"margin-top":"22px !important",color:"white"},onClick:C})])])]),default:b(()=>[s(a(o),{frozen:""},{body:b(({data:n})=>[l("div",Se,[s(a(E),{type:"button",icon:"pi pi-pencil",rounded:"",severity:"danger",style:{color:"white"},onClick:Pe=>k(n.id,n.status),disabled:a(se)(a(J).APPOINTMENT.UPDATE)},null,8,["onClick","disabled"])])]),_:1}),s(a(o),{field:"id",header:e.$t("table.header.index")},{body:b(n=>[Q(y(n.index+1),1)]),_:1},8,["header"]),s(a(o),{field:"date_appointment",header:e.$t("table.header.date_appointment"),headerStyle:"min-width: 10rem"},null,8,["header"]),s(a(o),{field:"reserve_number",header:e.$t("table.header.reserve_number"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"customer_name",header:e.$t("table.header.customer_name"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"customer_tel",header:e.$t("table.header.customer_phone"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"estate_list.real_esate_number",header:e.$t("table.header.real_esate_number"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"estate_list.name",header:e.$t("table.header.real_estate_name"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"estate_list.trans_real_estate_type.name",header:e.$t("table.header.real_estate_type"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"estate_list.service_model",header:e.$t("table.header.service_model"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"estate_list.room_type",header:e.$t("table.header.room_type"),headerStyle:"min-width: 7rem"},null,8,["header"]),s(a(o),{field:"description",header:e.$t("table.header.desciption"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"reason",header:e.$t("table.header.reason"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"updated_by.name",header:e.$t("table.header.updated_by"),headerStyle:"min-width: 8rem"},null,8,["header"]),s(a(o),{field:"status",header:e.$t("table.header.status"),headerStyle:"min-width: 8rem"},{body:b(n=>[l("span",{style:W({color:L(n.data.status)})},y(n.data.status),5)]),_:1},8,["header"])]),_:1},8,["value","first","loading","totalRecords","rows","currentPageReportTemplate"]),s(pe,{ref_key:"editForm",ref:S,id:a(r).id,onOnSuccess:N},null,8,["id"])]))}});export{Ie as default};
