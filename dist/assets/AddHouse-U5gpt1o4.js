import{d as Le,u as Ie,M as Ce,N as Te,a as Ue,r as p,o as ze,e as h,f as l,Q as u,t as c,y as n,g as i,E as U,V as De,p as Be,k as Me,j as g,F as R,i as x,w as Ae,a3 as Ee,h as P,U as H,J as W,_ as Ne}from"./index-PzTuJOUN.js";import{_ as b}from"./FormInputText.vue_vue_type_script_setup_true_lang-_nNwcA8S.js";import{_ as qe}from"./FormTextArea.vue_vue_type_script_setup_true_lang-idokTN39.js";import{s as k}from"./dropdown.esm-ZDqzpD83.js";import{s as Oe}from"./inputnumber.esm-F6aDnC6G.js";import{u as je}from"./index.esm-6dCfzI_X.js";import{h as Ge,s as J}from"./panel.esm-yzSIvyNB.js";import{c as Q}from"./axios.config-gXfSTYZr.js";import{s as K}from"./divider.esm-w7TYeOde.js";import{r as Re}from"./real-estate-service.store-gY5_kjZI.js";import{h as xe}from"./house.store-1bfWeDqM.js";import{p as Pe}from"./province.store-L6GfJoSN.js";import{d as He}from"./district.store-B2S-fzuI.js";import{v as We,s as X,i as Je}from"./toast-AS0Hl_8E.js";import"./inputtext.esm-ASbIeNyZ.js";import"./textarea.esm-H0kjQfci.js";import"./overlayeventbus.esm-ReU6tk2n.js";import"./index.esm-a8LTY2Sx.js";import"./index.esm-Vq0scFfZ.js";const m=L=>(Be("data-v-9e94e420"),L=L(),Me(),L),Qe={class:"card"},Ke={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},Xe={class:"p-input-icon-left w-full sm:w-20rem flex-order-1 sm:flex-order-0"},Ye=m(()=>l("i",{class:"pi pi-arrow-left",style:{color:"green"}},null,-1)),Ze=m(()=>l("br",null,null,-1)),el={class:"columns is-12 is-multiline",style:{"margin-top":"20px"}},ll={class:"column is-mobile-12 is-2"},sl=m(()=>l("span",{class:"text-red-500"}," *",-1)),al={class:"column is-mobile-12 is-2"},tl=m(()=>l("span",{class:"text-red-500"}," *",-1)),ol={class:"column is-mobile-12 is-2"},il=m(()=>l("span",{class:"text-red-500"}," *",-1)),nl={class:"column is-mobile-12 is-2"},rl={class:"column is-mobile-12 is-2"},dl=m(()=>l("span",{class:"text-red-500"}," *",-1)),cl={class:"column is-mobile-12 is-2"},ml=m(()=>l("span",{class:"text-red-500"}," *",-1)),pl={class:"column is-mobile-12 is-2 set-margin-top"},ul={class:"column is-mobile-12 is-2 set-margin-top"},hl={class:"column is-mobile-12 is-2 set-margin-top"},gl={class:"column is-mobile-12 is-2 set-margin-top"},_l={class:"column is-mobile-12 is-2 set-margin-top"},fl={class:"column is-mobile-12 is-2 set-margin-top"},vl={class:"column is-mobile-12 is-2 set-margin-top"},yl={class:"column is-mobile-12 is-10 set-margin-top"},bl={class:"column is-mobile-12 is-12 set-margin-top"},wl={class:"column is-12"},$l={class:"column is-3"},Sl=m(()=>l("span",{class:"text-red-500"}," *",-1)),Vl={class:"column is-3"},Fl=m(()=>l("span",{class:"text-red-500"}," *",-1)),kl={class:"column is-5"},Ll=["onUpdate:modelValue"],Il={class:"column is-1"},Cl=["onClick"],Tl=m(()=>l("i",{class:"pi pi-times-circle"},null,-1)),Ul=[Tl],zl={class:"column is-mobile-12 is-12"},Dl={class:"column is-12"},Bl={class:"column is-mobile-12 is-12"},Ml=m(()=>l("span",{class:"text-red-500"}," *",-1)),Al={key:0},El={key:1,style:{color:"#029217"}},Nl={class:"column is-mobile-12 is-12"},ql=m(()=>l("span",{class:"text-red-500"}," *",-1)),Ol={key:0},jl={key:1,style:{color:"#029217"}},Gl={key:0,class:"column is-mobile-12 is-12"},Rl={class:"column is-mobile-12 is-12 text-right"},xl=m(()=>l("i",{class:"pi pi-save",style:{"margin-right":"8px"}},null,-1)),Pl=Le({__name:"AddHouse",setup(L){const{t:s}=Ie(),v=Ce(),Y=Te(),Z=Ue(),{form:o,state:w,register:ee}=xe(),{getOne:le,realestateType:z}=Re(),{getAll:se,state:D,setStateFilter:ae}=Pe(),{getAll:E,state:B,setStateFilter:I}=He(),y=p(null),_=p(),N=p(2e3),q=p(1900),te=async()=>{Z.push({name:"owner.house"})},oe=()=>{document.getElementById("fileInput").click()},ie=async e=>{var r;const t=e.target,a=(r=t.files)==null?void 0:r[0];if(a){if(!await We(a)){await X({toast:v,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.real_estate_profile_valid_file_mimes")}),t.value="",y.value="",S.value="";return}if(!await Je(a)){await X({toast:v,error:"error",summary:s("toast.summary.error"),detail:s("toast.summary.real_estate_profile_valid_file_size")}),t.value="",y.value="",S.value="";return}const d=new Image;d.src=URL.createObjectURL(a),d.onload=async()=>{const f=d.width,V=d.height;f>N.value||V>q.value?(y.value="",S.value="",t.value="",await Se(s("messages.dimensions"))):(y.value=s("uploadFile.uploading"),await we(a),y.value=s("uploadFile.upload_success"))}}},ne=()=>{document.getElementById("galleryInput").click(),F.value=[]},F=p([]),re=async e=>{const t=e.target,a=t.files,r=1*1024*1024,d=5*1024*1024;if(a){let f=0;for(let V=0;V<a.length;V++){const T=a[V];f+=T.size;try{await de(T,r)}catch(ke){F.value.push(ke)}}if(f>d){F.value.push(s("toast.summary.maximum_allowed_size_5MB")),_.value="",_.value="",t.value="";return}F.value.length<=0?(_.value=s("uploadFile.uploading")+a.length,await $e(a),_.value=s("uploadFile.upload_success")+"("+a.length+" "+s("uploadFile.file")+")"):(_.value="",_.value="",t.value="")}},de=(e,t)=>new Promise((a,r)=>{if(e.size>t)r(`${e.name} => `+s("toast.summary.real_estate_profile_valid_file_size_1MB"));else if(!["image/jpeg","image/jpg"].includes(e.type))r(`${e.name} => `+s("toast.summary.real_estate_profile_valid_file_mimes"));else{const f=new Image;f.src=URL.createObjectURL(e),f.onload=()=>{const V=f.width,T=f.height;V>N.value||T>q.value?r(`${e.name} => `+s("messages.dimensions")):a("")},f.onerror=()=>{r(`Error loading image ${e.name}.`)}}}),$=p([{price:"",unit_price:"",detail:""}]),ce=async()=>{var e;$.value&&(((e=$.value)==null?void 0:e.length)>2?v.add({severity:"error",summary:s("toast.summary.must_be_length_three"),detail:s("toast.detail.cancel_delete"),life:3e3}):$.value.push({price:"",unit_price:"",detail:""}))},me=async e=>{$.value&&$.value.splice(e,1)},M=p(!1),pe=async e=>{e==="rent"?M.value=!0:M.value=!1},{handleSubmit:ue}=je({validationSchema:Ge}),he=p([{id:"sale",name:s("messages.service_sale")},{id:"rent",name:s("messages.service_rent")}]),ge=p([{id:"air",name:s("messages.air")},{id:"fan",name:s("messages.fan")},{id:"no",name:s("messages.none")}]),_e=p([{id:"sale",name:s("messages.service_sale")},{id:"day",name:s("messages.service_daily")},{id:"month",name:s("messages.service_monthly")},{id:"year",name:s("messages.service_yearly")}]),O=localStorage.getItem("token"),C=p(),S=p();ze(async()=>{await fe()});const fe=async()=>{o.room_type="air",o.service_model="sale",ae.limit=1e3,await se(),await le(),o.real_estate_type_id=z.props.length>0?z.props[0].id:void 0,o.province_id=D.data.props.length>0?D.data.props[0].id:void 0,I.filter&&(I.filter.province_id=o.province_id,await E(),await j())},ve=async e=>{I.filter&&(I.filter.province_id=e,await E(),await j())},j=async()=>{o.district_id=B.data.props.length>0?B.data.props[0].id:void 0},ye=ue(async e=>{o.district_id?S.value?C.value?(o.village=e.village,o.zip_code=e.zipcode,o.wide=e.wide,o.long=e.long,o.total_bath=e.bath,o.total_bed=e.bed,o.garage=e.garage,o.name=e.name,o.remark=e.remark,o.location=e.location,o.prices=$.value,o.image=S.value,o.gallery=C.value,await ee(),w.error?await Ve():await Fe()):await A(s("placeholder.dropdownSelect")+" "+s("messages.gallery")):await A(s("placeholder.dropdownSelect")+" "+s("messages.image")):await A(s("placeholder.dropdownSelect")+" "+s("messages.district"))}),be=async()=>{y.value="",_.value="",S.value="",C.value="";const e=document.getElementById("fileInput");e.value="";const t=document.getElementById("galleryInput");t.value=""},we=async e=>{var t;w.btnLoading=!0;try{let a=new FormData;a.append("file",e);const r=await Q.post("http://188.166.183.153:8000/api/upload_file",a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${O}`}});S.value=(t=r.data)==null?void 0:t.filename,w.btnLoading=!1}catch(a){await G(a)}},$e=async e=>{w.btnLoading=!0;try{let t=new FormData;for(let d=0;d<e.length;d++)t.append("files[]",e[d]);const r=(await Q.post("http://188.166.183.153:8000/api/upload/multiple/files",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${O}`}})).data.filename.map(d=>({image:`${d}`}));C.value=r,w.btnLoading=!1}catch(t){await G(t)}},G=e=>{v.add({severity:"error",summary:s("toast.summary.error"),detail:e,life:3e3})},Se=e=>{v.add({severity:"error",summary:s("toast.summary.error"),detail:e,life:3e3})},A=e=>{v.add({severity:"error",summary:s("toast.summary.error"),detail:e,life:3e3})},Ve=()=>{v.add({severity:"error",summary:s("toast.summary.error"),detail:`${w.error}`,life:3e3})},Fe=async()=>{Y.require({message:s("confirmDuplicate.message"),header:s("confirmDuplicate.header"),rejectLabel:s("confirmDuplicate.rejectLabel"),acceptLabel:s("confirmDuplicate.acceptLabel"),rejectClass:"p-button-danger",acceptClass:"p-button-info",accept:async()=>{await be(),v.add({severity:"success",summary:s("toast.summary.duplicate"),detail:s("toast.detail.success_duplicate"),life:3e3})},reject:async()=>{window.location.reload(),v.add({severity:"error",summary:s("toast.summary.not_duplicate"),detail:s("toast.detail.cancel_duplicate"),life:3e3})}})};return(e,t)=>(g(),h("div",Qe,[l("div",Ke,[l("span",Xe,[l("h2",{style:{"font-weight":"bold","font-size":"20px"},class:"arrow-left",onClick:t[0]||(t[0]=a=>te())},[Ye,u(" "+c(e.$t("messages.form_register")),1)])])]),Ze,n(i(K)),l("form",{onSubmit:t[8]||(t[8]=De(a=>i(ye)(),["prevent"])),class:"flex flex-column gap-3 h-full"},[l("div",el,[l("div",ll,[l("label",null,[u(c(e.$t("messages.realestate_type"))+" ",1),sl]),n(i(k),{name:"real_estate_type",style:{"margin-top":"8px"},modelValue:i(o).real_estate_type_id,"onUpdate:modelValue":t[1]||(t[1]=a=>i(o).real_estate_type_id=a),options:i(z).props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",al,[l("label",null,[u(c(e.$t("messages.service_model"))+" ",1),tl]),n(i(k),{style:{"margin-top":"8px"},modelValue:i(o).service_model,"onUpdate:modelValue":t[2]||(t[2]=a=>i(o).service_model=a),options:he.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),optionValue:"id",highlightOnSelect:!0,class:"w-full",onChange:t[3]||(t[3]=a=>pe(i(o).service_model))},null,8,["modelValue","options","placeholder"])]),l("div",ol,[l("label",null,[u(c(e.$t("messages.room_type"))+" ",1),il]),n(i(k),{style:{"margin-top":"8px"},modelValue:i(o).room_type,"onUpdate:modelValue":t[4]||(t[4]=a=>i(o).room_type=a),options:ge.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0},null,8,["modelValue","options","placeholder"])]),l("div",nl,[n(b,{name:"name",label:e.$t("messages.name"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",rl,[l("label",null,[u(c(e.$t("messages.province"))+" ",1),dl]),n(i(k),{style:{"margin-top":"8px"},modelValue:i(o).province_id,"onUpdate:modelValue":t[5]||(t[5]=a=>i(o).province_id=a),options:i(D).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:t[6]||(t[6]=a=>ve(i(o).province_id))},null,8,["modelValue","options","placeholder"])]),l("div",cl,[l("label",null,[u(c(e.$t("messages.district"))+" ",1),ml]),n(i(k),{style:{"margin-top":"8px"},modelValue:i(o).district_id,"onUpdate:modelValue":t[7]||(t[7]=a=>i(o).district_id=a),options:i(B).data.props,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:""},null,8,["modelValue","options","placeholder"])]),l("div",pl,[n(b,{name:"village",label:e.$t("messages.village"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",ul,[n(b,{name:"zipcode",label:e.$t("messages.zip_code"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",hl,[n(b,{name:"bed",label:e.$t("messages.total_bed"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",gl,[n(b,{name:"bath",label:e.$t("messages.total_bath"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",_l,[n(b,{name:"wide",label:e.$t("messages.wide"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",fl,[n(b,{name:"long",label:e.$t("messages.long"),placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",vl,[n(b,{name:"garage",label:e.$t("messages.garage"),required:"",placeholder:e.$t("placeholder.inputTextGarage"),class:"h-full"},null,8,["label","placeholder"])]),l("div",yl,[n(b,{name:"location",label:e.$t("messages.location"),required:"",placeholder:e.$t("placeholder.inputTextLocation"),class:"h-full"},null,8,["label","placeholder"])]),l("div",bl,[n(qe,{name:"remark",label:e.$t("messages.details"),required:"",placeholder:e.$t("placeholder.inputText"),class:"h-full"},null,8,["label","placeholder"])]),l("div",wl,[n(i(J),{header:e.$t("messages.setting_price_for_rent")},{default:U(()=>[(g(!0),h(R,null,x($.value,(a,r)=>(g(),h("div",{class:"columns is-12",key:r},[l("div",$l,[l("label",null,[u(c(e.$t("messages.service_model"))+" ",1),Sl]),n(i(k),{modelValue:a.unit_price,"onUpdate:modelValue":d=>a.unit_price=d,options:_e.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,required:""},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])]),l("div",Vl,[l("label",null,[u(c(e.$t("messages.price"))+" ",1),Fl]),n(i(Oe),{modelValue:a.price,"onUpdate:modelValue":d=>a.price=d,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",required:"",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'",width:"100% !important"}},null,8,["modelValue","onUpdate:modelValue"])]),l("div",kl,[l("label",null,c(e.$t("messages.est_m")),1),Ae(l("input",{name:"detail",type:"text",class:"input","onUpdate:modelValue":d=>a.detail=d,placeholder:"ກະລຸນາປ້ອນກ່ອນ...",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"}},null,8,Ll),[[Ee,a.detail]])]),l("div",Il,[r>0?(g(),h("a",{key:0,onClick:d=>me(r),class:"button is-danger remove-btn",style:{"margin-top":"22px"}},Ul,8,Cl)):P("",!0)])]))),128)),l("div",zl,[n(i(H),{onClick:ce,class:"button is-primary",style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},disabled:!M.value},{default:U(()=>[u(c(e.$t("button.add_item")),1)]),_:1},8,["disabled"])])]),_:1},8,["header"])]),l("div",Dl,[n(i(J),{header:e.$t("messages.profile_and_gallery")},{default:U(()=>[l("div",Bl,[l("label",null,[u(c(e.$t("messages.profile"))+" ",1),Ml]),l("label",{class:"upload-box",onClick:oe,style:W({border:y.value?"1px dashed #029217":"1px dashed red"})},[y.value?(g(),h("div",El,c(y.value),1)):(g(),h("div",Al,c(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:ie},null,32)]),n(i(K)),l("div",Nl,[l("label",null,[u(c(e.$t("messages.gallery"))+" ",1),ql]),l("label",{class:"upload-box",onClick:ne,style:W({border:_.value?"1px dashed #029217":"1px dashed red"})},[_.value?(g(),h("div",jl,c(_.value),1)):(g(),h("div",Ol,c(e.$t("placeholder.inputFile")),1))],4),l("input",{type:"file",id:"galleryInput",multiple:"",style:{display:"none"},onChange:re},null,32)]),F.value.length>0?(g(),h("div",Gl,[(g(!0),h(R,null,x(F.value,(a,r)=>(g(),h("p",{style:{color:"red"},key:r},c(r+1)+". "+c(a),1))),128))])):P("",!0)]),_:1},8,["header"])]),l("div",Rl,[n(i(H),{style:{"font-family":"'NotoSansLao','Montserrat', 'sans-serif'"},type:"submit",severity:"info",loading:i(w).btnLoading},{default:U(()=>[xl,u(" "+c(e.$t("button.save_data")),1)]),_:1},8,["loading"])])])],32)]))}}),ms=Ne(Pl,[["__scopeId","data-v-9e94e420"]]);export{ms as default};
