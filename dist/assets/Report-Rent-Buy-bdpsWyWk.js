import{d as T,a as I,u as K,r as w,P as S,o as M,e as V,f as r,t as s,g as t,h as O,y as o,E as f,j as P,K as p,V as j,Q as q}from"./index-RlNAeXbs.js";import{r as z}from"./rent-store-zqCXZond.js";import{s as d,a as A}from"./column.esm-yFM92kdb.js";import{s as C}from"./dropdown.esm-spvGu--j.js";import{s as b}from"./inputtext.esm-d-sngYVx.js";import{f as v}from"./format.currency-CcPyHQva.js";import"./service-oQCQfoSh.js";import"./axios.config-EMV3l8KB.js";import"./paginator.esm-SfTHz6cQ.js";import"./inputnumber.esm-JvpHGqPa.js";import"./overlayeventbus.esm-WS9E9e-Q.js";import"./index.esm-_jvDQSdZ.js";import"./checkbox.esm-Soj6TcRb.js";import"./index.esm-OUpHlj66.js";const E={class:"card"},F={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},Q={class:"p-input-icon-left w-full sm:w-30rem flex-order-1 sm:flex-order-0"},G={class:"mb-3"},H={key:0,style:{"font-size":"18px","font-weight":"bold",color:"green"}},J={class:"col-12 md:col-12 flex flex-row",style:{"margin-top":"-15px"}},W={class:"col-12 md:col-3"},X=r("span",{class:"text-red-500"}," *",-1),Y={class:"col-12 md:col-2"},Z={class:"col-12 md:col-2"},x={class:"col-12 md:col-2"},ee={class:"col-12 md:col-2"},te={class:"col-12 md:col-1",style:{"text-align":"right"}},ae=r("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),le=r("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),re=r("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),be=T({__name:"Report-Rent-Buy",setup(oe){const{form:i,setStateFilter:l,state:u,getAllReportRentBuy:_,getAllCustomers:R,getCustomers:m}=z(),L=I(),{t:h}=K(),k=w([{id:"all",name:h("messages.all")},{id:"rent",name:h("messages.service_rent")},{id:"buy",name:h("messages.service_sale")}]),g=w(),y=w();async function N(e){var a;const n=e.target.name;e.target.value===""&&(n==="search"&&((a=l.filter)==null?void 0:a.search)!==void 0&&(l.filter.search=""),await _())}const $=S({get:()=>l.filter.search||"",set:e=>{l.filter&&(l.filter.search=e)}}),B=async()=>{l.filter&&(l.filter.service_model="",l.filter.from_date="",l.filter.to_date="",l.filter.search=""),i.customer_id=m.data.props.length>0?m.data.props[0].id:void 0,y.value="",g.value="",i.to_date="",i.from_date="",i.service_model="all",await c()},c=async()=>{l.filter&&(l.filter.service_model=i.service_model==="all"?"":i.service_model,l.filter.from_date=g.value,l.filter.to_date=y.value,l.filter.customer_id=i.customer_id),await _()};async function U(e){l.page=e.page+1,l.limit=e.rows;const{page:n,limit:a}=l;L.push({name:"report.rent.buy",query:{page:n,limit:a}}),await _(),i.customer_id=m.data.props.length>0?m.data.props[0].id:void 0,i.service_model="all"}const D=S(()=>{let e=0;return l.page&&l.limit&&(e=(l.page-1)*l.limit),e});return M(async()=>{await R(),i.service_model="all",m.data.props.unshift({id:"all",name:h("messages.all"),customer_number:h("messages.all"),tel:h("messages.all")}),i.customer_id=m.data.props.length>0?m.data.props[0].id:void 0,await _()}),(e,n)=>(P(),V("div",E,[r("div",F,[r("span",Q,[r("h2",G,s(e.$t("table.title.report_rent_buy")),1)]),t(i).customer_id!=="all"&&t(u).data.summary?(P(),V("span",H,s(e.$t("messages.total_price"))+" : "+s(t(v)(t(u).data.summary,t(u).data.currency)),1)):O("",!0)]),o(t(A),{value:t(u).data.props,onPage:U,paginator:"",first:D.value,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem",loading:t(u).isLoading,lazy:"",totalRecords:t(u).data.total,rows:t(l).limit,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:`${e.$t("table.pagination.show")} {first} ${e.$t("table.pagination.to")} {last} ${e.$t("table.pagination.from")} {totalRecords} ${e.$t("table.pagination.row")}`},{header:f(()=>[r("div",J,[r("div",W,[r("label",null,[p(s(e.$t("messages.search"))+" ",1),X]),o(t(b),{modelValue:$.value,"onUpdate:modelValue":n[0]||(n[0]=a=>$.value=a),placeholder:e.$t("placeholder.textSearch"),style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",name:"search",onKeyup:j(c,["enter"]),onInput:N},null,8,["modelValue","placeholder"])]),r("div",Y,[r("label",null,s(e.$t("messages.owner")),1),o(t(C),{name:"customer",modelValue:t(i).customer_id,"onUpdate:modelValue":n[1]||(n[1]=a=>t(i).customer_id=a),options:t(m).data.props,optionLabel:a=>`${a.customer_number} - ${a.name} - ${a.tel}`,placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:c},null,8,["modelValue","options","optionLabel","placeholder"])]),r("div",Z,[r("label",null,s(e.$t("messages.status")),1),o(t(C),{name:"real_estate_type",modelValue:t(i).service_model,"onUpdate:modelValue":n[2]||(n[2]=a=>t(i).service_model=a),options:k.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,onChange:c},null,8,["modelValue","options","placeholder"])]),r("div",x,[r("label",null,s(e.$t("messages.start_date")),1),o(t(b),{modelValue:g.value,"onUpdate:modelValue":n[3]||(n[3]=a=>g.value=a),type:"date",style:{width:"100% !important"},onChange:c},null,8,["modelValue"])]),r("div",ee,[r("label",null,s(e.$t("messages.end_date")),1),o(t(b),{modelValue:y.value,"onUpdate:modelValue":n[4]||(n[4]=a=>y.value=a),type:"date",style:{width:"100% !important"},onChange:c},null,8,["modelValue"])]),r("div",te,[o(t(q),{icon:"pi pi-refresh",severity:"warning",style:{"margin-top":"22px !important",color:"white"},onClick:B})])])]),default:f(()=>[o(t(d),{field:"id",header:e.$t("table.header.index")},{body:f(a=>[p(s(a.index+1),1)]),_:1},8,["header"]),o(t(d),{field:"date",header:e.$t("table.header.date_rent"),headerStyle:"min-width: 8rem"},null,8,["header"]),o(t(d),{field:"number",header:e.$t("table.header.rent_number"),headerStyle:"min-width: 12rem"},null,8,["header"]),o(t(d),{field:"customer_name",header:e.$t("table.header.customer_name"),headerStyle:"min-width: 10rem"},null,8,["header"]),o(t(d),{field:"customer_tel",header:e.$t("table.header.customer_phone"),headerStyle:"min-width: 10rem"},null,8,["header"]),o(t(d),{header:e.$t("table.header.info_account"),headerStyle:"min-width: 25rem"},{body:f(({data:a})=>[p(s(a.real_estate_list.account.customer_number)+" ",1),r("span",null,[ae,p(" "+s(a.real_estate_list.account.name),1)]),r("span",null,[le,p(" "+s(a.real_estate_list.account.owner),1)]),r("span",null,[re,p(" "+s(a.real_estate_list.account.tel),1)])]),_:1},8,["header"]),o(t(d),{field:"real_estate_list.real_esate_number",header:e.$t("table.header.real_esate_number"),headerStyle:"min-width: 12rem"},null,8,["header"]),o(t(d),{field:"real_estate_list.name",header:e.$t("table.header.real_estate_name"),headerStyle:"min-width: 8rem"},null,8,["header"]),o(t(d),{field:"real_estate_list.trans_real_estate_type.name",header:e.$t("table.header.real_estate_type"),headerStyle:"min-width: 10rem"},null,8,["header"]),o(t(d),{field:"service_model",header:e.$t("table.header.service_model"),headerStyle:"min-width: 8rem"},null,8,["header"]),o(t(d),{field:"from_date",header:e.$t("table.header.from_date"),headerStyle:"min-width: 8rem"},null,8,["header"]),o(t(d),{field:"to_date",header:e.$t("table.header.to_date"),headerStyle:"min-width: 8rem"},null,8,["header"]),o(t(d),{header:e.$t("table.header.price"),headerStyle:"min-width: 15rem"},{body:f(({data:a})=>[p(s(t(v)(a.price,a.currency))+" - ( "+s(a.qty)+" / "+s(a.unit_price)+") ",1)]),_:1},8,["header"]),o(t(d),{header:e.$t("table.header.total"),headerStyle:"min-width: 13rem"},{body:f(({data:a})=>[p(s(t(v)(a.total,a.currency)),1)]),_:1},8,["header"])]),_:1},8,["value","first","loading","totalRecords","rows","currentPageReportTemplate"])]))}});export{be as default};
