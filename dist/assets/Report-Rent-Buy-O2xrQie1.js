import{d as k,a as I,u as N,r as B,P as y,o as U,e as D,f as r,t as i,y as o,E as h,g as t,j as T,Q as p,W as M,U as O}from"./index-lHHUaHrB.js";import{r as j}from"./rent-store-7zpleoML.js";import{s as d,a as q}from"./column.esm-lSiNCgBl.js";import{s as w}from"./dropdown.esm-JPa_IcjP.js";import{b}from"./calendar.esm-yhHxUpqZ.js";import{s as A}from"./inputtext.esm-AWs-KwBd.js";import{f as $}from"./format.currency-CcPyHQva.js";import"./service-nuWS6klM.js";import"./axios.config-gXfSTYZr.js";import"./format.date--bimoUa2.js";import"./paginator.esm-nW8oPckw.js";import"./inputnumber.esm-IRPXUiZQ.js";import"./overlayeventbus.esm-01Kc7sQv.js";import"./index.esm-2VMzOVBK.js";import"./checkbox.esm-ny1oPYu9.js";import"./index.esm-cGoAmfMp.js";const E={class:"card"},F={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},K={class:"p-input-icon-left w-full sm:w-30rem flex-order-1 sm:flex-order-0"},z={class:"mb-3"},Q={class:"col-12 md:col-12 flex flex-row",style:{"margin-top":"-15px"}},W={class:"col-12 md:col-3"},G=r("span",{class:"text-red-500"}," *",-1),H={class:"col-12 md:col-2"},J={class:"col-12 md:col-2"},X={class:"col-12 md:col-2"},Y={class:"col-12 md:col-2"},Z={class:"col-12 md:col-1",style:{"text-align":"right"}},x=r("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),ee=r("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),te=r("i",{class:"pi pi-angle-right",style:{color:"green","margin-left":"5px",width:"20px"}},null,-1),we=k({__name:"Report-Rent-Buy",setup(ae){const{form:s,setStateFilter:l,state:f,getAllReportRentBuy:u,getAllCustomers:v,getCustomers:c}=j(),S=I(),{t:_}=N(),V=B([{id:"all",name:_("messages.all")},{id:"rent",name:_("messages.service_rent")},{id:"buy",name:_("messages.service_sale")}]);async function P(e){var a;const n=e.target.name;e.target.value===""&&(n==="search"&&((a=l.filter)==null?void 0:a.search)!==void 0&&(l.filter.search=""),await u())}const g=y({get:()=>l.filter.search||"",set:e=>{l.filter&&(l.filter.search=e)}}),R=async()=>{l.filter&&(l.filter.service_model="",l.filter.from_date="",l.filter.to_date="",l.filter.search=""),s.to_date="",s.from_date="",s.service_model="all",await m()},m=async()=>{l.filter&&(l.filter.service_model=s.service_model==="all"?"":s.service_model,l.filter.from_date=s.from_date,l.filter.to_date=s.to_date,l.filter.customer_id=s.customer_id),await u()};async function L(e){l.page=e.page+1,l.limit=e.rows;const{page:n,limit:a}=l;S.push({name:"report.rent.buy",query:{page:n,limit:a}}),await u(),s.customer_id=c.data.props.length>0?c.data.props[0].id:void 0,s.service_model="all"}const C=y(()=>{let e=0;return l.page&&l.limit&&(e=(l.page-1)*l.limit),e});return U(async()=>{await u(),await v(),s.service_model="all",s.customer_id=c.data.props.length>0?c.data.props[0].id:void 0}),(e,n)=>(T(),D("div",E,[r("div",F,[r("span",K,[r("h2",z,i(e.$t("table.title.report_rent_buy")),1)])]),o(t(q),{value:t(f).data.props,onPage:L,paginator:"",first:C.value,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem",loading:t(f).isLoading,lazy:"",totalRecords:t(f).data.total,rows:t(l).limit,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:`${e.$t("table.pagination.show")} {first} ${e.$t("table.pagination.to")} {last} ${e.$t("table.pagination.from")} {totalRecords} ${e.$t("table.pagination.row")}`},{header:h(()=>[r("div",Q,[r("div",W,[r("label",null,[p(i(e.$t("messages.search"))+" ",1),G]),o(t(A),{modelValue:g.value,"onUpdate:modelValue":n[0]||(n[0]=a=>g.value=a),placeholder:e.$t("placeholder.textSearch"),style:{"font-family":"NotoSansLao, Montserrat"},class:"w-full",name:"search",onKeyup:M(m,["enter"]),onInput:P},null,8,["modelValue","placeholder"])]),r("div",H,[r("label",null,i(e.$t("messages.owner")),1),o(t(w),{name:"customer",modelValue:t(s).customer_id,"onUpdate:modelValue":n[1]||(n[1]=a=>t(s).customer_id=a),options:t(c).data.props,optionLabel:a=>`${a.customer_number} - ${a.name} - ${a.tel}`,placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,filter:"",onChange:m},null,8,["modelValue","options","optionLabel","placeholder"])]),r("div",J,[r("label",null,i(e.$t("messages.status")),1),o(t(w),{name:"real_estate_type",modelValue:t(s).service_model,"onUpdate:modelValue":n[2]||(n[2]=a=>t(s).service_model=a),options:V.value,optionLabel:"name",placeholder:e.$t("placeholder.dropdownSelect"),class:"w-full",optionValue:"id",highlightOnSelect:!0,onChange:m},null,8,["modelValue","options","placeholder"])]),r("div",X,[r("label",null,i(e.$t("messages.start_date")),1),o(t(b),{modelValue:t(s).from_date,"onUpdate:modelValue":n[3]||(n[3]=a=>t(s).from_date=a),showIcon:"",style:{width:"100%"},onDateSelect:m,onInput:m},null,8,["modelValue"])]),r("div",Y,[r("label",null,i(e.$t("messages.end_date")),1),o(t(b),{modelValue:t(s).to_date,"onUpdate:modelValue":n[4]||(n[4]=a=>t(s).to_date=a),showIcon:"",style:{width:"100%"},onDateSelect:m,onInput:m},null,8,["modelValue"])]),r("div",Z,[o(t(O),{icon:"pi pi-refresh",severity:"warning",style:{"margin-top":"22px !important",color:"white"},onClick:R})])])]),default:h(()=>[o(t(d),{field:"id",header:e.$t("table.header.index")},{body:h(a=>[p(i(a.index+1),1)]),_:1},8,["header"]),o(t(d),{field:"date",header:e.$t("table.header.date_rent"),headerStyle:"min-width: 7rem"},null,8,["header"]),o(t(d),{field:"number",header:e.$t("table.header.rent_number"),headerStyle:"min-width: 10rem"},null,8,["header"]),o(t(d),{field:"customer_name",header:e.$t("table.header.customer_name"),headerStyle:"min-width: 10rem"},null,8,["header"]),o(t(d),{field:"customer_tel",header:e.$t("table.header.customer_phone"),headerStyle:"min-width: 10rem"},null,8,["header"]),o(t(d),{header:e.$t("table.header.info_account"),headerStyle:"min-width: 25rem"},{body:h(({data:a})=>[p(i(a.real_estate_list.account.customer_number)+" ",1),r("span",null,[x,p(" "+i(a.real_estate_list.account.name),1)]),r("span",null,[ee,p(" "+i(a.real_estate_list.account.owner),1)]),r("span",null,[te,p(" "+i(a.real_estate_list.account.tel),1)])]),_:1},8,["header"]),o(t(d),{field:"real_estate_list.real_esate_number",header:e.$t("table.header.real_esate_number"),headerStyle:"min-width: 12rem"},null,8,["header"]),o(t(d),{field:"real_estate_list.name",header:e.$t("table.header.real_estate_name"),headerStyle:"min-width: 8rem"},null,8,["header"]),o(t(d),{field:"real_estate_list.real_estate_type.name",header:e.$t("table.header.real_estate_type"),headerStyle:"min-width: 10rem"},null,8,["header"]),o(t(d),{field:"service_model",header:e.$t("table.header.service_model"),headerStyle:"min-width: 8rem"},null,8,["header"]),o(t(d),{field:"from_date",header:e.$t("table.header.from_date"),headerStyle:"min-width: 8rem"},null,8,["header"]),o(t(d),{field:"to_date",header:e.$t("table.header.to_date"),headerStyle:"min-width: 8rem"},null,8,["header"]),o(t(d),{header:e.$t("table.header.price"),headerStyle:"min-width: 15rem"},{body:h(({data:a})=>[p(i(t($)(a.price,a.currency))+" - ( "+i(a.qty)+" / "+i(a.unit_price)+") ",1)]),_:1},8,["header"]),o(t(d),{header:e.$t("table.header.total"),headerStyle:"min-width: 13rem"},{body:h(({data:a})=>[p(i(t($)(a.total,a.currency)),1)]),_:1},8,["header"])]),_:1},8,["value","first","loading","totalRecords","rows","currentPageReportTemplate"])]))}});export{we as default};
